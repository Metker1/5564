function Ft(t,e){e=e.sort((s,n)=>n-s);let i=e[0];return e.forEach(s=>{t<i&&t<=s&&(i=s)}),i}var Et=150,ft=2160,kt={avif:null,webp:null};function Tt(){let t=typeof flexbe_cli=="object"&&flexbe_cli.vars?.site.images||{};return{lazy:!0,lazy_priority:!1,avif:!1,webp:!1,avif_support:kt.avif||t.avif_support,webp_support:kt.webp||t.webp_support,slow_network:!1,maxSize:ft,minSize:Et,quality_map:{jpg:70,webp:70,avif:55}}}async function B(t){return new Promise((e,i)=>{let s=new Image,n=()=>{e(s),setTimeout(()=>{typeof s.remove=="function"&&s.remove()},10)};"decode"in s&&!/\.svg/.test(t)?(s.src=t,s.decode().then(n).catch(i)):(s.onerror=i,s.onload=n,s.src=t)})}function ie(t){if(typeof t!="string")return t;t=t.replace(/(\/img\/[\d_q]+)\/[\w-]+(\.\w{3,4})/i,"$1$2");let[,e,i,s,n]=t.match(/\/img\/(\d+)_?(\d+)?_?q?(\d+)?\.(\w{3,4})/i)||[],a=+e,o=`${e}.${n}`,l=i?+i:0,r=s?+s:null;return{id:a,ext:n,name:o,size:l,quality:r}}function Mt(t,e){let i=e.avif_support,s=e.webp_support,n=e.avif,a=e.webp,o=t.ext;return i&&n?o="avif":s&&a?o="webp":t.ext==="webp"&&(s?o="webp":o=t.transparent?"png":"jpg"),o}function se(t,e=null,i=null){i={...Tt(),...i};let{id:s,ext:n}=t;if(!s)return"";let a=i.maxSize||ft;!e&&t.ext==="webp"&&!i.webp_support&&(e=Math.min(t.width||a,a));let o=t.animated??n==="gif",l=`/img/${s}.${n}`;if(!e||o||n==="svg")return l;let c=Mt(t,i),d=i.slow_network&&Pt(),h=i.quality_map;switch(d&&(h={jpg:50,webp:50,avif:45}),c){case"png":return`/img/${s}_${e}.png`;case"avif":case"webp":case"jpg":return`/img/${s}_${e}_q${h[c]}.${c}`;case"gif":default:return l}}function ne(t){let e=String(t).match(/\.(jpg|jpeg|png|gif|svg|bmp|webp)$/i);return e&&e[1]?e[1]:""}function ae(t){return t!=="transparent"?t:"#000000"}function q(t){if(typeof t=="string"&&(t=ie(t)),!t||typeof t!="object")return{};let e=t.img_ext||t.ext,i=t.img_id||t.id,s=t.img_name||t.name;(!e||e==="false")&&(e=s?ne(s):"jpg");let n=t.img_border||t.border,a=ae(t.img_average||t.average),o=t.img_preview||t.preview||"",l=t.img_width||t.width||0,r=t.img_height||t.height||0,d=+(+t.img_proportion||+t.proportion||0).toFixed(2),h=t.img_animated||t.animated||e==="gif",p=t.img_transparent||t.transparent||0;return{id:i,ext:e,average:a,preview:o,width:l,height:r,proportion:d,border:n,animated:h,transparent:p}}function k(t,e=0,i){let s=q(t),n=typeof e=="number"?Math.round(e):typeof e=="string"?parseInt(e,10):null;return se(s,n,i)}async function mt(t){let e=t,i=typeof t=="object"&&(+t.proportion||+t.img_proportion)||0;if(i&&(i<2||i<5&&i%1>0)&&(i*=100),typeof e=="string"||!i){typeof e=="object"&&(e=k(t,50));let s=await B(e);i=s.naturalHeight/s.naturalWidth*100}return i}function Pt(){return typeof navigator>"u"?!1:(navigator.connection?.effectiveType||"4g")!=="4g"}async function R(t,e,i){i={...Tt(),...i};let s=t.width||0,n=t.img_scale||t.scale||"cover",a=t.img_type||t.type||"background",o=e.height/e.width,l=await mt(t)/100,r=i.slow_network&&Pt(),c=Math.min(r?1.5:2,self.devicePixelRatio),d=Mt(t,i),h,p;a==="image"||o>l&&n==="contain"||o<l&&n==="cover"?(h=e.width,p=h*l):(p=e.height,h=p/l),c>1&&(h*=c,p*=c),i.sizes&&(h=Ft(h,i.sizes),p=h*l);let u=i.minSize||Et,f=i.maxSize||ft;return h<=u&&/webp|jpg/.test(d)&&(h=h/c*2,p=h*l),s&&h>s&&(h=s,p=h*l),h>f&&(h=f,p=h*l),{width:Math.ceil(h),height:Math.ceil(p)}}var gt=new WeakMap,oe=()=>Math.floor(Math.random()*999999999),Rt=t=>{let{is:e,component:i}=t;gt.has(i)||gt.set(i,oe());let s=gt.get(i);return`.component-${e}-${s}`},x=class{static is="";require=[];core=null;owner=null;root=null;component=null;$component=null;componentWidth=null;componentHeight=null;isInited=!1;isLoaded=!1;isUpdated=!1;isOpen=null;isVisible=null;inScreen=!1;inBeside=!1;inView=!1;inFocus=!1;wasVisible=null;wasScreen=!1;wasBeside=!1;wasView=!1;wasFocus=!1;get is(){return this.constructor.is}constructor({component:t,core:e,reason:i}){this.core=e,this.owner=e.area,this.root=e.root,this.component=t,this.$component=$(t),this.isUpdated=i==="update"}onInit(){}onLoad(){}onVisible(t){}onScreen(t){}onBeside(t){}onView(t){}onFocus(t){}onResize(t){}onOpen(t){}onClose(t){}onHideShowUI(t){}onDestroy(){}#t(){this._clearEvents();let t=Rt(this);$(this.owner).on(`tween${t}`,e=>this.#e(e.detail)),$(this.root).on(`open${t}`,e=>this._onOpen(e.detail)),$(this.root).on(`close${t}`,e=>this._onClose(e.detail))}_clearEvents(){let t=Rt(this);$(this.owner).off(t),$(this.root).off(t)}#e({force:t=!1}={}){let e=this.componentWidth==null||this.componentHeight==null,i=this.core.isVisible,s=i&&this.component.offsetWidth||0,n=i&&this.component.offsetHeight||0,a=!!(s||n),o=a&&this.core.inBeside,l=a&&this.core.inScreen,r=a&&this.core.inView,c=a&&this.core.inFocus,d=this.componentWidth!==s,h=this.componentHeight!==n,p=t||a&&!e&&(d||h);a&&(this.componentWidth=s,this.componentHeight=n),a!==this.isVisible&&this._onVisible({state:a}),p&&this._onResize({force:t}),o!==this.inBeside&&this._onBeside({state:o}),l!==this.inScreen&&this._onScreen({state:l}),r!==this.inView&&this._onView({state:r}),c!==this.inFocus&&this._onFocus({state:c})}_onInit(){this.isInited=!0,typeof this.onInit=="function"&&this.onInit(),this.#e(),this.#t(),flexbe_cli.require(this.require,()=>this._onLoad())}_onLoad(){this.isLoaded=!0,typeof this.onLoad=="function"&&this.onLoad(),this.require.length&&this.#e()}_onVisible({state:t}){if(this.isVisible==null){this.isVisible=t,this.wasVisible=t;return}let e=t&&!this.wasVisible;this.isVisible=t,this.onVisible({state:t,first:e}),t&&(this.wasVisible=!0)}_onScreen({state:t}){let e=t&&!this.wasScreen;this.inScreen=t,this.onScreen({state:t,first:e}),t&&(this.wasScreen=!0)}_onView({state:t}){let e=t&&!this.wasView;this.inView=t,this.onView({state:t,first:e}),t&&(this.wasView=!0)}_onBeside({state:t}){let e=t&&!this.wasBeside;this.inBeside=t,this.onBeside({state:t,first:e}),t&&(this.wasBeside=!0)}_onFocus({state:t}){let e=t&&!this.wasFocus;this.inFocus=t,this.onFocus({state:t,first:e}),t&&(this.wasFocus=!0)}_onResize(t){this.onResize(t)}_onOpen(t){this.isOpen=!0,this.#e(),this.onOpen(t)}_onClose(t){this.isOpen=!1,this.#e(),this.onClose(t)}_onWindowResize(){this.onWindowResize&&(this.#e(),this.onWindowResize())}_onHideShowUI(t){this.onHideShowUI(t)}destroy(){this._clearEvents(),this.onDestroy()}};var E={},S=class extends x{static is="image";isImgLoaded=!1;params=null;constructor(t){super(t),this.imageLoadingOptions=flexbe_cli.vars.site.images,this.lazyLoad=this.component.hasAttribute("data-img-lazy"),this.autoLoad=this.component.hasAttribute("data-img-autoload"),this.hasImagePlaceholder=this.component.hasAttribute("data-has-placeholder"),this.imageLayer=this.$component.find(".component-image__image").get(0)||this.component,this.overlayLayer=this.$component.find(".component-image__scroll").get(0)}async onInit(){this.autoLoad&&!this.lazyLoad&&await this.loadImage(),this.$component.off(".componentImage"),this.$component.on("setImage.componentImage",$.debounce(async t=>{t.detail?.reason==="lazyPriority"&&!this.autoLoad||(this.autoLoad=!0,this.lazyLoad=!0,this.isVisible&&!this.isImgLoading&&!this.isImgLoaded&&await this.loadImage())},10))}async onBeside({state:t}){if(!t)return!1;!this.isImgLoaded&&this.autoLoad&&await this.loadImage()}async onResize(){this.isImgLoaded&&this.autoLoad&&(clearTimeout(this._resizeTimeout),this._resizeTimeout=setTimeout(()=>this.loadImage(!0),1e3))}onHideShowUI(t){t==="generation"&&requestAnimationFrame(()=>{this.component&&this.params?.position&&(this.component.style.setProperty("--imagePositionX",this.params.position.x),this.component.style.setProperty("--imagePositionY",this.params.position.y))})}async loadImage(t=!1){if(this.setParams(),!t&&(this.isImgLoaded||this.isImgLoading))return;this.setOverlay();let e,i=this.params;i.original_resolution||(e=await this.getOptimalSize(),e&&E[this.params.id].sizes&&!E[this.params.id].sizes.includes(e)&&E[this.params.id].sizes.push(e)),this.isImgLoading=!0;let s=k(i,e,this.imageLoadingOptions);if(this.hasImagePlaceholder&&s)try{await B(s)}catch(n){console.error("Image preload error",n);return}this.setImage(s),this.isImgLoading=!1}async getOptimalSize(){let t=this.params,e=await mt(t);t.proportion=e,E[this.params.id]&&(E[this.params.id].params.proportion=e);let i=this.componentWidth||this.component.offsetWidth,s=this.componentHeight||this.component.offsetHeight,{width:n}=await R(this.params,{width:i,height:s},this.imageLoadingOptions),a=n-2,o=Math.max(50,n*1.2);return n=this.getClosestSize(n,a,o),n}setImage(t){let{$component:e,params:i}=this;t&&(i.type==="image"?this.imageLayer.src=t:i.type==="background"&&(this.imageLayer.style.backgroundImage=`url(${t})`),this.isImgLoaded||(e.removeClass("loading"),this.isImgLoaded=!0),e.trigger("load"))}setOverlay(){let{overlayLayer:t,componentWidth:e,componentHeight:i}=this;if(!t)return;let s="medium";e<=200||i<=150?s="xsmall":e<=400||i<=250?s="small":e>=650&&i>=400&&(s="large"),t.setAttribute("data-size",s),t.getAttribute("data-type")==="hover"&&$(t).on("pointerenter pointerleave",n=>{let a=n.type==="pointerenter";$(t).toggleClass("hover",a)})}setParams(){if(this.params)return;let t=this.component,e=$(t),i={},s=e.attr("data-img-id");if(E[s]?.params)i={...E[s].params};else if(i.id=s,i.ext=e.attr("data-img-ext"),i.proportion=+e.attr("data-img-proportion"),i.position={x:e.attr("data-img-x")||"50%",y:e.attr("data-img-y")||"50%"},!i.ext){let a=(e.attr("data-img-name")||"image.jpg").match(/\.(\D{2,4})$/i)||[];a[1]&&i.ext!==a[1]&&(i.ext=a[1]||!1)}i.type=e.attr("data-img-type"),i.action=e.attr("data-action"),i.proportion||(i.proportion=100),i.scale=e.attr("data-img-scale")||"cover",i.original_resolution=t.hasAttribute("data-img-original"),E[i.id]||(E[i.id]={params:{...i},sizes:[]}),i.animated=t.hasAttribute("data-img-animated"),i.transparent=t.hasAttribute("data-img-transparent"),this.params=i}getClosestSize(t,e=t,i=t+10){let s=E[this.params.id].sizes||[],n,a=1/0;return s.forEach(o=>{let l=Math.abs(o-t);o>=e&&o<=i&&l<a&&(n=o,a=l)}),n??t}};var A={},Y={};flexbe_cli.entity.setClientJs("element","spoiler01",{components:[S],onLoad(){this.$list=this.$area.find(".spoiler-list"),this.$items=this.$area.find(".spoiler-list-item"),this.isSpoilered=+this.$list.attr("data-spoiler"),this.isAccordion=+this.$list.attr("data-accordion"),Y[this.id]||(Y[this.id]=this.$items.length),Y[this.id]!==this.$items.length&&(A[this.id]=[],Y[this.id]=this.$items.length),A[this.id]||(A[this.id]=[]),this.isSpoilered?(this.isAccordion&&A[this.id].length>1&&(A[this.id]=A[this.id].slice(0,1)),A[this.id].forEach(t=>{let e=t&&this.$list.find(`[uid="${t}"]`);e.length&&this.toggleSpoiler({$item:e,state:!0,duration:0,force:!0})})):A[this.id]=[],this.bindEvents()},bindEvents(){if(!this.isSpoilered)return!1;let t=".clickable",e;this.$list.on("mousedown",t,i=>{if(!flexbe_cli.run.is_preview&&$(i.target).closest(".element-text, .component-image, .editor-simple-handle").length){e=!1;return}if($(i.target).closest(".not-clickable").length){e=!1;return}e={target:i.currentTarget,x:i.screenX,y:i.screenY}}),this.$list.on("mouseup",t,i=>{if(!e||e.target!==i.currentTarget||!flexbe_cli.run.is_preview&&$(i.target).closest(".element-text").length)return;Math.sqrt((e.x-i.screenX)**2+(e.y-i.screenY)**2)<5&&this.toggleSpoiler({$item:$(i.currentTarget)}),e=!1})},toggleSpoiler({$item:t,state:e,force:i,duration:s}){let n=0,a=t.attr("uid");typeof e>"u"&&(e=t.attr("data-expanded")!=="true"),e?A[this.id].find(h=>h===a)||A[this.id].push(a):A[this.id]=A[this.id].filter(h=>h!==a);let o=t.find(".collapsed");if(o[0].inAnimation&&!i)return;o[0].inAnimation=!0;let l=t.find(".spoiler-text"),r=l.find(".spoiler-text-content"),c=o[0].scrollHeight,d=typeof s=="number"?s:Math.max(250,Math.min(400,c*3));if(e){let h=l.height(),p=r.innerHeight();n=(h-p)/2,n<10&&r.css("margin",`${n}px 0`)}o.off("transitionend").one("transitionend",()=>{o.css("height","").toggleClass("collapsed--auto",e),o[0].inAnimation=!1}),o.css({height:`${c}px`,transitionDuration:`${d}ms`}),o[0].offsetHeight,o.toggleClass("collapsed--show",e).attr("aria-expanded",e).attr("aria-hidden",!e),e||o.css("height","0"),t.attr("data-expanded",e),this.isAccordion&&e&&t.siblings("[data-expanded=true]").each((p,u)=>this.toggleSpoiler({$item:$(u),state:!1,force:!0}))}});flexbe_cli.entity.setClientJs("element","text01",{isPure:!0});function Dt(t,e){let i=t.getBoundingClientRect(),s=e.clientX-i.left,n=e.clientY-i.top;return{x:s,y:n}}var J=class extends x{static is="backgroundElement";constructor(...t){super(...t),this.$glareElement=this.$component.find("> .bg-glare-hover").eq(0),this.$bgElement=this.$component.find(".bg-fill").eq(0),this.$hoverElement=this.$component.find(".bg-fill-hover").eq(0),this.lazy=this.$bgElement.data("img-lazy"),this.isImgLoaded=this.$bgElement.data("img-loaded"),this.bgType=this.$bgElement.data("type"),this.hoverType=this.$hoverElement.data("hover-type"),this.hasImagePlaceholder=!!this.$bgElement.data("img-has-placeholder"),this.imageLoadingOptions=flexbe_cli.vars.site.images}async onInit(){this.$bgElement.on("setImage",async()=>{this.isVisible&&!this.isImgLoading&&!this.isImgLoaded&&(this.setImageParams(),await this.loadImage())}),this.$glareElement.length&&this.$component.off("mousemove.bg-glare").on("mousemove.bg-glare",t=>{let{x:e,y:i}=Dt(this.$component[0],t);this.$glareElement.css({"--bgGlareX":`${e}px`,"--bgGlareY":`${i}px`})})}async onBeside({state:t,first:e}){t&&e&&(this.lazy&&this.bgType==="image"&&!this.isImgLoaded&&(this.setImageParams(),await this.loadImage()),this.hoverType==="image"&&(this.setHoverImageParams(),await this.loadHoverImage()),this.dispatchEffects())}onWindowResize(){this.dispatchEffects()}getComponentSize(){return{width:this.componentWidth,height:this.componentHeight}}dispatchEffects(){let t=flexbe_cli.resize.responsiveMode==="mobile",e=this.$component.hasClass("hover-trigger"),i=this.$component.hasClass("hover-trigger-am"),s=t?i:e;this.$component.toggleClass("js-hover",s)}async loadImage(){this.isImgLoading=!0;let t=0;if(!this.image.original){let{width:i}=await R(this.image,this.getComponentSize(),this.imageLoadingOptions);t=i}let e=k(this.image,t,this.imageLoadingOptions);this.hasImagePlaceholder&&await B(e),this.setImage(this.$bgElement,e),this.isImgLoading=!1,this.isImgLoaded=!0}async loadHoverImage(){let t=0;if(!this.hoverImage.original){let{width:i}=await R(this.hoverImage,this.getComponentSize(),this.imageLoadingOptions);t=i}let e=k(this.hoverImage,t,this.imageLoadingOptions);this.setImage(this.$hoverElement,e)}setImage(t,e){t.css("background-image",`url(${e})`),this.$component.find(".bg-preview").eq(0).addClass("invisible")}setImageParams(){let{$bgElement:t}=this;this.image={id:t.data("img-id"),ext:t.data("img-ext"),width:t.data("img-width"),animated:t.data("img-animated"),transparent:t.data("img-transparent"),proportion:t.data("img-proportion"),original:t.is("[data-img-original]"),type:"background",scale:"cover"}}setHoverImageParams(){let{$hoverElement:t}=this;this.hoverImage={id:t.data("img-id"),ext:t.data("img-ext"),width:t.data("img-width"),animated:t.data("img-animated"),transparent:t.data("img-transparent"),proportion:t.data("img-proportion"),original:t.is("[data-img-original]"),type:"background",scale:"cover"}}};flexbe_cli.entity.setClientJs("element","zone",{components:[J],onInit(){this.setMeta()},onUpdate(){this.setMeta()},setMeta(){let t=this.lastViewport,e=this.hideHidden;this.lastViewport=flexbe_cli.resize.viewportWidth,this.hideHidden=flexbe_cli.is_admin&&$("body").hasClass("hide-hidden"),this.needFixOrder=this.needFixOrder||this.lastViewport!==t||this.hideHidden!==e},onResize(){this.inScreen&&this.isVisible&&this.fixElementOrder()},fixElementOrder(){if(this.setMeta(),!this.needFixOrder)return;this.needFixOrder=!1;let t=this.$area.find(".elements-list");t.find("[data-hidden]").length&&t.each((e,i)=>{let s=$(i).find(".element-item--static"),n=s.filter(":visible");s.removeClass("is-first-child is-last-child"),n.first().addClass("is-first-child"),n.last().addClass("is-last-child")})}});var D=(t,e=0)=>(...i)=>new Promise(s=>{setTimeout(()=>s(t(...i)),e)}),re=(t,e=0)=>flexbe_cli.is_admin?t:D(t,e),$t=(t,e=0,...i)=>D(t,e)(...i),Vt=(t,e=0,...i)=>re(t,e)(...i),bt=Symbol("ref"),Lt="detached";function zt(t){let e=flexbe_cli.resize.responsiveMode;$(t).find(`[data-hidden="all"], [data-hidden="${e}"]`).toArray().forEach(s=>{let n=$(`<!--${Lt}-->`)[0];n[bt]=s,$(s).before(n).detach()})}function Bt(t){let e=document.createNodeIterator(t,NodeFilter.SHOW_COMMENT),i=[];for(;e.nextNode();){let s=e.referenceNode;s.textContent===Lt&&s[bt]&&i.push(s)}i.forEach(s=>{let n=s[bt];s.parentNode.replaceChild(n,s)})}function T(t,e,i,s={}){let n=$(t),a=e?`[data-component="${e}"]`:"[data-component]";n.is(a)&&n.trigger(i,s),$(t).find(a).each((o,l)=>{$(l).trigger(i,s)})}function U(t=[]){t.forEach(D(e=>{T(e,"image","setImage")}))}function K(t){t.params.virtualTranslate=!0,t.params.cssMode=!1,t.params.slidesPerGroup=1,t.params.spaceBetween=0,t.on("init",D(()=>{$(t.el).addClass("swiper-effect-fade")})),t.on("setTranslate",(e,i)=>{let{slides:s,size:n,slidesSizesGrid:a}=e;if(e.params.effect!=="fade"||Number.isNaN(i))return;$(e.wrapperEl).css("transform","");for(let r=0;r<s.length;r+=1){let c=e.slides.eq(r),h=-(a.slice(0,r).reduce((p,u)=>p+u,0)+i)/a[r];c.css({left:`-${r*100}%`,opacity:Math.min(Math.max(1-Math.abs(h),0),1)})}let o=!1;e.slides.transitionEnd(()=>{o||!e||e.destroyed||(o=!0,e.animating=!1,$(e.wrapperEl).trigger("transitionend"))})})}var le=class{constructor(t,e){e={init:!0,targets:"span",...e},this.options=e,this.pagination=t,this.tag=this.options.tag,this.filled=!1,this.states=["hidden","prev-prev","prev","main","next","next-next","hidden"],this.init()}init(){this.bindEvents(),this.options.init&&this.render({states:this.states,force:!0})}bindEvents(){let{tag:t,pagination:e,options:i}=this,s=$(e);typeof i.onClick=="function"&&s.off("click").on("click",t,n=>{let a=$(n.currentTarget),l=+a.siblings('[data-state="main"]').attr("data-index"),c=+a.attr("data-index")-l;i.onClick(c)})}move(t){let e=this.states,i=this.filled&&t;if(!(i&&this.inAnimate===t)&&(this.render({states:e,force:!0}),i)){let s=e.map((n,a)=>e[a+(t==="prev"?1:-1)]||"hidden");this.inAnimate=t,clearTimeout(this._anim),this._anim=setTimeout(()=>{this.inAnimate=!1},200),requestAnimationFrame(()=>{this.render({states:s})})}}render({states:t,force:e}={}){let i=$(this.pagination),s=this.tag;if(this.filled=!0,e){let n=t.reduce(a=>`${a}<${s}></${s}>`,"");i.html(n)}i.addClass("swiper-pagination-bullets-dynamic"),i.find(s).each((n,a)=>{let o=$(a),l=t[n]||"hidden",r=["swiper-pagination-bullet"];l==="main"&&r.push("swiper-pagination-bullet-active"),l==="hidden"?r.push("swiper-pagination-bullet-hidden"):r.push(`swiper-pagination-bullet-active-${l}`),o.attr("class",r.join(" ")),o.attr("data-state",l),o.attr("data-index",n)})}};function ce(t){t.params.virtualTranslate=!0,t.params.cssMode=!1,t.on("init",D(()=>{$(t.el).addClass("swiper-effect-slide")})),t.on("setTranslate",(e,i)=>{if(e.params.effect!=="slide"||Number.isNaN(i))return;let s=$(e.wrapperEl),n=$(e.slides),a=e.isHorizontal(),o=a?i:0,l=a?0:i;flexbe_cli.is_admin?s.css({position:"relative",top:`${l}px`,left:`${o}px`,transform:""}):s.css({transform:`translate3d(${o}px, ${l}px, 0px)`}),n.css({opacity:"",transform:""})})}var vt={},Q=class extends x{static is="cards";constructor(...t){super(...t);let{component:e,$component:i}=this;if(this.id=this.core.id,this.mode=e.getAttribute("data-mode"),this.mode==="slider"){this.require=["/_s/lib/swiper8/dist/swiper-bundle.min.js?v847"],this.$cardsRoot=i.closest(".flexbe-cards-root"),this.$slider=this.$cardsRoot.find(".swiper"),this.$pagination=this.$cardsRoot.find(".slider-pagination--cards"),this.$navigation=this.$cardsRoot.find(".slider-button--cards"),this.$swiperHelper=this.$cardsRoot.find(".swiper-mobile-helper"),this.$flexbeCardsSlider=this.$cardsRoot.find(".flexbe-cards-slider"),this.$flexbeCards=this.$cardsRoot.find(".flexbe-cards"),this.$flexbeCard=this.$cardsRoot.find(".flexbe-card"),this.sliderResponsive=this.$slider.attr("data-slider-responsive-mode");let s;this.$slider.on("bringIntoView",n=>{let a=this.swiper,o=$(n.target).closest(this.$flexbeCard)[0],l=this.$flexbeCard.index(o);s!==l&&(s=l,a?l!==-1&&a.slideTo(l):vt[this.id]=l)})}}onLoad(){this.sliderDisposer(),this.core.inView&&this.initSwipeAnimation()}onBeside({state:t}){t&&this.sliderDisposer()}onScreen({state:t}){t?this.sliderDisposer():this.destroySwipeAnimation()}onView({state:t}){t&&!this.wasView&&this.swiper&&this.swiper.inited&&(this.swiper.update(),this.checkSlidesVisibility(),this.checkNavigationState()),this.toggleAutoplay(t),t&&this.isLoaded&&this.initSwipeAnimation()}onResize(){if(this.sliderDisposer(),this.swiper){let t=this.getViewportSpecificSettings();this.settings={...this.settings,...t},this.swiper.params={...this.swiper.params,...t},setTimeout(()=>{this.swiper.update(),this.checkSlidesVisibility()},10)}}onHideShowUI(){this.destroySlider(),this.initSlider()}sliderDisposer(){if(this.mode!=="slider"||!this.isLoaded||!this.core.isVisible)return;this.responsiveMode=flexbe_cli.resize.responsiveMode;let t=flexbe_cli.resize.responsiveMode==="mobile",e=this.sliderResponsive,i=t?e!=="desktop":e!=="mobile";this.$cardsRoot.toggleClass("slider-enabled",i).toggleClass("slider-disabled",!i),this.$flexbeCards.toggleClass("slider-wrapper",i),i&&!this.swiper?this.initSlider():!i&&this.swiper&&this.destroySlider()}initSlider(){if(!(this.mode!=="slider"||this.swiper||typeof Swiper>"u"))try{this.savePropsFromAttributes(),this.createSwiperSettings(),this.createSwiperInstance(),this.createSwiperNavigation(),this.createSwiperLoopPagination(),this.createSwiperEditorFixes(),$t(()=>{this.swiper.init(),$t(()=>this.toggleAutoplay(this.core.inView))})}catch(t){console.warn(t)}}destroySlider(){this.mode==="slider"&&(this.swiper&&this.swiper.destroy(),this.swiper=null,this.$cardsRoot.removeClass("slider-inited slider-enabled"),this.$cardsRoot.addClass("slider-disabled"),this.$flexbeCardsSlider.removeClass("swiper-active"),this.$flexbeCards.removeClass("swiper-wrapper"),this.$flexbeCard.removeClass("swiper-slide-hidden"))}initSwipeAnimation(){if(this.mode!=="slider")return;flexbe_cli.resize.responsiveMode==="mobile"&&this.sliderResponsive!=="desktop"&&!this.$swiperHelper.hasClass("show")&&setTimeout(()=>{this.core.inView&&(this.$swiperHelper.addClass("show"),this.swiper.once("sliderMove",()=>{this.destroySwipeAnimation()}))},500)}destroySwipeAnimation(){this.mode==="slider"&&this.$swiperHelper.hasClass("show")&&this.$swiperHelper.removeClass("show")}savePropsFromAttributes(){this.props={totalSlides:+this.$slider.attr("data-count"),isOverflow:+this.$slider.attr("data-overflow"),autoplayDelay:flexbe_cli.run.is_preview&&Math.floor(+this.$slider.attr("data-autoplay")*1e3)||0,pagination:this.$pagination.attr("data-type")||!1,loop:flexbe_cli.run.is_preview&&!!+this.$slider.attr("data-loop"),effectDesktop:this.$slider.attr("data-effect"),effectMobile:this.$slider.attr("data-effect-mobile"),inRowDesktop:+this.$slider.attr("data-cards"),inRowMobile:+this.$slider.attr("data-cards-mobile")||1}}createSwiperSettings(){let t=this.getViewportSpecificSettings(),{totalSlides:e,isOverflow:i,autoplayDelay:s,pagination:n}=this.props,a=e<=t.slidesPerView?!1:this.props.loop,o=Math.max(0,Math.min(e-1,vt[this.id]||0));if(this.freeSlides=0,a&&!i){let l=this.$slider[0].offsetWidth,r=l/t.slidesPerView,c=(flexbe_cli.resize.viewportWidth-l)/2;this.freeSlides=Math.ceil(c/r)}this.settings={autoHeight:this.$slider.find(".align-items-stretch").length===0,preloadImages:!1,allowClick:!0,preventClicks:!1,preventClicksPropagation:!1,touchStartPreventDefault:!1,touchMoveStopPropagation:!1,preventInteractionOnTransition:!1,loopPreventsSlide:!1,simulateTouch:!flexbe_cli.run.isTouch&&flexbe_cli.run.is_preview,longSwipesRatio:.1,longSwipesMs:100,initialSlide:o,loop:a,autoplay:s?{delay:s,stopOnLastSlide:!a,disableOnInteraction:!0,waitForTransition:!0}:!1,navigation:{},pagination:{clickable:!0,type:a&&n==="bullets"?"custom":n,el:this.$pagination[0],dynamicBullets:this.$flexbeCard.length>7,dynamicMainBullets:t.slidesPerView,renderCustom:()=>{},formatFractionCurrent:()=>this.getGroupIndex()+1,formatFractionTotal:()=>Math.ceil(this.props.totalSlides/this.swiper.params.slidesPerView)},watchSlidesProgress:!0,loopedSlides:t.slidesPerView+this.freeSlides,...t}}getViewportSpecificSettings(){let t=flexbe_cli.resize.responsiveMode==="mobile",e=t?this.props.inRowMobile:this.props.inRowDesktop,i=t?this.props.effectMobile:this.props.effectDesktop;return e>1&&(i="slide"),{effect:i,speed:flexbe_cli.run.is_preview&&i==="fade"?450:300,slidesPerView:e}}createSwiperInstance(){this.swiper&&(this.swiper.destroy(),this.swiper=null);let t=!1,e,i=new Swiper(this.$slider[0],{init:!1,wrapperClass:"flexbe-cards",slideClass:"flexbe-card",...this.settings});i.params.effect==="fade"?K(i):ce(i);let s=()=>{t||(t=!0,this.$cardsRoot.addClass("slider-inited"),this.$slider.addClass("swiper-inited"));let c=this.props.totalSlides>i.params.slidesPerView;e!==c&&(e=c,this.$cardsRoot.toggleClass("slider-enabled",c),this.$cardsRoot.toggleClass("slider-disabled",!c),this.$slider.toggleClass("swiper-active",c),i.update())},n=()=>{if(i.loopedSlides){let c=$(i.slides).filter(`.${i.params.slideDuplicateClass}`),d={};c.each((h,p)=>{let u=$(p),f=u.attr("data-swiper-slide-index"),m=$(i.slides).eq(i.loopedSlides+ +f);d[f]=d[f]?d[f]+1:1,u.attr("data-cloned",d[f]);let g=m.find("[data-action]"),b=u.find("[data-action]");g.each((y,_)=>{let v=$(_).data();b.eq(y).data(v)})}),flexbe_cli.entity.initArea(c)}},a=()=>{if(i.params.autoHeight){let c=new ResizeObserver(()=>{i.updateAutoHeight()});i.slides.forEach(d=>c.observe(d)),i.on("destroy",()=>{c.disconnect()}),i.on("slideChange",()=>{i.updateAutoHeight()})}};flexbe_cli.is_admin||(i.on("beforeInit",()=>{zt(this.swiper.el)}),i.on("destroy",()=>{Bt(this.swiper.el)})),i.onAny((c,d)=>{i.el.dispatchEvent(new CustomEvent(`swiper:${c}`,{detail:d,bubbles:!1,cancelable:!0}))}),i.on("init",D(()=>{s(),n(),a(),this.checkSlidesVisibility()})),i.on("slideChange",D(()=>{this.checkSlidesVisibility()})),i.on("resize",$.debounce(()=>{this.swiper&&(s(),this.checkSlidesVisibility())},50));let o=!1,l=()=>{this.$cardsRoot.addClass("swiper-in-interacting"),this.checkSlidesVisibility()},r=()=>{this.$cardsRoot.removeClass("swiper-in-interacting"),this.checkSlidesVisibility()};i.on("sliderFirstMove",()=>{o=!0,l()}),i.on("touchEnd",()=>{o=!1,r()}),i.on("transitionStart",()=>{o||l()}),i.on("transitionEnd",()=>{o||r(),i.realIndex+i.loopedSlides!==i.activeIndex&&i.loopFix()}),this.$slider.on("reduceSliderControls",(c,{state:d=!0})=>{this.preventAutoplay=!!d,this.preventAutoplay&&this.toggleAutoplay({state:!1}),this.$cardsRoot.toggleClass("swiper-reduce-controls",!!d)}),this.$slider.on("preventSliderMove",(c,{state:d=!0})=>{i.allowTouchMove=!d}),this.swiper=i}createSwiperNavigation(){let t=this.swiper;t.on("init",()=>{this.checkNavigationState()}),t.on("resize",$.debounce(()=>{this.swiper&&this.checkNavigationState()},50)),t.on("slideChange",()=>{this._skipSlide||this.checkNavigationState()}),this.$navigation.on("click",e=>{let i=e.currentTarget.getAttribute("data-direction");this[i==="prev"?"prevSlide":"nextSlide"]()}),this.$slider.on("click.swiper-hidden",".swiper-slide-hidden",e=>{e.preventDefault(),e.stopPropagation();let i=this.swiper;if(i.animating)return;let s=e.currentTarget,n=Array.from(i.slides||[]).findIndex(r=>r===s),a=i.activeIndex,o=a-n,l=n-(a+i.params.slidesPerView-1);o>0?this.prevSlide(o):l>0&&this.nextSlide(l)})}createSwiperLoopPagination(){let t=this.swiper,e=!1;t.on("paginationRender",()=>{if(this.$pagination.toggleClass("disabled",this.props.totalSlides<=t.params.slidesPerView),this._skipSlide||t.params.pagination.type!=="custom")return;this.customPagination||(this.customPagination=new le(this.$pagination[0],{init:!1,tag:"span",onClick:l=>{l<0?this.prevSlide():l>0&&this.nextSlide()}}));let i=t.previousIndex,s=t.activeIndex,n=this.props.totalSlides,a=i<s?"next":"prev";(i!==s&&!(a==="next"&&i===s-n)&&!(a==="prev"&&i===s+n)||!e)&&this.customPagination.move(a),e=!0})}createSwiperEditorFixes(){if(!flexbe_cli.is_admin)return;let t=this.swiper;t.on("slideChange",()=>{vt[this.id]=t.realIndex})}checkSlidesVisibility(){let t=this.swiper;t.updateSlides();let e=$(t.slides),i=e.slice(t.activeIndex,t.activeIndex+t.params.slidesPerView),s=e.not(i);s.removeClass("swiper-slide-visible").addClass("swiper-slide-hidden"),i.removeClass("swiper-slide-hidden").addClass("swiper-slide-visible"),T(s,!1,"sliderDeactivate"),T(i,!1,"sliderActivate")}checkNavigationState(){let t=this.swiper,e=t.params.navigation.disabledClass,i=this.$navigation,s=i.eq(0),n=i.eq(1),{isBeginning:a,isEnd:o}=t;t.loopedSlides&&(a=!1,o=!1),i.toggleClass("disabled",this.props.totalSlides<=t.params.slidesPerView),s.toggleClass(e,a),n.toggleClass(e,o)}getGroupIndex(t,e,i=!0){let s=this.swiper;t==null&&(t=s.realIndex),e||(e=s.params.slidesPerView||1),i&&(s.loopedSlides||e<=1)&&(i=!1);let n=Math.ceil(this.props.totalSlides/e),a=Math.floor(t/e);if(i){let o=a*e,l=o+e-1,r=t-o>l-t,c=t%e!==0&&t+e>=this.props.totalSlides;(r||c)&&(a+=1)}return Math.max(0,Math.min(n,a))}getSlideIndex(t,e){return e==null&&(e=this.swiper.params.slidesPerView||1),t*e}toSlide(t,e){let i=this.swiper,s=this.getSlideIndex(t,e);return i.loopedSlides?i.slideToLoop(s):i.slideTo(s)}prevSlide(t){let e,i=this.swiper;t?t=Math.abs(t):t=1;let s=i.activeIndex;if(i.loopedSlides){let n=s,a=this.props.isOverflow?t:t+this.freeSlides,o=s+this.props.totalSlides<=i.slides.length,l=n>=a;o&&!l&&(this.toggleSkip(!0),i.slideTo(s+this.props.totalSlides,0)),e=i.activeIndex-t}else e=i.activeIndex-t;setTimeout(()=>{this.toggleSkip(!1),i.slideTo(e)},5)}nextSlide(t){let e,i=this.swiper,s=i.params.slidesPerView;t?t=Math.abs(t):t=1;let n=i.activeIndex,a=n+s-1;if(i.loopedSlides){let o=i.slides.length-a-1,l=this.props.isOverflow?t:t+this.freeSlides,r=n-this.props.totalSlides>=0,c=o>=l;r&&!c&&(this.toggleSkip(!0),i.slideTo(n-this.props.totalSlides,0)),e=i.activeIndex+t}else e=i.activeIndex+t;setTimeout(()=>{this.toggleSkip(!1),i.slideTo(e)},5)}toggleSkip(t=!this._skipSlide){this._skipSlide=!!t,this.$slider.toggleClass("noanimate",this._skipSlide)}toggleAutoplay(t){if(!this.swiper)return;this.preventAutoplay&&(t=!1);let e=this.swiper,i=e.autoplay,s=e.params.autoplay||{};!i||!s.enabled||(t&&!i.running?i.start():t||i.stop())}};flexbe_cli.entity.setClientJs("element","zone_cards",{components:[Q],onUpdate(t){t.originId===t.id&&this.fixSwiper(t)},fixSwiper(t={}){clearTimeout(this._changeTimer);let e=flexbe_cli.components.getInstances(this.area).filter(n=>n.is==="cards")?.[0],i=e&&e.swiper;if(!i)return!1;if(document.body.contains(i.el)){if(t&&t.reason==="items_add"){let n=i.realIndex,a=t.reasonData.to,o=n;n+i.params.slidesPerView<=a&&(o=a-i.params.slidesPerView+1),o!==n&&(this._changeTimer=setTimeout(()=>i.slideTo(o),30))}t.styleRendered&&!t.templateRendered&&requestAnimationFrame(()=>i.$el&&i.update(!1))}else this._changeTimer=setTimeout(()=>this.fixSwiper(t),16)}});function V(t,e,i){let s;return typeof e=="function"&&typeof t=="function"&&(t()?e():(i&&setTimeout(()=>{clearInterval(s),e()},i),s=setInterval(()=>{t()&&(clearInterval(s),e())},25))),()=>clearInterval(s)}var X=class{inited=!1;loaded=!1;destroyed=!1;abortController=new AbortController;constructor(t){this.options=t,this.target=t.target}async init(){this.inited=!0,await this.whenLoaded(),this.loaded=!0}destroy(){this.abortController.abort(),this.destroyed=!0}whenLoaded(t=()=>{}){return new Promise(e=>{if(this.loaded){t(),e();return}if(this.type==="video")this.loaded=!0,t(),e();else{let i=!1,s=setTimeout(()=>{this.loaded=!0,i||(i=!0,t(),e())},1e3);$(this.target).one("load",()=>{clearTimeout(s),this.loaded=!0,i||(i=!0,t(),e())})}})}async play(){}pause(){}onLoadData(){this.options.onLoadData?.()}onPlay(){this.options.onPlay?.()}onPause(t){this.options.onPause?.(t)}onError(t){this.options.onError?.(t)}},yt=class extends X{type="embed";async init(){let t=this.target;if(!t)return;let e=t.getAttribute("data-src"),i=t.getAttribute("src");e&&!i&&(t.src=e),this.inited=!0,await this.whenLoaded(),this.loaded=!0}async play(){await this.whenLoaded(),this.target.contentWindow?.postMessage("play","*")}async pause(){this.target.contentWindow?.postMessage("pause","*")}},de=class extends X{type="embed";async init(){let t=this.target,e=t.getAttribute("data-src"),i=t.getAttribute("src"),s=n=>{(n===window.YT.PlayerState.BUFFERING||n===window.YT.PlayerState.PLAYING)&&this.onLoadData(),n===window.YT.PlayerState.PLAYING?this.onPlay():(n===window.YT.PlayerState.PAUSED||n===window.YT.PlayerState.ENDED)&&this.onPause()};e&&!i&&(t.src=e),this.inited=!0,await this.whenLoaded(),flexbe_cli.require([`https://www.youtube.com/iframe_api?origin=${window.location.host}`],()=>{this.destroyed||!this.target.isConnected||V(()=>window.YT?.Player,()=>{this.ytVideo=new window.YT.Player(t,{events:{onStateChange:n=>s(n.data),onReady:()=>s(this.ytVideo.getPlayerState())}})})}),this.loaded=!0}async play(){await this.whenLoaded(),this.target.contentWindow?.postMessage('{"event":"command","func":"playVideo","args":""}',"*")}async pause(){this.target.contentWindow?.postMessage('{"event":"command","func":"pauseVideo","args":""}',"*")}},he=class extends X{type="embed";async init(){let t=this.target,e=t.getAttribute("data-src"),i=t.getAttribute("src");e&&!i&&(t.src=e),this.inited=!0,await this.whenLoaded(),flexbe_cli.require(["https://player.vimeo.com/api/player.js"],()=>{this.destroyed||!this.target.isConnected||(this.vPlayer=new window.Vimeo.Player(t),this.vPlayer.on("play",()=>this.onPlay()),this.vPlayer.on("pause",()=>this.onPause()))}),this.loaded=!0}async play(){await this.whenLoaded(),this.vPlayer&&this.vPlayer.play()}async pause(){this.vPlayer&&this.vPlayer.pause()}},ue=class extends yt{type="embed";playerReady=!1;async init(){let t=this.target;if(!t)return;let e=t.src||t.dataset.src;this.inited=!0,this.loaded=!0,t.id=crypto.randomUUID();try{if(await flexbe_cli.require(["https://player.kinescope.io/latest/iframe.player.js"],null,5e3),this.destroyed||!t.isConnected)return;let i=Object.fromEntries(new URL(e).searchParams.entries());this.player=await Kinescope.IframePlayer.create(t.id,{url:e,playlist:[],behavior:{preload:"none",playsInline:!0,autoPlay:i.autoplay?"viewable":!1,autoPause:!1,localStorage:!1,loop:i.loop==="1",muted:i.muted==="1"},ui:{controls:i.controls!=="0",language:["ru","kk","be"].includes(flexbe_cli.vars.page.language)?"ru":"en"}}),this.player.on(Kinescope.IframePlayer.Events.Play,()=>this.onPlay()),this.player.on(Kinescope.IframePlayer.Events.Pause,()=>this.onPause())}catch(i){if(this.destroyed||!t||!t.isConnected)return;console.error(i),t.src!==e&&(t.src=e),await this.whenLoaded()}this.playerReady=!0}async destroy(){super.destroy(),this.player&&await this.player.destroy()}async play(){return new Promise(t=>{V(()=>this.playerReady,async()=>{await this.player?.play(),t()},7e3)})}async pause(){this.player&&await this.player.pause()}},pe=class extends X{type="video";_wasClicked=!1;async init(){let t=this.target,e=t.poster||t.dataset.poster,i=t.getAttribute("data-src"),s=t.getAttribute("src");if(t.addEventListener("error",n=>this.onError(n.error)),t.addEventListener("loadeddata",this.onLoadData.bind(this)),t.addEventListener("playing",this.onPlay.bind(this)),t.addEventListener("pause",()=>{let n=this._wasClicked||t.currentTime===t.duration;this.onPause(n)}),t.addEventListener("pointerup",this.onClick.bind(this)),e&&(this.target.poster=e),i&&!s){let n=document.createElement("source");n.addEventListener("error",a=>this.onError(a.error||a)),n.setAttribute("type","video/mp4"),n.setAttribute("src",i),t.appendChild(n),t.load()}this.inited=!0,await this.whenLoaded(),this.loaded=!0}async play(){await this.whenLoaded(),await this.target.play()}async pause(){this.target.pause()}onClick(){this.target.paused||(this._wasClicked=!0,setTimeout(()=>{this._wasClicked=!1},100))}},fe=class extends yt{playerReady=!1;async init(){await super.init();let t=e=>{let i=e.data;if(typeof i=="string")try{i=JSON.parse(e.data)}catch{}e.source===this.target.contentWindow&&(["player:ready","player:changeState"].includes(i.type)&&(this.playerReady=!0),i.type==="player:changeState"&&(i.data.state==="playing"?this.onPlay():i.data.state==="paused"&&this.onPause()))};window.addEventListener("message",t,{signal:this.abortController.signal})}async play(){this.command("player:mute"),this.command("player:setCurrentTime",{time:0}),this.command("player:play")}async pause(){this.command("player:pause")}command(t,e={}){V(()=>this.loaded&&this.playerReady,()=>{this.target.contentWindow?.postMessage(JSON.stringify({type:t,data:e}),"*")})}},Z=class extends x{static is="video";constructor(...t){super(...t);let e;switch(this.$preview=this.$component.find(".component-video__preview"),this.$iframe=this.$component.find("iframe"),this.$video=this.$component.find("video.custom-video"),this.type=this.$component.data("type"),this.autoplay=!!+this.$component.data("autoplay"),this.autoInit=this.autoplay||!this.$preview.length||this.$preview.hasClass("no-image"),this.type){case"custom":e=pe;break;case"youtube":e=de;break;case"vimeo":e=he;break;case"kinescope":e=ue;break;case"rutube":e=fe;break;default:e=yt}this.provider=new e({target:this.type==="custom"?this.$video[0]:this.$iframe[0],onPlay:this.onPlay.bind(this),onPause:this.onPause.bind(this),onError:this.onError.bind(this),onLoadData:this.onLoadData.bind(this)}),this.$preview.removeAttr("hidden"),this.$preview.on("click",async()=>{await this.#t(),await this.play(!0)}),this.$component.off("sliderActivate").on("sliderActivate",async()=>{this.preventAutoplay=!1,this.inScreen&&this.autoInit&&(await this.#t(),this.autoplay&&await this.play())}),this.$component.off("sliderDeactivate").on("sliderDeactivate",async()=>{this.preventAutoplay=!0,await this.pause()})}onDestroy(){this.provider.destroy()}async onScreen({state:t}){t?(this.autoInit&&await this.#t(),this.autoplay&&!this.preventAutoplay&&await this.play()):await this.pause()}async#t(){this.provider.inited||(this.$component.addClass("loading"),await this.provider.init(),this.$component.removeClass("loading"),this.$component.addClass("loaded"))}async play(t=!1){this.isAutoplaying=!t,this.isPaused=!1,this.$preview.off("click").addClass("preloading");try{await this.provider.play(),this.$preview.fadeOut(150,()=>{this.$preview.remove(),this.$component.removeClass("overlayed")})}catch(e){console.warn(e)}}async pause(){this.isAutoplaying=!1,this.isPaused=!0;try{await this.provider.pause()}catch{}}onPlay(){this.isPaused=!1,this.preventAutoplay=!1,!this.autoplay&&!flexbe_cli.is_admin&&flexbe_cli.resize.responsiveMode==="mobile"&&this.component.closest('[data-hidden="desktop"]')&&(this.viewportLocked=!0,flexbe_cli.resize.lockMode(!0)),(!this.autoplay||!this.isAutoplaying)&&(this.sliderAutoplayPrevented=!0,this.$component.trigger("reduceSliderControls",{state:!0}))}onPause(t=this.inScreen){this.isPaused=!0,t&&(this.preventAutoplay=!0),this.viewportLocked&&(this.viewportLocked=!1,flexbe_cli.resize.lockMode(!1)),this.sliderAutoplayPrevented&&(this.sliderAutoplayPrevented=!1,this.$component.trigger("reduceSliderControls",{state:!1}))}onError(t){console.error(t)}onLoadData(t){this.$component.addClass("started")}};flexbe_cli.entity.setClientJs("element","zone_gallery",{components:[Q,S,Z],onUpdate(t={}){setTimeout(()=>{let e=flexbe_cli.components.getInstances(this.area).filter(s=>s.is==="cards")?.[0],i=e&&e.swiper;if(i){if(t&&t.reason==="items_add"){let s=i.realIndex,n=t.reasonData.to,a=s;s+i.params.slidesPerView<=n&&(a=n-i.params.slidesPerView+1),a!==s&&i.slideTo(a)}t.styleRendered&&requestAnimationFrame(()=>i.update(!1))}},100)}});flexbe_cli.entity.setClientJs("element","zone_grid",{isPure:!0});flexbe_cli.entity.setClientJs("element","zone_header",{isPure:!0});function qt(t,e,i=1){return 1-t>i&&(t=i),(1-Math.cos(Math.PI*t*e))/2}var me=[0,"parallax","parallax-fade","zoom","zoom-return"],ge=class{imgParams={w:0,h:0,r:1,x:.5,y:.5};canvasSize={w:0,h:0,y:0};winSize={w:0,h:0};overlayOpacity=1;constructor(t,e,i="parallax",s=null){this.id=t,this.shouldRender=!1,this.mode=typeof i=="number"?me[i]:i,this.fadeAnimation=this.mode.includes("fade"),this.parallaxFactor=this.mode.includes("fixed")?1:this.mode.includes("parallax")?.4:0,this.zoomFactor=this.mode.includes("zoom")?.2:0,this.zoomLimit=this.mode==="zoom"?.5:this.mode==="zoom-return"?1:0,this.offCanvas=document.createElement("canvas"),this.offCtx=this.offCanvas.getContext("2d",{alpha:!1}),this.component=e[0],this.canvas=this.component.querySelector("canvas"),this.overlay=this.component.querySelector(".overlay"),this.ctx=this.canvas.getContext("2d",{alpha:!1}),this.init(s),this.reflow()}init(t){!t||!t.url||(this.img=document.createElement("img"),this.img.onload=()=>{this.ready=!0,this.imgParams={w:this.img.width,h:this.img.height,r:this.img.height/this.img.width,x:+t.x.replace("%","")/100,y:+t.y.replace("%","")/100},this.dispatchEvents(),this.draw(),requestAnimationFrame(()=>{$(this.canvas).addClass("ready")})},this.img.src=t.url)}dispatchEvents(){flexbe_cli.events.off(`.bg_${this.id}`),$(window).off(`.bg_${this.id}`),$(window).on(`scroll.bg_${this.id}`,()=>{this.draw()}),$(window).on(`resize.bg_${this.id}`,()=>{this.reflow()}),flexbe_cli.is_admin&&(flexbe_cli.events.on(`entity_render:style.bg_${this.id}`,t=>{t.id===this.id&&this.reflow()}),flexbe_cli.events.on(`layout_change.bg_${this.id}`,()=>{this.reflow()}))}toggleRendering(t){this.shouldRender=t}getZoomCoords(t){let e=1;if(this.zoomFactor){let s=100-qt(t*.01,2,this.zoomLimit)*100;e=1+this.zoomFactor/100*s}let i={w:0,h:0,x:0,y:0};return i.w=this.canvasSize.w*e,i.h=this.canvasSize.h*e,i.x=(i.w-this.canvas.width)/2,i.y=(i.h-this.canvasSize.h)/2,i}reflow(){let t=this.canvas.getBoundingClientRect();this.canvasSize={w:t.width,h:t.height,y:t.top+window.pageYOffset};let{viewportWidth:e,viewportHeight:i}=flexbe_cli.resize;this.winSize.h=flexbe_cli.run.is_mobile?Math.max(this.winSize.h,i):i,this.winSize.w=e,this.fadeAnimation&&(this.overlayOpacity=parseFloat(getComputedStyle(this.component).getPropertyValue("--componentBgOpacity")||1)),this.draw()}draw(){if(!this.shouldRender||!this.ready||this.pending)return;this.pending=!0;let t=flexbe_cli.scroll.latest+this.winSize.h-this.canvasSize.y,e=100-t/(this.canvasSize.h+this.winSize.h)*100;this.drawOffscreen(),this.drawCanvas(t,e),this.drawOverlay(e),this.pending=!1}drawOffscreen(){let{canvasSize:t,zoomFactor:e,winSize:i,parallaxFactor:s,imgParams:n,offCanvas:a,offCtx:o,img:l}=this,r=e?t.h:t.h+(i.h-t.h)*s,c=t.w,d=c,h=c*n.r,p=0,u=(h-r)*n.y*-1;r/c>n.r&&(d=r/n.r,h=r,p=(d-c)*n.x*-1,u=0),a.width!==c&&(a.width=c),a.height!==r&&(a.height=r),o.drawImage(l,p,u,d,h)}drawCanvas(t,e){if(this.canvas.width!==this.canvasSize.w&&(this.canvas.width=this.canvasSize.w),this.canvas.height!==this.canvasSize.h&&(this.canvas.height=this.canvasSize.h),this.zoomFactor){let i=this.getZoomCoords(e);try{this.ctx.drawImage(this.offCanvas,Math.ceil(i.x*-1),Math.ceil(t*this.parallaxFactor-this.winSize.h*this.parallaxFactor-i.y),i.w,i.h)}catch{}}else try{this.ctx.drawImage(this.offCanvas,0,Math.ceil((t-this.winSize.h)*this.parallaxFactor))}catch{}}drawOverlay(t){if(this.fadeAnimation&&this.overlay){let e=1-(1-this.overlayOpacity)*qt(t*.01,2,1);this.overlay.style.setProperty("--componentBgOpacity",e)}}destroy(){this.destroyed=!0,cancelAnimationFrame(this._raf),flexbe_cli.events.off(`.bg_${this.id}`),$(window).off(`.bg_${this.id}`),$(this.canvas).removeClass("ready"),this.offCanvas?.remove(),this.img?.remove()}},be=class{destroyed=!1;constructor(t,e,i){this.background=t,this.core=t.core,this.$component=t.$component,this.video=e,typeof i=="function"&&(this.onInited=i),this.initVideo()}initVideo(){this.$container=$('<div class="layer video-holder"></div>'),this.insertVideo(),this.video.type==="custom"?this.initMP4():this.video.type==="vimeo"?this.initVimeo():this.video.type==="youtube"?this.initYoutube():this.video.type==="kinescope"?this.initKinescope():this.initEmbed(),$(document).on(`visibilitychange.bg_effect_${this.core.id}`,()=>{this.background.onscreen&&!document.hidden&&setTimeout(()=>{this.play()},50)})}initVimeo(){let t=0,e=()=>{let i=this.vPlayer;return Promise.all([i.getVideoWidth(),i.getVideoHeight()]).then(s=>{let[n,a]=s;return n/a<2.5&&n/a>.4||t===3?{width:n,height:a}:(t+=1,e())})};flexbe_cli.require(["https://player.vimeo.com/api/player.js"],()=>{this.destroyed||(this.vPlayer=new window.Vimeo.Player(this.$videoElement[0]),e().then(i=>(this.video.width=i.width,this.video.height=i.height,this.fitToSize(),this.play(),null)).catch(()=>{}))})}initYoutube(){let t=()=>{this.yPlayer=new window.YT.Player(this.$videoElement[0],{events:{onReady:()=>{this.fitToSize(),this.play()}}})};!window.YT&&!window.onYouTubeIframeAPIReady?(window.onYouTubeIframeAPIReady=()=>{window.youtubeBGQueue.forEach(e=>e()),window.youtubeBGQueue=null,window.onYouTubeIframeAPIReady=null},window.youtubeBGQueue=[],window.youtubeBGQueue.push(t),flexbe_cli.require(["https://www.youtube.com/iframe_api"])):window.onYouTubeIframeAPIReady?window.youtubeBGQueue.push(t):t()}initKinescope(){this.fitToSize(),this.ready(),flexbe_cli.require(["https://player.kinescope.io/latest/iframe.player.js"],async()=>{this.destroyed||(this.kPlayer=await window.Kinescope.IframePlayer.create(this.$videoElement.attr("id"),{url:this.video.link,behavior:{background:!0,preload:"auto",loop:!0,muted:!0,autoPlay:"viewable",autoPause:!1}}),this.play())})}initEmbed(){this.fitToSize(),this.play()}initMP4(){this.$videoElement[0].oncanplay=()=>{this.play()},this.$videoElement[0].onloadeddata=()=>{this.video.width=this.$videoElement[0].videoWidth,this.video.height=this.$videoElement[0].videoHeight,this.fitToSize(),this.ready()}}insertVideo(){this.video.type==="custom"?(this.$videoElement=$(`<video src="${this.video.link}"
                       controlslist="nodownload"
                       loop="true"
                       muted="true"
                       autoplay="true"
                       playsinline="true"
                       disablePictureInPicture
                       disableRemotePlayback
                       pip="false"
                ></video>`),this.$videoElement[0].disablePictureInPicture=!0,this.$videoElement[0].disableRemotePlayback=!0):this.$videoElement=$(`<iframe 
                id="${crypto.randomUUID()}"
                src="${this.video.link}"
                width="${this.video.width}" 
                height="${this.video.height}" 
                allow="autoplay; encrypted-media; fullscreen; screen-wake-lock; accelerometer; clipboard-write;"
            ></iframe>`),this.$container.append(this.$videoElement),this.$component.prepend(this.$container),this.onInited&&this.onInited(this.$container)}fitToSize(){if(this.video){let t=this.$container.width(),e=this.$container.height(),i=this.video.width/this.video.height,s=t/e;i>s?this.$videoElement.css({width:`${e*i}px`,height:"100%"}):this.$videoElement.css({width:"100%",height:`${t/i}px`})}this.videoIsResized=!0}ready(){V(()=>this.videoIsResized,()=>{this.$component.addClass("video-loaded")},5e3)}play(){this.$videoElement&&this.$videoElement[0]&&this.$videoElement[0].play?(this.$videoElement[0].play(),$(document).one("touchstart.video-bg",()=>{this.$videoElement[0].play()}),this.ready()):this.video.type==="vimeo"?V(()=>this.vPlayer&&this.vPlayer.play,()=>{setTimeout(()=>{this.vPlayer.play(),this.ready()},50)},5e3):this.video.type==="youtube"?V(()=>this.yPlayer&&this.yPlayer.playVideo,()=>{this.yPlayer.playVideo(),this.ready()},5e3):this.video.type==="kinescope"?V(()=>this.kPlayer&&this.kPlayer.play,()=>{this.kPlayer.play(),this.ready()},5e3):this.ready()}pause(){this.video.type==="vimeo"&&this.vPlayer?this.vPlayer.pause():this.video.type==="youtube"&&this.yPlayer&&this.yPlayer.pauseVideo?this.yPlayer.pauseVideo():this.video.type==="kinescope"&&this.kPlayer?.pause?this.kPlayer.pause():this.$videoElement&&this.$videoElement[0]&&this.$videoElement[0].pause&&this.$videoElement[0].pause()}destroy(){this.destroyed=!0,this.pause(),this.kPlayer&&this.kPlayer.destroy(),$(document).off(`.bg_effect_${this.core.id}`)}},$e=[800,1366,1920,2160],M=class extends x{static is="background";constructor(...t){super(...t);let{$component:e}=this,i=e.data();this.data={type:i.type||"color",hasImagePlaceholder:!!i.hasPlaceholder,imageLoadingOptions:flexbe_cli.vars.site.images,isLazyLoading:!!i.lazy,isImgLoaded:!!i.loaded,effect:i.effect,effectMobile:i.effectMobile??i.effect,videoId:i.videoId||null,videoType:i.videoType||null,videoLink:i.videoLink||null,videoWidth:i.videoWidth||640,videoHeight:i.videoHeight||360,videoPreview:i.videoPreview||"color",infinityVideo:i.infinityVideo??!1,mobileVideoEnabled:i.mobileVideoEnabled||!1,videoParallaxFactor:.4},this.image={url:null,id:i.imgId,ext:i.imgExt,x:i.imgX,y:i.imgY,proportion:i.imgProportion,width:i.imgWidth,animated:i.imgAnimated,transparent:i.imgTransparent,scale:"cover",type:"background",original:!!i.imgOriginal}}async onInit(){this.data.isLazyLoading||await this.loadImage(),this.$component.on("setImage",async()=>{this.isVisible&&!this.isImgLoading&&!this.data.isImgLoaded&&await this.loadImage()})}onScreen({state:t}){this.videoInstance&&(this.data.infinityVideo||(t?this.videoInstance.play():this.videoInstance.pause())),this.onscreen=t,!(!t||this.played)&&this.playVideo()}async onBeside({state:t,first:e}){t&&e&&(await this.loadImage(),this.imageEffectInit(),this.videoEffectInit()),this.played||this.playVideo(),this.bgEffect&&(this.bgEffect.toggleRendering(t),this.bgEffect.draw())}onResize(){this.bgEffect&&requestAnimationFrame(()=>{this.bgEffect.reflow()}),this.data.type==="video"&&(this.videoInstance?(this.videoInstance.fitToSize(),this.data.effect&&this.fixHolder&&this.setParallax&&setTimeout(()=>{this.fixHolder(),this.setParallax()},100),setTimeout(()=>{this.videoInstance.fitToSize()},150)):this.fixHolder&&this.fixHolder())}async loadImage(){if(!(this.image.id&&(this.data.type==="image"||this.data.type==="video"&&this.data.videoPreview==="image")))return;this.isImgLoading=!0;let e={width:this.componentWidth||this.component.offsetWidth,height:this.componentHeight||this.component.offsetHeight},{width:i}=this.image.original?{width:0}:await R(this.image,e,{...this.data.imageLoadingOptions,sizes:$e});if(this.image.url=k(this.image,i,this.data.imageLoadingOptions),!this.data.isImgLoaded){if(this.data.hasImagePlaceholder)try{await B(this.image.url)}catch(s){console.error("Background preload error",s);return}this.setImage(this.image.url)}this.isImgLoading=!1}setImage(t){this.$component.find(".image-holder").css("background-image",`url(${t})`),this.$component.addClass("image-loaded"),this.isImgLoading=!1,this.data.isImgLoaded=!0}imageEffectInit(){if(this.data.type!=="image"||!this.data.effect||flexbe_cli.vars.globals.isScreenshot)return;let{owner:t,$component:e,data:i,image:s}=this,n=t._core?.id||t.getAttribute("data-id");typeof t._bgEffects=="object"&&t._bgEffects.destroy();let a=i.effect!=="fixed";a&&i.effectMobile==="off"&&flexbe_cli.run.is_screen_mobile&&(a=!1),a&&(this.bgEffect=new ge(n,e,i.effect,s),t._bgEffects=this.bgEffect)}videoEffectInit(){if(this.data.type!=="video"||this.data.effect!=="parallax"||flexbe_cli.vars.globals.isScreenshot)return;let t=this.$component.find(".video-holder, .image-holder"),e=this.owner._core,i=this.data,s=()=>e.tween.height+(flexbe_cli.resize.viewportHeight-e.tween.height)*i.videoParallaxFactor,n=()=>{t.css("height",`${s()}px`)},a=()=>{if(this.data.effectMobile==="off"&&flexbe_cli.run.is_screen_mobile){t.css("top","");return}let o=1-this.data.videoParallaxFactor,l=Math.floor((flexbe_cli.scroll.latest-e.tween.start)*-o)||0;t.css("top",`${l}px`)};n(),a(),e.$area.off(`fixHeaderHeight.component-bg-${e.id}`).on(`fixHeaderHeight.component-bg-${e.id}`,()=>{a()}),$(window).off(`scroll.component-bg-${e.id}`).on(`scroll.component-bg-${e.id}`,()=>{this.onscreen&&a()}),this.fixHolder=n,this.setParallax=a}playVideo(){if(flexbe_cli.run.is_screen_mobile&&!this.data.mobileVideoEnabled||flexbe_cli.vars.globals.isCriticalCss||flexbe_cli.vars.globals.isScreenshot||flexbe_cli.vars.globals.isBot)return!1;let t=this.data,e={id:t.videoId,type:t.videoType,link:t.videoLink,width:t.videoWidth,height:t.videoHeight};return this.data.type!=="video"||!e.id&&!e.link?!1:(this.played=!0,this.videoInstance||(this.videoInstance=new be(this,e,()=>{this.videoEffectInit()})),!0)}onDestroy(){this.core.$area.off(`fixHeaderHeight.component-bg-${this.core.id}`),$(window).off(`scroll.component-bg-${this.core.id}`),this.bgEffect&&this.bgEffect.destroy(),this.videoInstance&&this.videoInstance.destroy()}};flexbe_cli.entity.setClientJs("modal","GRID",{components:[M],onClose(){this.$area.find(".component-form .is_error").removeClass("is_error")}});var ve={selectClass:"",dropdownClass:"",selectedClass:"selected",optionSelector:"option",attrValue:"value",position:"over",padding:10,title:!1},wt=(t,e)=>{if(!t)return;let i=t.value;t.innerHTML="";let s=t.getAttribute("data-placeholder");if(s){let a=document.createElement("option");a.value="",a.textContent=s,t.appendChild(a)}e.forEach(a=>{let o=document.createElement("option");o.value=a.value,o.textContent=a.label,t.appendChild(o)}),e.some(a=>a.value===i)&&(t.value=i),(t.querySelector(`option[value="${i}"]`)||t.querySelector("option")).setAttribute("selected","selected")},tt=class{static create(t){return new this(t)}static getInstance(t){return $(t).data("selectComponent")}constructor(t){this.opts=t,this.config={...ve,...t.config},this.element=t.element,this.$select=$(this.element),this.isNativeSelect=this.$select.is("select"),this.selectAllDevice=this.$select.data("type")==="select",this.blurTimeOut=!1,this.blurListTimeOut=!1,this.focused=!1,this.active=!1,this.$select.data("selectComponent",this),this.createSelect()}createSelect(){this.$customSelect=$(`
            <div class="dropdown-container ${this.config.selectClass}">
                <div tabindex="0" class="dropdown-select">
                    <span class="dropdown-select__content selected"></span>

                    <span class="arrow">
                        <svg viewBox="0 0 10 6" xmlns="http://www.w3.org/2000/svg">
                            <path fill="currentColor" d="M 1.4 6.99441e-15L 0 1.34043L 5 6L 10 1.34043L 8.6 0L 5 3.34998L 1.4 6.99441e-15Z"/>
                        </svg>
                    </span>
                </div>
            </div>
        `),this.$customSelect__content=this.$customSelect.find(".dropdown-select__content"),this.$select.after(this.$customSelect),this.syncSelect(),this.$select.on("syncSelectUI",()=>this.syncSelect()),this.selectAllDevice||flexbe_cli.run.is_screen_desktop?(this.$customSelect.off("click.selected").on("click.selected",".dropdown-select",t=>{clearTimeout(this.blurListTimeOut),this.active?this.collapse():this.activate(t)}),this.$customSelect.off("focus.selectFocus").on("focus.selectFocus",".dropdown-select",()=>{this.focused=!0,this.$listWrapper||this.createList()}),this.isNativeSelect&&this.$select.off("change.changeSelect").on("change.changeSelect",t=>{let e=t.currentTarget.value;if(this.$listWrapper){let i=this.$listWrapper.find(".dropdown-select-ul li");i.removeClass(this.config.selectedClass),i.filter((s,n)=>n.getAttribute(this.config.attrValue)===e).addClass(this.config.selectedClass)}this.$customSelect__content.text(e),typeof this.opts.onChange=="function"&&this.opts.onChange(t)}),this.$customSelect.off("blur.selectBlur").on("blur.selectBlur",".dropdown-select",t=>{setTimeout(()=>{this.collapse()},500)}),this.$customSelect.off("keydown.selectKeydown").on("keydown.selectKeydown",".dropdown-select",t=>{if(this.focused&&[13,27,32,38,40].includes(t.keyCode)){t.preventDefault();let e=this.$list.find(`.option-e.${this.config.selectedClass}`).filter(i=>!$(i).attr("disabled"));if(t.keyCode===40)t.preventDefault(),this.select(e.next(),!1),this.scrollToSelected();else if(t.keyCode===38)t.preventDefault(),this.select(e.prev(),!1),this.scrollToSelected();else if(!this.active&&t.keyCode===32)t.preventDefault(),this.activate(t);else if(this.active&&[13,27,32].includes(t.keyCode))return t.preventDefault(),this.collapse(),!1}})):this.$select.off("change.selected").on("change.selected",t=>{let e=t.target.value||$(t.currentTarget.options[0]).text();this.$customSelect__content.text(e)})}syncSelect(){let e=this.$select.children(this.config.optionSelector).filter((s,n)=>(n.selected??$(n).attr("selected"))||$(n).hasClass(this.config.selectedClass)).eq(0),i=e.html()||"\u2014";this.$customSelect__content.attr(this.config.attrValue,e.attr(this.config.attrValue)),this.$customSelect__content.html(i)}createList(){let t=this.$select.children(this.config.optionSelector);this.$listWrapper=$(`
            <div class="select-container-in-body">
                <div class="overlay"></div>
                <ul class="dropdown-select-ul scroller ${this.config.dropdownClass}" tabindex="0"></ul>
            </div>
        `),this.$list=this.$listWrapper.find(".dropdown-select-ul"),t.each((e,i)=>{let s=$(i),n=(i.selected??s.attr("selected"))||s.hasClass(this.config.selectedClass),a=(i.disabled??s.attr("disabled"))||s.hasClass("disabled"),o=(i.locked??s.attr("locked"))||s.hasClass("locked"),l=this.isNativeSelect?s.val():s.attr(this.config.attrValue),r=s.html().trim()||"\u2014",c="";this.config.title&&(c=s.attr("data-title"));let d=$(`<li title='${c}' class="option-e"></li>`);n&&!a&&d.addClass(this.config.selectedClass),a&&d.attr("disabled","disabled"),o&&d.attr("locked","locked"),d.attr(this.config.attrValue,l),d.html(r),this.$list.append(d)})}select(t,e){if(!t[0])return;if(t.attr("disabled")){clearTimeout(this.blurTimeOut),this.$list.off("blur.listBlur").on("blur.listBlur",()=>{this.focused=!1,this.blurListTimeOut=setTimeout(()=>{this.$listWrapper&&this.collapse()},200)});return}let s=t.attr(this.config.attrValue),n=this.$select.children(this.config.optionSelector);t.siblings("li").removeClass(this.config.selectedClass),t.addClass(this.config.selectedClass),n.removeAttr("selected").removeClass(this.config.selectedClass),n.filter(`[${this.config.attrValue}='${s}']`).addClass(this.config.selectedClass).attr("selected","selected"),this.$select.val(s),this.$select.trigger("change"),this.$select.closest(".is_error").removeClass("is_error"),this.syncSelect(),e&&this.collapse()}scrollToSelected(){let t=this.$list[0].offsetHeight;if(this.$list[0].scrollHeight<=t)return!1;let s=this.$list.children(".option-e").find(`.${this.config.selectedClass}`)[0];s&&s.scrollIntoView()}collapse(){clearTimeout(this.blurTimeOut),this.active=!1,this.$listWrapper.removeClass("active rise"),this.$listWrapper.detach(),typeof this.opts.onCollapse=="function"&&this.opts.onCollapse()}activate(t){if(this.active)return!1;this.active=!0,this.createList();let e=this.config.padding||0,i=this.$customSelect[0].getBoundingClientRect(),s={left:i.left+window.scrollX,top:i.top+window.scrollY,width:i.width,height:i.height};this.config.position==="under"&&(s.top=s.top+s.height+e),this.$listWrapper.off("click.closeSelect").on("click.closeSelect",".overlay",n=>{this.collapse();let a=document.elementFromPoint(n.clientX,n.clientY);a&&a.focus()}),this.$listWrapper.off("click.selectLi").on("click.selectLi",".dropdown-select-ul li",n=>{let a=$(n.currentTarget);this.select(a,!0),typeof this.opts.onSelect=="function"&&this.opts.onSelect(n)}),this.$listWrapper.off("mousewheel.selectUl").on("mousewheel.selectUl",".dropdown-select-ul",n=>{let a=n.currentTarget.scrollHeight,o=n.currentTarget.clientHeight;return!(n.currentTarget.scrollTop===a-o&&n.deltaY>0||n.currentTarget.scrollTop===0&&n.deltaY<0)}),$("body").append(this.$listWrapper),clearTimeout(this.blurTimeOut),this.$list.css({left:`${s.left}px`,top:`${s.top}px`,width:`${s.width}px`}),this.$listWrapper.outerWidth(),this.$listWrapper.toggleClass("rise",!!this.$select.closest(".m_modal, .w_widget").length),this.$listWrapper.addClass("active"),this.scrollToSelected(),typeof this.opts.onActivate=="function"&&this.opts.onActivate(t)}};function Ot(t,e={}){let i=Object.keys(e),s=Object.values(e);return new Function(...i,`return \`${t}\`;`)(...s)}var et="default",Ht=class{#t=new Map;#e=null;strict=!1;constructor(t,e=!1){this.#e=t||this,this.strict=e}#i(t,e,i){(Array.isArray(t)?t:t.split(" ")).forEach(n=>{let[a,...o]=n.includes(".")?n.split("."):[n,et],l=o.join(".")||et;this.#t.has(a)||this.#t.set(a,new Map),this.#t.get(a).set(e,{once:i,namespace:l})})}on(t,e){return this.#i(t,e,!1),this}one(t,e){return this.#i(t,e,!0),this}off(t,e){return(Array.isArray(t)?t:t.split(" ")).forEach(s=>{let[n,...a]=s.includes(".")?s.split("."):[s,et],o=a.join(".")||et;(n?[this.#t.get(n)]:[...this.#t.values()]).filter(Boolean).forEach(r=>{Array.from(r.entries()).forEach(([c,d])=>{(!e||e===c)&&d.namespace===o&&r.delete(c)}),r.size===0&&this.#t.delete(n)})}),this}clear(){return this.#t.clear(),this}async trigger(t,...e){let[i,...s]=t.split("."),n=s.join("."),a=this.#t.get(i),o=this.#t.get("*"),l=[];return a&&a.forEach((r,c)=>{(!n||r.namespace.startsWith(n))&&(l.push(Promise.resolve(c.call(this.#e,...e))),r.once&&a.delete(c))}),o&&o.forEach((r,c)=>{l.push(Promise.resolve(c.call(this.#e,t,...e)))}),this.strict&&l.length===0&&console.warn(`No listeners for event: ${t}`),Promise.all(l)}async emit(t,...e){return this.trigger(t,...e)}};var it=class{constructor(t){this.$legend=t.find(".range-legend"),this.$component=t.find(".range-outer"),this.$input=t.find("input"),this.startEdge=this.$component.data("start"),this.isDouble=!!this.$component.data("double"),this.endEdge=this.$component.data("end"),this.range=this.endEdge-this.startEdge,this.barWidth=this.$component.width(),this.step=this.$component.data("step")||1,this.steps=Math.round(this.range/this.step),this.legendType=this.$legend.data("type"),this.legendText=+this.$legend.data("text")==1,this.animated=!0,this.duration=this.steps<10?300*(1/this.steps):!1,this.fractExponent=Math.max(this.getFract(this.startEdge),this.getFract(this.endEdge),this.getFract(this.step)),this.fractDevider=10**this.fractExponent,this.$value=$(".range-value",this.$component),this.$endRunner=$(".range-runner-right",this.$component),this.$endRunnerTip=$(".runner-tip",this.$endRunner),this.$endRunnerValue=$(".value",this.$endRunner),this.$startRunner=$(".range-runner-left",this.$component),this.$startRunnerValue=$(".value",this.$startRunner),this.$startRunnerTip=$(".runner-tip",this.$startRunner),this.startRunnerWidth=this.$startRunner.width(),this.maxAllowedLeft=20,this.maxAllowedRight=flexbe_cli.resize.viewportWidth-20,this.defaultShift=this.$endRunner.width()/2,this.activeRunner=!1,this.startValue=+this.startEdge;let e=String(this.$input.attr("value")).replace(/[^\d-]/g,"");if(this.isDouble){let i=e.split("-");this.startValue=i[1]?Number(i[0]):+this.startEdge,this.endValue=i[1]?Number(i[1]):+this.endEdge,e=`${this.startValue} \u2014 ${this.endValue}`}else this.endValue=e?Number(e):+this.startEdge,this.startValue=+this.startEdge,e=this.endValue;this.$input.attr("value",e),this.endParams={},this.drawLegend(),this.updateTooltip(this.$startRunnerTip),this.updateTooltip(this.$endRunnerTip),this.setEvents(),this.setRunnersValue()}formatN(t){let e=flexbe_cli.locale.formatNumber(t,this.fractExponent);return`${t<0?"-":""}${e}`}getFract(t){let e=`${t}`.split(".");return e[1]&&e[1].length||0}drawLegend(){if(this.legendText)return!1;let t=this.$legend.find(".from"),e=this.$legend.find(".to");if(t.text(this.formatN(this.startEdge)),e.text(this.formatN(this.endEdge)),this.legendType!=="complex")return!1;this.$legend.find(".legend-point:not(.from, .to)").off("click").remove(),this.$legend.removeClass("complex").addClass("limits");let i=[`${this.formatN(this.startEdge)}`.length,`${this.formatN(this.endEdge)}`.length,`${this.formatN(this.step)}`.length],s=(i[0]+i[1]+i[2])/3,n=Math.max(this.startEdge,this.endEdge),a=[this.step*5*this.fractDevider/this.fractDevider];for(let u=1;u<=12;u++){let f=10**u*this.step;f<n&&p(a,f,this.fractDevider)}let o,l=Math.ceil(this.$legend.find(i[0]>i[1]?".from":".to").width()/Math.max(i[1],i[0])),r=Math.round(this.barWidth*.83/(l*s)),c=this.range>0?1:-1;for(let u=Math.min(r,10);u>=3;u--){let f=h(this.step,Math.abs(this.steps),u,a);if(f&&Number.isInteger(f/this.step)&&Number.isInteger(this.range/f)){o=f;break}}if(!o||!Number.isInteger(this.range/(o*c))||this.range/(o*c)<3)for(let u=Math.min(Math.round(Math.abs(this.range)/this.step),r,10);u>=2;u-=1){let f=this.roundFraction(Math.abs(this.range)/u);if(f%this.step===0){o=f;break}}let d=this.roundFraction(Math.abs(this.range)/o);if(o&&Number.isInteger(d)){let u=[];for(let m=1;m<d;m+=1){let g=Math.round((this.startEdge+o*m*c)*this.fractDevider)/this.fractDevider;u.push(`<div class="legend-point" data-value="${g}">${this.formatN(g)}</div>`)}d>2&&(this.$legend.attr("data-count",d),this.$legend.removeClass("limits").addClass("complex"));let f=$(u.join(""));this.$legend.find(".from").after(f)}else this.$legend.removeClass("complex").addClass("limits");this.$legend.find(".legend-point:not(.to), .legend-point:not(.from)").each((u,f)=>{$(f).on("click",()=>{if(this.updateBarWidth(),this.isDouble){let m=(this.startValue+this.endValue)/2,g=+$(f).data("value"),b=this.startEdge<this.endEdge?1:-1;g*b>=m*b?this.endValue=g:this.startValue=g}else this.endValue=$(f).data("value");this.setRunnersValue()})});function h(u,f,m,g){return g.includes(f/m*u)?f/m*u:g.includes((f+1)/m*u)?(f+1)/m*u:g.includes((f+2)/m*u)?(f+2)/m*u:g.includes((f+3)/m*u)?(f+3)/m*u:g.includes((f+4)/m*u)?(f+4)/m*u:g.includes((f+5)/m*u)?(f+5)/m*u:g.includes((f+6)/m*u)?(f+6)/m*u:g.includes((f+7)/m*u)?(f+7)/m*u:g.includes((f+8)/m*u)?(f+8)/m*u:g.includes((f+9)/m*u)?(f+9)/m*u:!1}function p(u,f,m){for(let g=1;g<10;g+=1)u.push(Math.round(f*g*m)/m),u.push(Math.round(f*g*m+f/2)/m)}}roundFraction(t){return Math.round(t*1e10)/1e10}setRunnersValue(t=!1){if(!Number.isFinite(this.endValue)||!Number.isFinite(this.range)||this.isDouble&&!Number.isFinite(this.startValue))return!1;let e=this.startEdge<this.endEdge?1:-1;this.activeRunner==="start"?this.startValue*e<=this.startEdge*e?this.startValue=this.startEdge:this.startValue*e>=this.endValue*e&&(this.startValue=this.endValue):this.endValue*e>=this.endEdge*e?this.endValue=this.endEdge:this.endValue*e<=this.startValue*e&&(this.endValue=this.startValue);let i=this.isDouble?this.startValue:this.startEdge,s=this.isDouble?(this.startValue-this.startEdge)/(this.range/100):0,n=(this.endValue-i)/(this.range/100);if(this.endValue=Math.round(this.endValue*this.fractDevider)/this.fractDevider,this.startValue=Math.round(this.startValue*this.fractDevider)/this.fractDevider,requestAnimationFrame(()=>{this.$endRunnerValue.text(this.formatN(this.endValue)),this.$startRunnerValue.text(this.formatN(this.startValue))}),this.activeRunner==="end"?this.updateTooltip(this.$endRunnerTip):this.updateTooltip(this.$startRunnerTip),this.$value.css({width:`${n}%`,marginLeft:`${s}%`}),!t){let a;this.isDouble?a=`${this.startValue} \u2014 ${this.endValue}`:a=this.endValue,this.$input.attr("value")!==String(a)&&(this.$input.attr("value",a),this.$input.trigger("change"))}}updateTooltip(t){let e=t.closest(".range-runner");if(e&&e.length){let i=t.innerWidth(),n=t.closest(".range-runner")[0].getBoundingClientRect().left+this.startRunnerWidth/2,a;i/2>n+this.maxAllowedLeft?a=i/2-(n-this.maxAllowedLeft):i/2+n>this.maxAllowedRight?a=this.maxAllowedRight-n-i/2:a=0,t.css({transform:`translateX(${a}px)`})}}getValueFromLength(t){let e=this.range/(this.barWidth/t);return(Math.round(e/this.step)+this.startEdge/this.step)*this.step}applyEndPosition(t){let e=this.activeRunner==="start"?"startValue":"endValue";return this[e]=this.getValueFromLength(t),this.setRunnersValue(),!0}touchHandler(t){if(!this.endParams.active||t.touches.length!==1)return $("body")[0].removeEventListener("touchmove",this.touchHandler),!1;this.toggleAnimation(!1),t.preventDefault(),t.stopPropagation();let e=t.touches[0].pageX-this.endParams.left-this.endParams.shift;return this.applyEndPosition(e),!0}startWatchingEvents(t=this.defaultShift){this.endParams={active:!0,left:this.$component.offset().left,shift:t},clearTimeout(this.calmRunnersTimeout),this.activeRunner==="end"?this.$endRunner.addClass("active"):this.$startRunner.addClass("active")}toggleAnimation(t){t?Math.abs(this.barWidth/this.steps)<15?this.$component.addClass("animated"):(this.$component.removeClass("active-animation"),this.duration&&this.$component.removeClass(`animation-speed-${12-Math.abs(Math.round(this.steps))}`)):Math.abs(this.barWidth/this.steps)<15?this.$component.removeClass("animated"):(this.$component.addClass("active-animation"),this.duration&&this.$component.addClass(`animation-speed-${12-Math.abs(Math.round(this.steps))}`))}afterRunnerReleased(){this.endParams.active&&(this.activeRunner==="start"?this.$startRunner.focus():this.$endRunner.focus()),this.endParams.active=!1,this.debounceActive(),this.barWidth/this.steps<15?this.$component.addClass("animated"):this.$component.removeClass("active-animation"),this.toggleAnimation(!0)}updateBarWidth(){let t=this.$component.width();t!==this.barWidth&&(this.barWidth=t,this.legendType==="complex"&&this.drawLegend())}setEvents(){let t=$(window),e=this;this.$component.on("resize",()=>{this.updateBarWidth()}),this.$component.on("touchstart",s=>{if(s.touches.length!==1)return!1;if(this.isDouble){let a=(this.$endRunner.offset().left+this.$startRunner.offset().left)/2;this.activeRunner=s.touches[0].pageX>=a?"end":"start",this.activeRunner==="start"?(this.$startRunner.addClass("upper-runner"),this.$endRunner.removeClass("upper-runner")):(this.$endRunner.addClass("upper-runner"),this.$startRunner.removeClass("upper-runner"))}else this.activeRunner="end";s.stopPropagation(),this.updateBarWidth();let n=s.touches[0].pageX-this.$value.offset().left;this.startWatchingEvents(),this.applyEndPosition(n-this.defaultShift),t[0].addEventListener("touchmove",this.touchHandler.bind(this),{passive:!1}),t.on("touchend.range",()=>{this.afterRunnerReleased(),t[0].removeEventListener("touchmove",this.touchHandler),t.off("touchend.range")})}),this.$component.on("mousedown",s=>{let n=s.pageX-this.$component.offset().left;if(this.isDouble){let a=(this.$endRunner.offset().left+this.$startRunner.offset().left)/2;this.activeRunner=s.pageX>=a?"end":"start",this.activeRunner==="start"?(this.$startRunner.addClass("upper-runner"),this.$endRunner.removeClass("upper-runner")):(this.$endRunner.addClass("upper-runner"),this.$startRunner.removeClass("upper-runner"))}this.updateBarWidth(),this.startWatchingEvents(),this.applyEndPosition(n-this.defaultShift),this.activeRunner==="start"?this.$startRunner.focus():this.$endRunner.focus(),t.on("mousemove.dragRange",i),t.on("mouseup.range",()=>{this.afterRunnerReleased(),t.off("mousemove.dragRange"),t.off("mouseup.range")})}),this.$endRunner.on("touchstart",s=>{if(s.touches.length!==1)return!1;s.stopPropagation(),this.updateBarWidth(),this.activeRunner="end",this.$startRunner.removeClass("upper-runner"),this.$endRunner.addClass("upper-runner"),s.stopPropagation(),this.startWatchingEvents(s.touches[0].pageX-this.$endRunner.offset().left),this.toggleAnimation(!1),t[0].addEventListener("touchmove",this.touchHandler.bind(this),{passive:!1}),t.on("touchend.range",()=>{this.afterRunnerReleased(),t[0].removeEventListener("touchmove",this.touchHandler),t.off("touchend.range")})}),this.$startRunner.on("touchstart",s=>{if(s.touches.length!==1)return!1;s.stopPropagation(),this.updateBarWidth(),this.activeRunner="start",this.$startRunner.addClass("upper-runner"),this.$endRunner.removeClass("upper-runner"),s.stopPropagation(),this.startWatchingEvents(s.touches[0].pageX-this.$startRunner.offset().left),this.toggleAnimation(!1),t[0].addEventListener("touchmove",this.touchHandler.bind(this),{passive:!1}),t.on("touchend.range",()=>{this.afterRunnerReleased(),t[0].removeEventListener("touchmove",this.touchHandler),t.off("touchend.range")})}),this.$endRunner.on("mousedown",s=>{s.stopPropagation(),this.activeRunner="end",this.$startRunner.removeClass("upper-runner"),this.$endRunner.addClass("upper-runner"),this.updateBarWidth(),this.$endRunner.focus(),this.startWatchingEvents(s.pageX-this.$endRunner.offset().left),this.toggleAnimation(!1),t.on("mousemove.dragRange",i),t.on("mouseup.range",()=>{this.afterRunnerReleased(),t.off("mousemove.dragRange"),t.off("mouseup.range")})}),this.$startRunner.on("mousedown",s=>{s.stopPropagation(),this.activeRunner="start",this.$startRunner.addClass("upper-runner"),this.$endRunner.removeClass("upper-runner"),this.updateBarWidth(),this.$startRunner.focus(),this.startWatchingEvents(s.pageX-this.$startRunner.offset().left),this.toggleAnimation(!1),t.on("mousemove.dragRange",i),t.on("mouseup.range",()=>{this.afterRunnerReleased(),t.off("mousemove.dragRange"),t.off("mouseup.range")})}),this.$legend.find(".legend-point.to, .legend-point.from").each((s,n)=>{$(n).on("click",()=>{if(this.updateBarWidth(),this.isDouble){let a=this.startEdge<this.endEdge?1:-1,o=(this.startValue+this.endValue)/2,l=+$(n).data("value");l*a>=o*a?this.endValue=l:this.startValue=l}else this.endValue=$(n).data("value");this.setRunnersValue()})}),this.$input.on("change",()=>{if(this.isDouble){let s=this.$input.val().split(" \u2014 ");this.startValue=+s[0],this.endValue=+s[1]}else this.endValue=+this.$input.val();this.setRunnersValue(!0)}),this.$startRunner.on("keyup",s=>{s.preventDefault(),this.activeRunner="start",this.handleKeydown(s,this.$startRunner)}),this.$endRunner.on("keyup",s=>{s.preventDefault(),this.activeRunner="end",this.handleKeydown(s,this.$endRunner)}),this.$startRunner.on("keydown",s=>{this.activeRunner="start",this.handleKeyup(s,this.$startRunner)}),this.$endRunner.on("keydown",s=>{this.activeRunner="end",this.handleKeyup(s,this.$endRunner)}),this.$startRunner.on("blur",()=>{this.handleBlur()});function i(s){if(!e.endParams.active)return t.off("mousemove.dragRange"),!1;e.toggleAnimation(!1);let n=s.pageX-e.endParams.left-e.endParams.shift;return e.applyEndPosition(n),!0}}handleBlur(){this.movingInterval&&(clearInterval(this.movingInterval),this.movingInterval=!1),this.movingDebounceTimeout&&(clearTimeout(this.movingDebounceTimeout),this.movingDebounceTimeout=!1)}handleKeydown(t,e){if(this.movingInterval&&(clearInterval(this.movingInterval),this.movingInterval=!1),this.movingDebounceTimeout&&(clearTimeout(this.movingDebounceTimeout),this.movingDebounceTimeout=!1),[37,38,39,40].includes(t.keyCode)){let i=t.shiftKey?10:1,s=this.activeRunner==="start"?"startValue":"endValue";t.keyCode===38||t.keyCode===39?this[s]=(this[s]/this.step+i)*this.step:(t.keyCode===37||t.keyCode===40)&&(this[s]=(this[s]/this.step-i)*this.step),e.addClass("active"),this.debounceActive(),this.setRunnersValue()}}handleKeyup(t,e){t.keyCode!==9&&[37,38,39,40].includes(t.keyCode)&&(t.preventDefault(),e.addClass("active"),this.debounceActive(),this.startDebouncedMove(t))}startDebouncedMove(t){this.movingDebounceTimeout&&(clearTimeout(this.movingDebounceTimeout),this.movingDebounceTimeout=!1),this.movingDebounceTimeout=setTimeout(()=>{this.movingInterval=setInterval(()=>{this.debounceActive();let e=t.shiftKey?10:1,i=this.activeRunner==="start"?"startValue":"endValue";t.keyCode===38||t.keyCode===39?this[i]=(Math.round(this[i]/this.step)+e)*this.step:(t.keyCode===37||t.keyCode===40)&&(this[i]=(Math.round(this[i]/this.step)-e)*this.step),this.setRunnersValue()},50)},300)}debounceActive(){this.calmRunnersTimeout&&clearTimeout(this.calmRunnersTimeout),this.calmRunnersTimeout=setTimeout(()=>{this.$endRunner.removeClass("active"),this.$startRunner.removeClass("active")},500)}};function st(t,e){let i=$(t),s=i.closest("[data-type]").attr("data-type"),n=i.attr("data-date-range")||"any",a=i.attr("data-date-work-days")??"0,1,2,3,4,5,6",o=31,l=11,r=new Date().getFullYear()+3;s==="datetime"&&(r=new Date().getMonth()>=8?new Date().getFullYear()+1:new Date().getFullYear());let c=new Date(new Date().getFullYear()-100,0,1),d=new Date(r,l,o);(s==="datetime"||n==="future")&&(c=new Date),s==="date"&&n==="past"&&(d=new Date);let h={type:s,lowerLimit:c,upperLimit:d,dateRange:n,locale:flexbe_cli.locale.translation.calendar,dateFormat:flexbe_cli.locale.dateFormat,showDateSelector:s==="date"&&n!=="future",insertTo:e,workDays:a.length?a.split(","):[],workTime:null};if(s==="datetime"){let p=i.attr("data-date-time-interval")||30,u=i.attr("data-date-time-start")||"00:00",f=i.attr("data-date-time-finish")||"00:00";h.workTime={interval:p,start:{hour:+u.substring(0,2),minute:+u.substring(3,5)},finish:{hour:+f.substring(0,2),minute:+f.substring(3,5)}}}i.calendar(h)}var O={notStarted:0,inProgress:1,done:2,error:3,abort:4},ye=4*1024*1024,we=class Ut extends Ht{status=O.notStarted;progress=0;static async getFileHash(e){let i=e.name,s=await xe(e);return flexbe_cli.helpers.hashCode(i+s.slice(0,ye))}constructor(e){super(),this.file=e,this.name=e.name}async init(){this.id=await Ut.getFileHash(this.file)}upload(){this.trigger("start");let e=flexbe_cli.helpers.upload(this.file,{onProgress:(i,s)=>{s.lengthComputable&&(this.progress=s.loaded/s.total),this.trigger("progress",{jqXhr:i,progress:this.progress})},onSuccess:(i,s)=>{this.uri=i.fileUri,this.status=O.done,this.trigger("success",{jqXHR:i,textStatus:s})},onError:(i,s)=>{this.progress=1,this.status=s==="abort"?O.abort:O.error,this.trigger("error",{jqXHR:i,textStatus:s})},onComplete:(i,s)=>{this.trigger("complete",{jqXHR:i,textStatus:s})}});return this.request=e,this.status=O.inProgress,e}async abort(){!this.request||this.status!==O.inProgress||(this.status=O.abort,this.request.abort())}};async function xe(t){return new Promise(e=>{let i=new FileReader;i.addEventListener("load",s=>{e(s.target.result)}),i.readAsBinaryString(t)})}var F={};function nt(t,e,i){let s=(n,a,o)=>{let l=n.find(".form-field-hidden"),r=Array.from(a).map(h=>h.uri).filter(h=>h),c=n.find('input[type="hidden"]'),d=new Set;c.each((h,p)=>{let u=$(p).attr("name");if(u?.includes("[fields]")){let f=u.split("[fields]")[0];d.add(f)}}),d.size===0&&d.add(""),d.forEach(h=>{let p=h?`${h}[fields][${o}][value][]`:`fields[${o}][value][]`;n.find(`input[name$="${p}"]`).remove(),r.forEach(u=>{l.append($(`<input class="value" type="hidden" name="${p}" value="${u}">`))})})};t.on(`change${e}`,".file-input--original",async n=>{let a=Object.values(n.currentTarget.files),o=null,l=[];if(!a.length)return;let r=$(n.currentTarget),c=r.closest("[data-field-id]"),d=c.find(".file-list"),h=c.attr("data-field-id"),p=c.attr("data-size"),u=c.attr("data-accept")?c.attr("data-accept").split(", "):[],f=(g,b)=>Ot(i,{id:b,fileName:g});if(p){let g=parseFloat(p);p.replace(/[^a-zA-Z]/g,"").toLowerCase()==="kb"?o=g*1e3:o=g*1e3*1e3}a=a.filter(g=>{let b=`.${g.name.split(".").pop().toLowerCase()}`;return u.length&&!u.includes(b)?(l.push(flexbe_cli.locale.tr("form::error_file_accept",{name:g.name})),!1):o&&g.size>o?(l.push(flexbe_cli.locale.tr("form::error_file_size",{name:g.name,size:p})),!1):!0}),F[h]||(F[h]=[]);let m=a.map(g=>new we(g));await Promise.all(m.map(async g=>g.init())),m=m.filter(g=>!F[h].find(b=>b.id===g.id)),m.forEach(g=>{let b=$(f(g.name,g.id));g.on("start",()=>{c.addClass("loading"),c.removeClass("is_error"),d.append(b)}),g.on("progress",({progress:y})=>{let _=124.853-124.853*y;b.find(".circle-loader__path").css({"stroke-dashoffset":`${_}`})}),g.on("success",()=>{s(c,F[h],h)}),g.on("error",y=>{y?.textStatus!=="abort"&&(b.addClass("is-error"),c.addClass("is_error"),c.find(".error-text").append(flexbe_cli.locale.tr("form::error_file")))}),g.on("complete",()=>{b.removeClass("loading"),F[h].every(y=>y.progress===1)&&c.removeClass("loading")}),g.upload()}),c.find(".error-text").html(""),l.length&&(c.addClass("is_error_info"),c.find(".error-text").html(l.join("<br>")).append("<br>"),l=[]),F[h].push(...m),r.val("")}),t.on(`click${e}`,".clear-files",n=>{let a=$(n.currentTarget).parents(".file-item"),o=$(n.currentTarget).closest("[data-field-id]"),l=o.attr("data-field-id"),r=a.attr("data-id"),c=F[l].find(d=>d.id===r);o.removeClass("is_error is_error_info"),o.find(".error-text").html(""),F[l]=F[l].filter(d=>d.id!==c.id),a.remove(),c.abort(),s(o,F[l],l)})}function at(){F={}}var _e={phone:{RU:["+7 (***) ***-**-**","8 (***) ***-**-**"],KZ:["+7 (***) ***-**-**","8 (***) ***-**-**"],UA:["+38 (***) ***-****"],BY:["+375 ** *******"],US:["+1 (***) ***-****"]}};function Ce(t){let e=String(t).toLowerCase(),i=flexbe_cli.vars.site.country,s=_e[e]?.[i];return s&&typeof s=="string"&&(s=[s]),Object.assign([],s)}function ot(t){if(typeof window.IMask>"u")return;let s={signed:!0,lazy:!0,padFractionalZeros:!0,definitions:t.getAttribute("type")==="tel"?{"*":/\d/,"#":/\d/}:{"#":/\d/,"@":/[A-Za-z\u00AA\u00B5\u00BA\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02C1\u02C6-\u02D1\u02E0-\u02E4\u02EC\u02EE\u0370-\u0374\u0376\u0377\u037A-\u037D\u0386\u0388-\u038A\u038C\u038E-\u03A1\u03A3-\u03F5\u03F7-\u0481\u048A-\u0527\u0531-\u0556\u0559\u0561-\u0587\u05D0-\u05EA\u05F0-\u05F2\u0620-\u064A\u066E\u066F\u0671-\u06D3\u06D5\u06E5\u06E6\u06EE\u06EF\u06FA-\u06FC\u06FF\u0710\u0712-\u072F\u074D-\u07A5\u07B1\u07CA-\u07EA\u07F4\u07F5\u07FA\u0800-\u0815\u081A\u0824\u0828\u0840-\u0858\u08A0\u08A2-\u08AC\u0904-\u0939\u093D\u0950\u0958-\u0961\u0971-\u0977\u0979-\u097F\u0985-\u098C\u098F\u0990\u0993-\u09A8\u09AA-\u09B0\u09B2\u09B6-\u09B9\u09BD\u09CE\u09DC\u09DD\u09DF-\u09E1\u09F0\u09F1\u0A05-\u0A0A\u0A0F\u0A10\u0A13-\u0A28\u0A2A-\u0A30\u0A32\u0A33\u0A35\u0A36\u0A38\u0A39\u0A59-\u0A5C\u0A5E\u0A72-\u0A74\u0A85-\u0A8D\u0A8F-\u0A91\u0A93-\u0AA8\u0AAA-\u0AB0\u0AB2\u0AB3\u0AB5-\u0AB9\u0ABD\u0AD0\u0AE0\u0AE1\u0B05-\u0B0C\u0B0F\u0B10\u0B13-\u0B28\u0B2A-\u0B30\u0B32\u0B33\u0B35-\u0B39\u0B3D\u0B5C\u0B5D\u0B5F-\u0B61\u0B71\u0B83\u0B85-\u0B8A\u0B8E-\u0B90\u0B92-\u0B95\u0B99\u0B9A\u0B9C\u0B9E\u0B9F\u0BA3\u0BA4\u0BA8-\u0BAA\u0BAE-\u0BB9\u0BD0\u0C05-\u0C0C\u0C0E-\u0C10\u0C12-\u0C28\u0C2A-\u0C33\u0C35-\u0C39\u0C3D\u0C58\u0C59\u0C60\u0C61\u0C85-\u0C8C\u0C8E-\u0C90\u0C92-\u0CA8\u0CAA-\u0CB3\u0CB5-\u0CB9\u0CBD\u0CDE\u0CE0\u0CE1\u0CF1\u0CF2\u0D05-\u0D0C\u0D0E-\u0D10\u0D12-\u0D3A\u0D3D\u0D4E\u0D60\u0D61\u0D7A-\u0D7F\u0D85-\u0D96\u0D9A-\u0DB1\u0DB3-\u0DBB\u0DBD\u0DC0-\u0DC6\u0E01-\u0E30\u0E32\u0E33\u0E40-\u0E46\u0E81\u0E82\u0E84\u0E87\u0E88\u0E8A\u0E8D\u0E94-\u0E97\u0E99-\u0E9F\u0EA1-\u0EA3\u0EA5\u0EA7\u0EAA\u0EAB\u0EAD-\u0EB0\u0EB2\u0EB3\u0EBD\u0EC0-\u0EC4\u0EC6\u0EDC-\u0EDF\u0F00\u0F40-\u0F47\u0F49-\u0F6C\u0F88-\u0F8C\u1000-\u102A\u103F\u1050-\u1055\u105A-\u105D\u1061\u1065\u1066\u106E-\u1070\u1075-\u1081\u108E\u10A0-\u10C5\u10C7\u10CD\u10D0-\u10FA\u10FC-\u1248\u124A-\u124D\u1250-\u1256\u1258\u125A-\u125D\u1260-\u1288\u128A-\u128D\u1290-\u12B0\u12B2-\u12B5\u12B8-\u12BE\u12C0\u12C2-\u12C5\u12C8-\u12D6\u12D8-\u1310\u1312-\u1315\u1318-\u135A\u1380-\u138F\u13A0-\u13F4\u1401-\u166C\u166F-\u167F\u1681-\u169A\u16A0-\u16EA\u1700-\u170C\u170E-\u1711\u1720-\u1731\u1740-\u1751\u1760-\u176C\u176E-\u1770\u1780-\u17B3\u17D7\u17DC\u1820-\u1877\u1880-\u18A8\u18AA\u18B0-\u18F5\u1900-\u191C\u1950-\u196D\u1970-\u1974\u1980-\u19AB\u19C1-\u19C7\u1A00-\u1A16\u1A20-\u1A54\u1AA7\u1B05-\u1B33\u1B45-\u1B4B\u1B83-\u1BA0\u1BAE\u1BAF\u1BBA-\u1BE5\u1C00-\u1C23\u1C4D-\u1C4F\u1C5A-\u1C7D\u1CE9-\u1CEC\u1CEE-\u1CF1\u1CF5\u1CF6\u1D00-\u1DBF\u1E00-\u1F15\u1F18-\u1F1D\u1F20-\u1F45\u1F48-\u1F4D\u1F50-\u1F57\u1F59\u1F5B\u1F5D\u1F5F-\u1F7D\u1F80-\u1FB4\u1FB6-\u1FBC\u1FBE\u1FC2-\u1FC4\u1FC6-\u1FCC\u1FD0-\u1FD3\u1FD6-\u1FDB\u1FE0-\u1FEC\u1FF2-\u1FF4\u1FF6-\u1FFC\u2071\u207F\u2090-\u209C\u2102\u2107\u210A-\u2113\u2115\u2119-\u211D\u2124\u2126\u2128\u212A-\u212D\u212F-\u2139\u213C-\u213F\u2145-\u2149\u214E\u2183\u2184\u2C00-\u2C2E\u2C30-\u2C5E\u2C60-\u2CE4\u2CEB-\u2CEE\u2CF2\u2CF3\u2D00-\u2D25\u2D27\u2D2D\u2D30-\u2D67\u2D6F\u2D80-\u2D96\u2DA0-\u2DA6\u2DA8-\u2DAE\u2DB0-\u2DB6\u2DB8-\u2DBE\u2DC0-\u2DC6\u2DC8-\u2DCE\u2DD0-\u2DD6\u2DD8-\u2DDE\u2E2F\u3005\u3006\u3031-\u3035\u303B\u303C\u3041-\u3096\u309D-\u309F\u30A1-\u30FA\u30FC-\u30FF\u3105-\u312D\u3131-\u318E\u31A0-\u31BA\u31F0-\u31FF\u3400-\u4DB5\u4E00-\u9FCC\uA000-\uA48C\uA4D0-\uA4FD\uA500-\uA60C\uA610-\uA61F\uA62A\uA62B\uA640-\uA66E\uA67F-\uA697\uA6A0-\uA6E5\uA717-\uA71F\uA722-\uA788\uA78B-\uA78E\uA790-\uA793\uA7A0-\uA7AA\uA7F8-\uA801\uA803-\uA805\uA807-\uA80A\uA80C-\uA822\uA840-\uA873\uA882-\uA8B3\uA8F2-\uA8F7\uA8FB\uA90A-\uA925\uA930-\uA946\uA960-\uA97C\uA984-\uA9B2\uA9CF\uAA00-\uAA28\uAA40-\uAA42\uAA44-\uAA4B\uAA60-\uAA76\uAA7A\uAA80-\uAAAF\uAAB1\uAAB5\uAAB6\uAAB9-\uAABD\uAAC0\uAAC2\uAADB-\uAADD\uAAE0-\uAAEA\uAAF2-\uAAF4\uAB01-\uAB06\uAB09-\uAB0E\uAB11-\uAB16\uAB20-\uAB26\uAB28-\uAB2E\uABC0-\uABE2\uAC00-\uD7A3\uD7B0-\uD7C6\uD7CB-\uD7FB\uF900-\uFA6D\uFA70-\uFAD9\uFB00-\uFB06\uFB13-\uFB17\uFB1D\uFB1F-\uFB28\uFB2A-\uFB36\uFB38-\uFB3C\uFB3E\uFB40\uFB41\uFB43\uFB44\uFB46-\uFBB1\uFBD3-\uFD3D\uFD50-\uFD8F\uFD92-\uFDC7\uFDF0-\uFDFB\uFE70-\uFE74\uFE76-\uFEFC\uFF21-\uFF3A\uFF41-\uFF5A\uFF66-\uFFBE\uFFC2-\uFFC7\uFFCA-\uFFCF\uFFD2-\uFFD7\uFFDA-\uFFDC]/,"*":/./}},n=t.required,a=t.getAttribute("data-mask");a&&!/[ #()*@{}]/.test(a)?a=Ce(a):a=[a];try{if(a=a.filter(r=>/[ #()*@_{}]/.test(r)),a=a.map(r=>r.replace(/0/g,"\\0")),a.length===0)throw{message:"Mask is empty"};a.length===1?a=String(a[0]):a=a.map(r=>({...s,mask:r}));let o=new window.IMask(t,{...s,mask:a,dispatch:(r,c)=>{let d=c.compiledMasks;if(d.length===1)return d[0];let h=(c.value+r).replace(/\W/g,"");return d.find(p=>{let f=p.mask.replace(/\W/g,"")[0];return h[0]===f})||d[0]}}),l=()=>{o.masked.isComplete||!n&&!o.value?t.setAttribute("data-mask-complete",!0):t.removeAttribute("data-mask-complete"),t.setAttribute("value",o.value)};t.value&&l(),o.on("accept",l),$(t).on("focus",()=>{requestAnimationFrame(()=>{$(t).trigger("click")})}),t._mask=o}catch(o){o instanceof Error&&console.error("MASK ERROR:",{masks:a,errorMessage:o.message}),t.removeAttribute("data-mask")}}function rt(t){let e={},i={};for(let[s,n]of t.entries()){if(n instanceof File&&n.size===0)continue;if(n instanceof File){console.warn(`File object found in form data: ${s}. Files should be uploaded separately.`);continue}let a=s.match(/^(.*?)fields\[(\w+)\]\[(\w+)\](\[\])?$/);if(a){let o=a[1],l=a[2],r=a[3],c=a[4]==="[]",d=o?o.replace(/\[$/,"")+".fields":"fields";i[d]||(i[d]=new Map);let h=i[d];h.has(l)||h.set(l,{id:l});let p=h.get(l);c?(Array.isArray(p[r])||(p[r]=[]),p[r].push(n)):p[r]=n;continue}Nt(e,s,n)}for(let[s,n]of Object.entries(i)){let a=Array.from(n.values());Nt(e,s,a)}return e}function Nt(t,e,i){let s=Se(e);if(s.length===1){Wt(t,s[0],i);return}let n=t;for(let o=0;o<s.length-1;o++){let l=s[o];n[l]||(n[l]={}),n=n[l]}let a=s[s.length-1];if(a==="[]"){let o=s[s.length-2];Array.isArray(n[o])||(n[o]=[]),n[o].push(i)}else Wt(n,a,i)}function Wt(t,e,i){e in t?Array.isArray(t[e])?t[e].push(i):t[e]=[t[e],i]:t[e]=i}function Se(t){let e=[],i="",s=!1;for(let n=0;n<t.length;n++){let a=t[n];a==="["?(i&&(e.push(i),i=""),s=!0):a==="]"?((i||s)&&(e.push(i||"[]"),i=""),s=!1):i+=a}return i&&e.push(i),e}function lt(t,e={}){let i={fields:[],...e};t.forEach((s,n)=>{Object.prototype.hasOwnProperty.call(i,n)?Array.isArray(i[n])?i[n].push(s):i[n]=[i[n],s]:i[n]=s});try{for(let s in i)if(s.startsWith("fields[")){let n=s.match(/^fields\[(\w+)\]\[(\w+)\]$/);if(n){let a=n[1],o=n[2],l=i.fields.find(r=>r.id===a);l||(l={id:a},i.fields.push(l)),l[o]=i[s],delete i[s]}else{let a=s.match(/^fields\[(\w+)\]\[(\w+)\]\[\]$/);if(a){let o=a[1],l=a[2],r=i.fields.find(c=>c.id===o);r||(r={id:o},i.fields.push(r)),Array.isArray(r[l])||(r[l]=[]),r[l].push(i[s]),delete i[s]}}}typeof i.products=="string"&&(i.products=JSON.parse(i.products)),(i["pay[price]"]||i["pay[desc]"])&&(i.pay={price:Number(i["pay[price]"]),desc:String(i["pay[desc]"])})}catch(s){console.error(s)}return["is_ajax","captcha-token","roistatVisit","jsform","goal_html","goal","forceUpdateProduct","action","utmData","abTest","pay[price]","pay[desc]","results","fileOriginal","g-recaptcha-response"].forEach(s=>{delete i[s]}),Object.entries(i).forEach(([s,n])=>{n==null&&delete i[s]}),i}var L=class xt{static getRecaptchaSettings(){let e={env:{},...flexbe_cli.vars.site.captcha||{}};return!e.visible&&flexbe_cli.is_admin&&(e.enabled=0),e}constructor(e,i=xt.getRecaptchaSettings()){this.id=e.id,this.options=e,this.$form=e.$form,this.enabled=i.enabled,this.isOptional=i.ttl>0,this.isVisible=i.visible,this.isInvisible=!i.visible,this.inModal=!!(this.isVisible&&(this.isOptional||e.inModal)),this._widgetId=null,this._token=null}get loaded(){return typeof grecaptcha<"u"}get recaptchaSiteKey(){let{env:e}=xt.getRecaptchaSettings();return this.isVisible?e.RECAPTCHA_VISIBLE_SITE_KEY:e.RECAPTCHA_INVISIBLE_SITE_KEY}init(){if(!this.enabled||!this.loaded||this._inited)return;this._inited=!0;let e=this.$form.find(`.g-recaptcha-${this.isVisible?"visible":"invisible"}`);e[0]&&this.render(e[0])}getToken(){return this._token}render(e){if(!this.enabled||!this.loaded)return;let i=flexbe_cli.run.is_screen_mobile_s?"compact":"normal";this.isInvisible&&(i="invisible");let s=l=>{this._token=l,this.closeModal(),this._onSuccess(l)},n=()=>{this.reset(),this._onExpired()},a=()=>{this.reset(),this._onError()},o={size:i,sitekey:this.recaptchaSiteKey,callback:s,"expired-callback":n,"error-callback":a};grecaptcha.ready(()=>{try{this._widgetId=grecaptcha.render(e,o)}catch{}typeof this.options.onRecaptchaRendered=="function"&&this.options.onRecaptchaRendered(this)})}async runModalCaptcha(){let e=`captcha-${this.id}`;if(!this._modal){let s=$(`
                <div class="m_modal m_${e}" data-is="modal" data-id="${e}" data-m-id="CAPTCHA">
                    <div class="modal-data" data-overlay="true">
                        <div class="component-bg"><div class="layer overlay"></div></div>
                    
                        <div class="modal-content" data-contrast="dark" data-v="1" data-as="1">
                            <div class="close close-times"></div>

                            <div class="recaptcha-title">
                                ${flexbe_cli.locale.tr("quiz::captcha_label")}
                            </div>

                            <div id="recaptcha-${this.id}" class="g-recaptcha g-recaptcha-visible"></div>
                        </div>
                    </div>
                </div>
            `);flexbe_cli.modal.$list.append(s);let n=await flexbe_cli.entity.initArea(s);this._modal=n[0]}flexbe_cli.events.trigger("ui_modal_open",{id:e,options:{hash:!1,rise:!0,onClose:()=>{this._token||this._onError()}}});let i=this._modal.$area.find(".g-recaptcha");this._widgetId!=null?this.reset():this.render(i[0])}closeModal(){this._modal&&flexbe_cli.events.trigger("ui_modal_close",{id:this._modal.id})}runInvisibleChallenge(){!this.enabled||!this.loaded||this.isVisible||(grecaptcha.ready(()=>grecaptcha.execute(this._widgetId)),$('iframe[title="recaptcha challenge"]').parent().parent().css("z-index",2e3))}reset(){!this.enabled||!this.loaded||(this._token=null,this._widgetId!=null&&grecaptcha.ready(()=>grecaptcha.reset(this._widgetId)),typeof this.options.onReset=="function"&&this.options.onReset(this))}_onError(...e){typeof this.options.onError=="function"&&this.options.onError(this,...e)}_onSuccess(...e){typeof this.options.onSuccess=="function"&&this.options.onSuccess(this,...e)}_onExpired(...e){typeof this.options.onExpired=="function"&&this.options.onExpired(this,...e)}};var Ae=".form-field-text__input, .dropdown-select",Ie=".form-field-date__input",_t="next",N="result",Fe=class extends x{static is="quiz";constructor(...t){super(...t),this.id=this.core.id,this.eventId=`.quiz${this.id}`,this.products=null,this.pay=null,this.createQuiz()}onInit(){this.$masked=this.$form.find("[data-mask]"),this.$file=this.$component.find(".form-field-file"),this.require=[],this.$masked.length&&(this.needInitMasks=!0,this.require.push("/_s/lib/imask/imask.min.js")),this.$file.length&&(this.$itemTemplateFile=this.$itemTemplateFile||this.$file.find("template").clone()),this.$calendars=this.$form.find(".form-field-date__input"),this.$calendars.length&&(this.needInitCalendar=!0,this.require.push("/_s/lib/scroll-lock/scroll-lock.min.js"),this.require.push("/_s/lib/calendar/dist/js/calendar.js?v2.3.13","/_s/lib/calendar/dist/css/calendar.min.css?v2.3.5"))}onLoad(){(this.core.wasScreen||this.core.wasBeside)&&(this.needInitMasks&&this.initFieldMask(),this.needInitCalendar&&this.initFieldDate()),this.isLoaded=!0}onScreen({state:t}){if(!t)return!1;this.initQuiz()}onBeside({state:t}){if(!t)return!1;this.initQuiz()}onOpen(t={}){this.initQuiz(),this.started||this.startQuiz(),t&&t.data&&this.setData(t.data)}onResize(){this.$component.find(".range-outer").trigger("resize")}createQuiz(){this.timeouts=[],this.history=[],this.swiper=[],this.$area=this.core.$area,this.$root=this.core.$root,this.$form=this.$component.is("form")?this.$component:this.$component.find("form"),this.$steps=this.$component.find(".quiz-steps"),this.$actions=this.$component.find(".quiz-actions"),this.$progress=this.$component.find(".quiz-progress"),this.$scroller=this.$root.find(".scroller"),this.$stepsWrapper=this.$steps.find(".steps-wrapper"),this.$outerWrapper=this.$area.find('[data-quiz-part="wrapper"]'),this.$welcomeScreen=this.$outerWrapper.find('[data-quiz-part="welcome"]'),this.$progress.length||(this.$progress=this.$area.find('[data-quiz-part="progress"]')),this.rootModal=this.core.is==="modal"?this.core:!1,this.hasWelcome=!!this.rootModal||this.$welcomeScreen.length>0,this.autoNextEnabled=+this.$steps.attr("data-autonext")||0,this.currentId=null,this.currentIndex=-1,this.total=parseInt(this.$component.attr("data-total-steps"),10)}initQuiz(){if(this.inited)return;this.inited=!0,this.$form.attr("action",`/mod/project/${flexbe_cli.group_id}/lead/send/`),this.resetForm(),this.bindEvents(),this.initFields(),this.initControls(),this.initCaptcha();let t=flexbe_cli.is_admin&&this.$area.data("initialQuizStepId"),e=flexbe_cli.is_admin&&this.$area.data("initialQuizStepIndex");t?this.toStep({id:t,index:e,animated:!1}):this.hasWelcome||this.startQuiz({animated:!1})}onHideShowUI(){this.resetForm()}bindEvents(){flexbe_cli.events.off(this.eventId),this.$form.off(this.eventId),this.$scroller.off(this.eventId),flexbe_cli.events.on(`quiz_command${this.eventId}`,t=>{this.id===t.id&&(t.command==="welcome"?this.toWelcome():t.command==="start"?this.startQuiz():t.command==="step"&&this.toStep({id:t.stepId,index:t.stepIndex,force:t.force,animated:t.animated,scrl:t.scroll}))}),this.$form.on(`change${this.eventId}`,".policy-data-warning__input",t=>{this.$form.find(".policy-data-warning__input").prop("checked",t.target.checked)}),this.$form.on(`input${this.eventId} change${this.eventId}`,"input, textarea",t=>{let e=t.currentTarget,i=e.value,s=$(e);s.attr("value",i),s.closest(".is_error").removeClass("is_error")}),this.$form.on(`keydown${this.eventId}`,"input, textarea",t=>{let e=t.currentTarget,i=e.getAttribute("data-check"),s=t.key||"",n=t.ctrlKey||t.metaKey;if(i==="phone"&&!e._mask&&!n&&s.length===1&&/[^\d ()+-]/.test(s)||i==="email"&&/[\s,]/.test(s))return!1}),this.needInitCalendar&&this.core.is==="modal"&&setTimeout(()=>{this.$calendars.toArray().forEach(t=>{let e=$(t).data("calendar");this.$scroller.on(`scroll${this.eventId}`,()=>{e.main.toPosition()})})},150),this.$form.on(`submit${this.eventId}`,t=>(t.preventDefault(),t.stopPropagation(),this.onSubmit()))}initControls(){$("body").off(`keydown${this.eventId}`).on(`keydown${this.eventId}`,t=>{let e=t.key==="Tab",i=t.key==="Enter";if(!i&&!e)return;let s=this.inFocus,n=t.metaKey||t.ctrlKey,a=t.shiftKey;if(!(!s||t.target.tagName==="TEXTAREA"&&i&&!n)){if(a&&e)this.toPrevStep();else if(!a&&!n){let l=this.$currentStep.find(":focus").closest(".field").next(".field");this.focusField(l)||this.toNextStep()}return t.preventDefault(),t.stopPropagation(),t.stopImmediatePropagation(),!1}}),this.$component.off("click.control").on("click.control","[data-quiz-action]",t=>{let e=t.currentTarget.getAttribute("data-quiz-action");e==="welcome"?this.toWelcome():e==="prev"?this.toPrevStep():e==="next"&&this.toNextStep(),t.preventDefault()})}setProgress(){let t=this.$progress.find(".progress-loader-bar .current"),e=this.total,i=t.data("unit"),s=this.realIndex+1;flexbe_cli.is_admin&&this.realIndex===-1&&this.currentId!=="welcome"&&(s=(+this.$currentStep.prevAll('[data-linked="linked"]').first().attr("data-real-index")+1||0)+1);let n=parseInt(s*100/e,10)||0;if(s=Math.max(0,Math.min(e,s)),n=Math.max(0,Math.min(100,n)),t.length&&i){let a=`${n}%`;i==="step"?a=`${s} / ${e}`:i==="none"&&(a=""),t.attr("data-value",a)}this.$progress.attr("data-current-progress",n),this.$progress.attr("data-current",s),this.$progress.attr("data-total",e),this.$progress.find(".progress-text .current").text(s),this.$progress.find(".progress-text .total").text(e),this.$progress.find(".progress-percent .current").text(n),this.$progress.find(".progress-loader-bar .current").css("width",`${n}%`),this.$progress.find(".progress-loader-circle .current").attr("stroke-dashoffset",`${Math.abs(100-n)}`)}setActionButtons(){let t=this.hasWelcome||this.history.length>1||!!(flexbe_cli.is_admin&&this.realIndex!==0&&this.currentIndex>0);flexbe_cli.is_admin&&this.rootModal&&(!this.realIndex||!this.currentIndex)&&(t=!1),this.$actions.toggleClass("show-prev",t)}toWelcome({scrl:t=!0}={}){if(!this.hasWelcome)return this.startQuiz({scrl:t}),!0;if(this.started=!1,this.currentIndex=-1,this.realIndex=-1,this.currentId="welcome",this.$area.data("initialQuizStepId",this.currentId),this.$area.data("initialQuizStepIndex",this.currentIndex),this.$outerWrapper.attr("data-active-step",this.currentId),this.$outerWrapper.attr("data-active-index",this.currentIndex),this.$outerWrapper.toggleClass("quiz-state-welcome",!0),this.$outerWrapper.toggleClass("quiz-state-started",!1),this.rootModal)flexbe_cli.run.is_preview&&flexbe_cli.events.trigger("ui_modal_close",{id:this.rootModal.id});else if(this.$outerWrapper.length){let e=this.$welcomeScreen.outerHeight()||0;this.$outerWrapper.css("minHeight",e)}return this.setProgress(),this.setActionButtons(),t&&this.core.is==="block"&&flexbe_cli.run.is_preview&&flexbe_cli.scroll.toElement(this.$area),flexbe_cli.events.trigger("quiz_event",{event:"welcome",sender:"core",quiz:this}),!0}startQuiz({animated:t,scrl:e}={}){this.sessionId=parseInt(Date.now()/1e3,10);let i=this.$stepsWrapper.find('.step[data-type="root"][data-linked="linked"]').first();i.length&&this.toStep({$step:i,force:!0,animated:t,scrl:e})}autoNextStep(){!this.autoNextEnabled||this.$currentStep.find(".quiz-fields").data("count")>1||setTimeout(()=>{this.toNextStep()},150)}toPrevStep(){let t=this.history[this.history.length-2];if(!t){let e=this.$currentStep.prevAll('.step[data-type="root"][data-linked="linked"]').first();return e.length?this.toStep({$step:e}):this.hasWelcome&&this.toWelcome(),!1}return this.toStep(t),!0}gatherStepAnswers(t=this.$currentStep){let e=t.find("[data-field-id]").toArray().map(s=>{let n=$(s),a=n.attr("data-field-id"),o=n.find("input, textarea").not('[type="hidden"]'),l=n.find("[data-goto]"),r=n.attr("data-type"),c=n.find(`[name="vars[${a}]"]`).val(),d=o.attr("type"),h=l,p=o.val();["checkbox","radio","image"].includes(r)?h=l.filter(":checked"):r==="select"?(h=h.filter((g,b)=>b.selected),d="select"):r==="file"&&(p=n.find("input.value").map((g,b)=>b.value).toArray());let u=h.toArray(),f=u.map(g=>g.getAttribute("data-goto")).filter(g=>g),m=u.map(g=>({id:g.getAttribute("data-id"),value:g.value})).filter(g=>g.id);return{id:a,title:c,type:r,inputType:d,value:p,variants:m,goto:f}}),i=e.map(s=>{let n={id:s.id,title:s.title,type:s.type};return["radio","checkbox","select","image"].includes(s.inputType)?n.variants=s.variants:n.value=s.value,n});return{fields:e,answers:i}}toNextStep(){if(!this.validateStep(this.$currentStep))return!1;let t=this.$currentStep,{fields:e,answers:i}=this.gatherStepAnswers(t),s=e.flatMap(o=>o.goto)[0]||t.attr("data-goto")||_t,n=this.getNextStep(s,t),a=this.history.find(o=>o.id===this.currentId);a&&(a.fields=e,a.answers=i,a.toId=n,a.goal=this.$currentStep.attr("data-goal"),a.htmlGoal=this.$currentStep.attr("data-html-goal")),this.toStep({id:n})}getNextStep(t,e=this.$currentStep){if(t===N){let s=this.history.map(a=>a.$step[0]),n=this.$stepsWrapper.find('[data-type="root"][data-linked="linked"][data-required]').filter((a,o)=>!s.includes(o));return n.length?n.eq(0).attr("data-id"):N}let i=t;return(t===_t||!this.getStepNodeById(i).length)&&(i=e.nextAll('.step[data-type="root"][data-linked="linked"]').first().attr("data-id")),t===_t&&!i?this.getNextStep(N,e):i}getStepNodeById(t){return this.$stepsWrapper.find(`.step[data-id="${t}"]`)}getStepNodeByIndex(t){return this.$stepsWrapper.find(`.step[data-index="${t}"]`)}toStep({id:t,index:e,$step:i,force:s,scrl:n=!0,animated:a=!0}){if(this.inStepAnimation)return!1;let o=this.history.find(m=>m.id===this.currentId);if(t===N){this.toResult();return}if((!i||!i.length)&&t!=null&&(i=this.getStepNodeById(t)),(!i||!i.length)&&e!=null&&(i=this.getStepNodeByIndex(e)),!i||!i.length)return!1;if(t=t??i.attr("data-id"),e=parseInt(e??i.attr("data-index"),10),t===this.currentId)return this.enableStep(i),!1;let l=flexbe_cli.is_admin?parseInt(i.attr("data-real-index"),10):e,r=e>this.currentIndex;a||this.$area.addClass("noanimate"),i.find(".is_error").removeClass("is_error");let c=i.outerHeight(),d={$step:i,id:t,title:i.find(".step-title").text().trim(),index:e,realIndex:l,fields:[],answers:[]},h=[];s?(h=this.history,this.history=[]):(h=this.history.filter(m=>m.index>=d.index),this.history=this.history.filter(m=>!h.includes(m))),h.forEach(m=>{this.disableStep(m.$step)}),this.enableStep(i),this.started=!0,this.history.push(d),this.$component.addClass("quiz-started"),a&&this.$component.addClass("step-change-animation");let p=flexbe_cli.helpers.scrollParent(this.$component[0])||document.scrollingElement,u=p.scrollTop||0,f=this.$stepsWrapper.outerHeight();if(this.$area.data("initialQuizStepId",t),this.$area.data("initialQuizStepIndex",e),this.$outerWrapper.attr("data-active-step",t),this.$outerWrapper.attr("data-active-index",e),this.$outerWrapper.toggleClass("quiz-state-welcome",!1),this.$outerWrapper.toggleClass("quiz-state-started",!0),i.toggleClass("higher",c>f),a&&this.$stepsWrapper.css("height",`${f}px`),flexbe_cli.theme_id===4&&this.$outerWrapper.css("minHeight",`${f}px`),i.prevAll().removeClass("active next").addClass("prev"),i.nextAll().removeClass("active prev").addClass("next"),i.removeClass("next prev").addClass("active"),this.currentId=t,this.currentIndex=e,this.realIndex=l,this.$currentStep=i,this.core.updateTween(),this.setProgress(),this.setActionButtons(),this.initImages(),flexbe_cli.theme_id===2){let m=this.$area.find(".b_head");m.length&&flexbe_cli.header.fixHeaderHeight(this.$area,m)}return this.timeouts=this.timeouts.filter(m=>clearTimeout(m)),this.timeouts.push(setTimeout(()=>{a||this.$area.removeClass("noanimate")},20)),a?(this.inStepAnimation=!0,this.timeouts.push(setTimeout(()=>{this.$stepsWrapper.css("height",""),this.$component.removeClass("step-change-animation"),i.find(".range-outer").trigger("resize"),this.inStepAnimation=!1},250)),n&&(this.timeouts.push(setTimeout(()=>{let m=this.$area.get(0).getBoundingClientRect();this.$stepsWrapper.css("height",`${c}px`);let g=p.scrollTop,y=this.$area.get(0).getBoundingClientRect().bottom-m.bottom-(u-g);y&&p.scrollTo(0,g+y)},150)),flexbe_cli.run.is_preview&&this.timeouts.push(setTimeout(()=>{let m=this.$component;this.$area.outerHeight()<=flexbe_cli.resize.viewportHeight&&(m=this.$area),flexbe_cli.scroll.toElement(m,{centered:!0,force:!1,complete:()=>{flexbe_cli.run.is_mobile||this.focusField(i)}})},450)))):i.find(".range-outer").trigger("resize"),flexbe_cli.events.trigger("quiz_event",{event:"step",sender:"core",quiz:this,payload:{fromId:o?.id,fromTitle:o?.title,fromAnswers:o?.answers,toNext:r,toId:t,sessionId:this.sessionId},answerGoals:{goal:o?.goal,htmlGoal:o?.htmlGoal}}),!0}toResult({force:t}={}){let e=t||this.validateStep();return!t&&(this.busy||!e)?!1:(this.$form.get(0).dispatchEvent(new Event("submit",{cancelable:!0})),!0)}validateStep(t=this.$currentStep){let e=!0;if(!t||!t.length)return!0;let i=t.find(".policy-data-warning--checkbox"),s=i.find("input")[0];return s&&!s.checked&&(e=!1,i.addClass("is_error animate")),t.find(".field[data-type]").each((n,a)=>{let o=$(a),l=o.attr("data-type");o.removeClass("is_error");let r;if(l==="captcha"){if(!this.captcha)return;r=this.captcha.getToken()?!1:flexbe_cli.locale.tr("form::captcha_not_checked")}else r=this.checkField(o);r&&(o.outerWidth(),o.addClass("is_error animate"),setTimeout(()=>{o.removeClass("animate")},500),l==="file"?o.find(".error-text").text(r):o.find(".error").text(r),e&&this.focusField(o,500),e=!1)}),e}validateHistorySteps(){let t=this.history.every(n=>this.validateStep(n.$step));if(!this.history.length||!t)return!1;let e=this.history.at(-1),i=e.fields.flatMap(n=>n.goto)[0]||e.$step.attr("data-goto")||N;return this.getNextStep(i,e.$step)===N}getResult(){let t=this.$form.find("input[name=results]").data("value")||[],e=t.filter(i=>i.id!=="default").find(i=>this.checkResultCondition(i));return e||(e=t.find(i=>i.id==="default")||t[0]),typeof e.action!="object"&&(e.action={pay:e.pay,name:e.action,modal_id:e.modal_id,action_redirect:e.action_redirect}),e}checkResultCondition(t){let e=t.conditions||{},i=e.union,s=e.list||[],a=this.history.reduce((r,c)=>r.concat(c.fields),[]),o=s.map(r=>{let c=a.find(d=>String(d.id)===String(r.field));return{condition:r,field:c}});if(!o.length)return!1;return o=o[i==="and"?"every":"some"](({condition:r,field:c})=>{let d=!0;if(!c)return!1;if(r.type==="vars"){let h=c.variants||[],p=(r.variants||[]).map(u=>`${u}`);if(!h.length)return!!r.emptyVariant;if(r.unionExtra||(d=h.every(u=>p.includes(`${u.id}`))),d){let u=r.union;(c.inputType==="radio"||c.inputType==="select")&&(u="or"),d=p[u==="and"?"every":"some"](f=>h.find(m=>m.id===f))}}else if(r.type==="range"){let h=`${c.value}`.replace(/\s+/g,"").split(/\s[-]\s/).map(b=>+b).filter(b=>typeof b=="number"&&!Number.isNaN(b)),p=Math.min.apply(null,h),u=Math.max.apply(null,h),f=p!==u,m=+r.rangeLimitFrom,g=+r.rangeLimitTo;if(r.operator==="equal")return f?p<=m&&m<=u:m===p;l(m)&&l(g)&&(m=Math.min(r.rangeLimitFrom,r.rangeLimitTo),g=Math.max(r.rangeLimitTo,r.rangeLimitFrom)),d&&l(m)&&(d=m<=p),d&&l(g)&&(d=u<=g)}else if(r.type==="text"){let h=r.fill,p=(c.value||"").trim().replace(/ +/g," ").replace(/\+/g,"\u2214"),u=r.answers.map(f=>`${f}`.toLowerCase().replace(/\+/g,"\u2214")).filter(f=>f);if(h==="fill")return!!p;if(h==="empty")return!p;if(h==="include")return u.some(f=>new RegExp(`^${f}|\\s${f}`,"i").test(p));if(h==="exclude")return u.every(f=>!new RegExp(`^${f}|\\s${f}`,"i").test(p))}else if(r.type==="file"){let h=r.fill,p=c.value;if(h==="fill")return!!p.length;if(h==="empty")return!p.length}return d}),o;function l(r){return!Number.isNaN(+r)&&r!=null&&r!==""}}checkField(t){let e=t.find("input, textarea, select").not('[type="hidden"]'),i=e[0],s=t[0];if(!i)return;let n=s.getAttribute("data-type"),a=i.required||t.is('[data-required="true"]'),o=i.getAttribute("data-check")||!1,l=i._mask&&i.getAttribute("data-mask")||!1,r;["checkbox","radio","image"].includes(n)?r=!!e.closest(":checked").length:n==="file"?r=t.find("input.value"):r=i.value;let c=a&&!r?"form::required":!1;if(l)!a&&!r||i.getAttribute("data-mask-complete")||(n==="phone"&&r?c="form::phone":n==="text"&&r?c="form::text":c="form::required");else if(o){if(r.length&&n==="email")/^(([^\s"(),.:;<>@[\\\]]+(\.[^\s"(),.:;<>@[\\\]]+)*)|(".+"))@((\[(?:\d{1,3}\.){3}\d{1,3}])|(([\w--]+\.)+[A-Za-z-]{2,}))$/.test(r)||(c="form::email");else if(r.length&&n==="phone")/[^\d\s()+-]/.test(r)?c="form::digits":r.replace(/\D/g,"").length<5&&(c="form::phone_minlength");else if(n==="file")a&&!r.length?c="form::required":t.hasClass("loading")?c="form::loading":c=!1;else if(n==="date"||n==="datetime"){let d=$(i).data("calendar"),h=d&&d.input.checkError();h&&(c=h)}}return c=c&&flexbe_cli.locale.tr(c)||!1,c}disableStep(t){t.find("input, textarea, select").prop("disabled",!0)}enableStep(t){t.find("input, textarea, select").prop("disabled",!1)}focusField(t,e=200){if(!t||!t.length||flexbe_cli.run.is_ios)return!1;let i=t.find(Ae).not(Ie).first();return i.length?(e?setTimeout(()=>i.focus(),e):i.focus(),!0):!1}initImages(){setTimeout(()=>{let t=$(this.component).find(".step.active");$(t).find(".component-image").length&&T(t,"image","setImage")},100)}initFields(){this.initFieldImage(),this.initFieldCheckbox(),this.initFieldRadio(),this.initFieldSelect(),this.initFieldTextarea(),this.initFieldFile(),this.initFieldRange(),this.isLoaded&&(this.needInitMasks&&this.initFieldMask(),this.needInitCalendar&&this.initFieldDate())}initFieldImage(){this.$component.off("click.fieldImages").on("click.fieldImages",".form-field-image-item",t=>{let e=t.currentTarget.querySelector("input"),i=!e.checked;e.checked=i,i&&e.type==="radio"&&this.autoNextStep()})}initFieldFile(){let t=this.$component,e=this.eventId,i=this.$itemTemplateFile?.html();nt(t,e,i)}initFieldCheckbox(){}initFieldRadio(){this.autoNextEnabled&&this.$component.off("change.initRadio").on("change.initRadio",".form-field-radio-item",()=>{this.autoNextStep()})}initFieldSelect(){this.$component.find(".dropdown-container").remove();let t=this.$component.find("select.atom-custom-select"),e={position:"under",dropdownClass:this.$component.hasClass("style-underlined")?"sharp size--large":"size--large"};t.each((i,s)=>{let n=$(s).closest('[data-type="select"]'),a=()=>{n.removeClass("active")},o=()=>{n.addClass("active"),n.siblings('[data-type="select"]').removeClass("active")};tt.create({element:s,config:e,onChange:this.autoNextStep.bind(this),onSelect:this.autoNextStep.bind(this),onCollapse:a,onActivate:o})})}initFieldTextarea(){this.$component.find("textarea.autosize").each((t,e)=>{let i=e.offsetHeight-e.clientHeight,s=$(e);s.removeAttr("data-autoresize"),s.off("keyup input").on("keyup input",n);function n(a){a.currentTarget.style.height="auto",a.currentTarget.style.height=`${a.currentTarget.scrollHeight+i}px`}})}initFieldRange(){this.$component.find(".form-field-range").each((t,e)=>new it($(e)))}addSubmitting(){this.busy=+Date.now(),this.$component.addClass("submitting"),this.$form.addClass("submitting")}clearSubmitting(t=!1){this.busy&&(this.$component.removeClass("submitting"),this.$form.removeClass("submitting"),t?(this.$component.addClass("success"),this.$component.find(".file-list").empty(),this.$component.find("input.value").remove(),setTimeout(()=>{this.busy=!1,this.$component.removeClass("success")},1e3)):this.busy=!1)}onSubmit(){if(!this.validateHistorySteps())return;this.result=this.getResult();let t={id:this.core.id,name:this.result.name,action:this.result.action.name,pageId:flexbe_cli.p_id,utmData:JSON.stringify(flexbe_cli.utm.data),jsform:parseInt(448312,10)};if(flexbe_cli.stat.u_id&&(t.userId=flexbe_cli.stat.u_id),"roistat"in window&&(t.roistatVisit=window.roistat.visit),this.result.action.name==="pay"&&this.result.action.pay){let e=this.result.action.pay;if(e.desc&&(t["pay[desc]"]=e.desc),e.price&&(t["pay[price]"]=e.price,e.title))if(e.productId){let i=flexbe_cli.ecommerce.productsStore.getProduct(e.productId);if(i){let n=i.currentVariant(e.variantId).getCartData("image");n.img=q(n.img[0]),t.products=JSON.stringify([{...n,count:1,id:`product_${e.productId}:${e.variantId||"default"}`}])}}else t.products=JSON.stringify([{title:e.title,id:`${flexbe_cli.p_id}_${flexbe_cli.s_id}`,img:e.img&&q(e.img),count:1,price:e.price}])}return Object.entries(t).forEach(([e,i])=>{i!=null&&this.addFields([{name:e,value:i,type:"hidden"}],!1)}),this.sendForm(),!1}async sendForm(){let t=this.captcha&&this.captcha.getToken();if(this.captcha&&this.captcha.enabled&&!this.captcha.isOptional&&!t){this.captcha.isVisible?this.toStep({id:"captcha"}):this.captchaInvisibleRun();return}this.addSubmitting();let e=new FormData(this.$form.get(0));e.delete("fileOriginal"),e.delete("g-recaptcha-response"),t&&e.append("captcha-token",t);let i=flexbe_cli.stat.AB.getCookie();if(e.append("abTest",JSON.stringify(i)),flexbe_cli.run.is_OSX&&typeof e.entries=="function")for(let s of e.entries()){let[n,a]=s;typeof a=="object"&&a instanceof File&&a.size===0&&typeof e.delete=="function"&&e.delete(n)}try{let s=await flexbe_cli.helpers.fetch(this.$form.attr("action"),{type:"POST",dataType:"json",contentType:"application/json",data:JSON.stringify(rt(e))});typeof s.pay<"u"&&(this.pay=s.pay),this.showDone(e,s),this.captchaRemoveError()}catch(s){let n=s.data||{};if(n.captcha){this.captcha||await this.initCaptcha({...L.getRecaptchaSettings(),enabled:!0,visible:n.captcha==="visible",ttl:1}),t?this.captchaAddError():this.captcha.isVisible?(this.captcha.isOptional=!1,this.total=parseInt(this.$component.attr("data-total-steps"),10)+1,this.clearSubmitting(!1),this.toStep({id:"captcha"})):this.captcha.isInvisible&&this.captchaInvisibleRun();return}this.clearSubmitting(!1),console.error("sendForm error: ",s),console.error("Form submitting error!")}}showDone(t,e={}){let i=this.result.action.name,s=this.history.at(-1),n=lt(t,{leadId:e.lead_id,pays:e.pay}),a=()=>{setTimeout(()=>{this.resetForm(),this.toWelcome({scrl:!1})},500)};if(s){let l=s.answers,r=s.id,c=s.title,d=this.result.goals||{};flexbe_cli.events.trigger("quiz_event",{event:"submit",sender:"core",quiz:this,payload:{fromAnswers:l,fromId:r,fromTitle:c,sessionId:this.sessionId},answerGoals:{goal:s.goal,htmlGoal:s.htmlGoal},resultGoals:{mainGoal:flexbe_cli.stat.getGoal("order_done"),goal:d.goal,htmlGoal:d.goal_html},resultGoalsData:{leadId:e.lead_id,formData:n}})}if(typeof this.afterSent=="function"&&this.afterSent(),i==="pay"&&typeof this.pay<"u"&&this.pay!==null&&this.pay.pay_link.length>0){let l=`${window.location.origin+window.location.pathname+(window.location.search?`${window.location.search}&`:"?")}pay_id=${this.pay.pay_id}&h=${this.pay.pay_hash}`;try{window.history.pushState(null,null,l),setTimeout(()=>{flexbe_cli.events.trigger("pay",{action:"init"})},200)}catch{setTimeout(()=>{document.location=l},500)}}else if(["redirect","anchor"].includes(i)){let l=this.result.action.action_redirect,r=this.result.action.action_link;l?(flexbe_cli.helpers.gotoLink(l),setTimeout(()=>{a()},1e3)):r&&flexbe_cli.helpers.gotoLink(r)}else if(i==="code"){if(!flexbe_cli.run.is_preview)return;(async r=>{let c=this.result.action.action_code,d=Object.getPrototypeOf(async()=>{}).constructor;await new d("formData",c)(r)})(n).catch(r=>{console.error("Error executing action code:",r)})}else{let l=this.result.action.modal_id;flexbe_cli.events.trigger("ui_modal_open",{id:l})}let o=new Event("submitted",{bubbles:!0});this.$form.get(0).dispatchEvent(o),this.clearSubmitting(!0),a()}resetForm(){this.$form.find(".form-field-file, .file-input-outer").removeClass("active");let t=this.$stepsWrapper.find("input, textarea, select"),e=t.not("select").not('[type="hidden"]').not(".form-field-range__input"),i=t.filter("select"),s=t.filter(".form-field-range__input");t.prop("disabled",!0),i.each((n,a)=>{let o=a.querySelector("option"),l=o&&o.value||"";a.value!==l&&(a.value=l,a.dispatchEvent(new Event("change")))}),s.each((n,a)=>{a.value=a.getAttribute("data-value"),a.dispatchEvent(new Event("change"))}),e.each((n,a)=>{let l=a.defaultChecked;["radio","checkbox"].includes(a.type)?a.checked=l:(a.removeAttribute("value"),a.value="",a.removeAttribute("data-mask-complete"),a._mask&&a._mask.updateValue()),a.dispatchEvent(new Event("change"))}),this.captcha&&this.captcha.enabled&&(this.captcha.reset(),this.captchaRemoveError()),at(),this.$form[0].reset()}async initCaptcha(t){return t==null&&(t=L.getRecaptchaSettings()),new Promise((e,i)=>{!this.captcha&&t.enabled&&(this.captcha=new L({id:this.id,$form:this.$component,onSuccess:()=>{this.captchaRemoveError(),this.toResult({force:!0})},onError:()=>{this.captchaAddError()}},t),flexbe_cli.require(`https://www.google.com/recaptcha/api.js?render=explicit&hl=${flexbe_cli.vars.site.language}`,()=>{let s=150,n=setInterval(()=>{s-=1,this.captcha.loaded?(this.captcha.init(),clearInterval(n),e()):s===0&&i(new Error("Can not load grecaptcha"))},10)}))})}captchaAddError(t){if(!this.captcha||!this.captcha.enabled)return;t==null&&(t=flexbe_cli.locale.tr("form::captcha_error"));let e=this.$component.find(".captcha-global-error");e.find(".error-text").text(t),e.addClass("show"),this.busy&&this.clearSubmitting()}captchaRemoveError(){if(!this.captcha||!this.captcha.enabled)return;let t=this.$component.find('.field[data-type="captcha"]'),e=this.$component.find(".captcha-global-error");t.removeClass("is_error"),e.removeClass("show")}captchaInvisibleRun(){if(!this.captcha||!this.captcha.enabled||!this.captcha.loaded||this.captcha.isVisible)return;this.addSubmitting(),this.captcha.runInvisibleChallenge();let t=this.busy;setTimeout(()=>{t===this.busy&&this.clearSubmitting()},2500)}setData(t){if(!t)return!1;t&&t.fields&&this.addFields(t.fields),t&&t.items&&this.addItems(t.items)}addFields(t,e=!0){let i=this.$component.find(".form-fields-advanced");!t.length||!i[0]||(e&&this.resetFields(),t.forEach(s=>{i.find(`input[name="${s.name}"]`).remove();let n=$("<input>").attr("type",s.type).attr("name",s.name).attr("value",s.value);i.append(n)}))}resetFields(){let t=this.$component.find(".form-fields-advanced");t[0]&&t.empty()}addItems(t=[]){if(!t||!t.length)return;let e=0,i="",s=[];t=t.map(a=>typeof a!="object"?{}:(a.price=parseFloat(a.price)||0,a.title=typeof a.title=="string"&&a.title.trim()||a.title||"",e+=a.price*a.count||0,a));try{i=JSON.stringify(t)}catch{}let n={products:i};e&&(n={...n,"pay[price]":e,"pay[desc]":""}),Object.entries(n).forEach(([a,o])=>{s.push({type:"hidden",name:a,value:o})}),this.addFields(s)}initFieldMask(){return typeof IMask>"u"?!1:(this.needInitMasks=!1,this.$masked.each((t,e)=>{ot(e);let i=!!e.getAttribute("data-placeholder"),s=e._mask;i&&s&&($(e).on(`focus${this.eventId}`,()=>{s.updateOptions({lazy:!1})}),$(e).on(`blur${this.eventId}`,()=>{if(!s.unmaskedValue){let n=s.mask.replace(/\*/g,"_"),a=s.value;s.updateOptions({lazy:!0}),(!s.masked.rawInputValue||n===a)&&(s.unmaskedValue="",s.value="",s.updateValue())}}))}),!0)}initFieldDate(){this.needInitCalendar=!1;let t=this.$component.closest(".scroller")[0];return this.$calendars.each((e,i)=>{st(i,t)}),!0}},ct=class extends Fe{setProgress(){let t=this.$progress.find(".progress-loader-bar .current"),e=this.$progress.attr("data-text-style")==="step",i=t.attr("data-unit"),s=this.total,n=this.realIndex;flexbe_cli.is_admin&&this.realIndex===-1&&this.currentId!=="welcome"&&(n=+this.$currentStep.prevAll('[data-linked="linked"]').first().attr("data-real-index")+1||0),n=Math.max(0,Math.min(s-1,n));let a=e?n+1:n,o=parseInt(a*100/s,10);if(this.$progress.attr("data-current",a),this.$progress.attr("data-total",s),this.$progress.attr("data-current-progress",o>0?o:0),t&&i){let l=t.find(".progress-runner"),r=`${o}%`;i==="step"?r=`${a} / ${s}`:i==="none"&&(r=""),l.attr("data-value",r)}this.$progress.find(".progress-text .current").text(a),this.$progress.find(".progress-text .total").text(s),this.$progress.find(".progress-percent .current").text(o),this.$progress.find(".progress-loader-bar .current").css("width",`${o}%`),this.$progress.find(".progress-loader-circle .current").attr("stroke-dashoffset",`${Math.abs(100-o)}`)}};flexbe_cli.entity.setClientJs("modal","QUIZ",{components:[ct,M,S]});flexbe_cli.entity.setClientJs("widget","ANCHORS",{$list:null,loadAnime(){return new Promise((t,e)=>{typeof anime=="function"&&t(!0),document.readyState==="complete"?flexbe_cli.require("/_s/lib/anime/anime.min.js?321").then(t).catch(e):window.addEventListener("load",()=>{flexbe_cli.require("/_s/lib/anime/anime.min.js?321").then(t).catch(e)})})},async onLoad(){this.$list=this.$widget.find(".anchors-list"),this.list=typeof this.$list.data("anchors")=="object"&&this.$list.data("anchors").list||[];let t=this.list.reduce((i,s)=>i+s.enabled,0)<2,e={style:1,show_title:0,...this.$list.data("anchors")};if((flexbe_cli.run.is_mobile||t)&&!flexbe_cli.is_admin){this.$list.toggleClass("is-empty",t);return}this.style=e.style,this.show_title=e.show_title,this.$list.removeAttr("data-anchors"),await this.loadAnime(),this.drawList(),flexbe_cli.is_admin&&flexbe_cli.events.off("layout_change.anchors").on("layout_change.anchors",i=>{i?.action==="layout_render"&&this.drawList()})},check(){let t=flexbe_cli.block.$blocks.not("[data-overlayed]");this.list=this.list.map(e=>{let i=t.closest(`[data-id="${e.id}"]`),s=i.attr("data-hidden")||"none";return!e.enabled||!i[0]||["desktop","all"].includes(s)?null:{id:e.id,title:e.title,enabled:e.enabled,anchor:i.find("._anchor").attr("name")}}).filter(Boolean)},drawList(){flexbe_cli.block.$blocks.length||this.$list.hide(),this.check();let t="";flexbe_cli.is_admin&&this.list.length<2?t=`<svg style="color: #adadad" width="18" height="98" viewBox="0 0 18 98" xmlns="http://www.w3.org/2000/svg">
                <g fill="none" fill-rule="evenodd">
                    <circle opacity=".05" cx="9" cy="5" r="5"/>
                    <circle opacity=".2" cx="9" cy="25" r="5"/>
                    <circle opacity=".2" cx="9" cy="73" r="5"/>
                    <circle opacity=".05" cx="9" cy="93" r="5"/>
                    <path d="M9 40a9 9 0 1 0 0 18 9 9 0 0 0 0-18zm5.126 9.626h-4.5v4.5H8.34v-4.5h-4.5V48.34h4.5v-4.5h1.286v4.5h4.5v1.286z" opacity=".45"/>
                </g>
            </svg>`:this.list.length>=2&&(this.list.forEach(e=>{let i=this.show_title&&e.title?` data-title="${e.title}"`:"";t+=`<li${i}><a href="#${e.anchor||e.id}"></a></li>`}),t+='<li class="helper"><a></a></li>'),this.$list.find("ul").html(t),this.$helper=this.$list.find(".helper"),this.animateList(),this.bindEvents()},animateList(){if(!(this.list.length<1)){if(flexbe_cli.is_admin)this.$helper.css({opacity:1,transform:`translateY(${24*this.index}px)`});else{let t=anime({targets:this.$list.find("li").not(this.$helper).get(),duration:300,opacity:[0,1],scale:[.8,1],translateY:[10,0],easing:"easeInOutQuad",autoplay:!1,delay:(e,i)=>i*30,complete:()=>{anime({targets:this.$helper.get(),duration:400,translateY:24*this.index,scale:[2.5,1],opacity:[0,1],easing:"easeInExpo"})}});this.$list.addClass("hide"),setTimeout(()=>{this.$list.removeClass("hide"),t.play()},800)}this.$list.find("li").removeClass("active").eq(this.index).addClass("active")}},index:0,bindEvents(){this.$list.find("li").length<=1||(flexbe_cli.block.$blocks.each((t,e)=>{let i=e._core;i?.inFocus&&this.setBlock(i)}),flexbe_cli.block.$blocks.off("focused.anchors").on("focused.anchors",t=>{let e=t.currentTarget._core;e?.inFocus&&this.setBlock(e)}),this.$list.off("click.anchors").on("click.anchors","li",t=>$(t.target).is("a")?!0:($(t.currentTarget).find("[href]").trigger("click"),t.preventDefault(),!1)))},setBlock(t){let e=this.index,i="#6a6a6a",s=t.content||t.$area.find(".container")[0];if(s){let n=s.closest("[data-contrast]").getAttribute("data-contrast");n?i=n==="light"?"#FFF":"#1B1B1C":i=getComputedStyle(s).color}this.$list.css("color",i),this.list.some((n,a)=>n.id===t.id?(e=a,!0):!1),e=Math.max(0,Math.min(this.list.length-1,e)),e!==this.index&&(this.animate(e),this.index=e)},animate(t){if(this.$list.find("li").removeClass("active"),this.$list.find("li").eq(t).addClass("active"),+this.style==1){let e=24*t,i=t-this.index>0?12:-12;anime.remove(this.$helper[0]),anime({targets:this.$helper[0],translateY:e-i,scaleY:2.5,scaleX:.6,duration:80,easing:"easeInQuad",complete:()=>{anime({targets:this.$helper[0],translateY:e,scaleY:1,scaleX:1,duration:80,easing:"easeOutQuad"})}})}}});function ke(t){return/^\s*(?:linear-gradient|repeat-linear-gradient|radial-gradient)\(.*\)/i.test(t)}var z={hidden:"hidden-mobile",navCreated:"mobile-navigation--created",cartContainer:"nav-header-controls--cart",burgerContainer:"nav-header-controls--burger",safeArea:"provide-panel-safe-area"},I={block:".b_block:not(.b_block--global)",element:".element-item",nav:".mobile-navigation",headerHolder:".header-area",header:".layout-type-header",cartBtn:".w_widget .cart-button",headerCartBtn:".cart-element-icon",navbarContent:".nav-header-content",navbarControls:".nav-header-controls",navmenu:".nav-menu",navmenuItem:".nav-menu-item"},H=(t,e=!1)=>{let i=$(t);if(!i.is(I.element)){let s=i.closest(I.element);i=s.length?s:i}i.toggleClass(z.hidden,!e)};flexbe_cli.entity.setClientJs("widget","MENU01",{created:{},navbarStyle:void 0,overlayingHeader:void 0,isFixed:!1,clickEvent:"click",navmenuCreated:0,contrast:"light",background:"#000000",opacity:1,contrastFixed:"light",backgroundFixed:"#000000",opacityFixed:1,headersMap:[],$headers:void 0,$nav:void 0,$navmenu:void 0,$cart:void 0,$burger:void 0,isOpen:!1,color:"",onLoad(){requestAnimationFrame(()=>this.createWidget());let t=flexbe_cli.resize.responsiveMode,e;$(window).on("resized",()=>{clearTimeout(e),e=setTimeout(()=>{let i=flexbe_cli.resize.responsiveMode;t!==i&&i==="mobile"&&this.createWidget(),t=i},50)})},onMsg(t){t==="forceRecreate"&&(this.createWidget(),this.toggleMenu(!1))},createWidget(){this.navbarStyle=null,this.navmenuCreated=0,this.isFixed=!1,this.overlayingHeader=null,this.created={},this.contrast="light",this.background="#000000",this.opacity=1,this.contrastFixed="light",this.backgroundFixed="#000000",this.opacityFixed=1;let t=$(I.block),e=t.find(I.header);if(H(t,!0),H(e,!0),$(`.${z.safeArea}`).removeClass(z.safeArea),this.headersMap=t.not((s,n)=>!!n.closest('[data-hidden="mobile"]')).toArray().map((s,n)=>{let a=$(s),o=a.find(I.header),l=o.closest("[data-fixed-ignore-adaptive]").length,r=o.hasClass("fixed-area")&&!l,c=o.closest("[data-overlayed]").length>0,d=!!o.data("mobile-menu"),h=o[0]?o[0].closest("[data-abtest-active]"):null,p=o[0]?o[0].closest("[data-abtest-id]"):null,u=(o.data("widget-color")||"auto").replace(/contrast|false/,"auto"),f=(o.data("widget-contrast")||o.closest("[data-contrast]").attr("data-contrast")||"auto").replace(/contrast|false/,"auto"),m=o.data("widget-opacity")||"100",[g,b]=String(u).split(":"),[y,_]=String(f).split(":"),[v,w]=String(m).split(":");return{enabled:d,index:n,$block:a,$header:o,isFixed:r,isOverlaying:c,isActiveAbtest:h,isAbtest:p,background:g,contrast:y,opacity:+v,backgroundFixed:b??g,contrastFixed:_??y,opacityFixed:+(w??v)}}).filter(s=>s.enabled&&(!s.isAbtest||s.isActiveAbtest)).sort((s,n)=>Number(n.isFixed)-Number(s.isFixed)),this.$headers=$(this.headersMap.map(s=>s.$header[0])),this.$nav=this.$area.find(I.nav),this.$navmenu=this.$area.find(I.navmenu),this.styleMobileMenu(),this.fillNavMenu(),this.fillNavbar(),e.closest(".b_block").each((s,n)=>{n._core&&n._core.updateTween()}),this.navbarStyle){if(this.background&&!ke(this.background)){let s=$('meta[name="theme-color"]');s.length?s.attr("content",this.background):$("head").append(`<meta name="theme-color" content="${this.background}"/>`)}this.isFixed=this.isFixed||this.navbarStyle==="round",this.$nav.toggleClass("menu-fixed",this.isFixed),this.$nav.toggleClass("menu-static",!this.isFixed),this.hideUnnecessaryElements()}this.overlayingHeader?this.overlayingHeader?.$block.find(I.headerHolder).addClass(z.safeArea):this.navbarStyle==="panel"&&flexbe_cli.block.$list.addClass(z.safeArea),this.navmenuCreated&&(flexbe_cli.entity.initArea(this.$nav),flexbe_cli.events.off("ui_mobilemenu_open").on("ui_mobilemenu_open",()=>{this.openMenu()}),flexbe_cli.events.off("ui_mobilemenu_close").on("ui_mobilemenu_close",()=>{this.$nav.length&&[!0,"true"].includes(this.$nav.attr("data-opened"))&&this.closeMenu()}));let i=flexbe_cli.components.getGlobalInstance("lazyLoading");i&&(i.loadInArea(this.$area[0],"inline"),i.loadInArea(this.$area[0],"lazy"))},styleMobileMenu(){let t={dark:"#060607",light:"#FFFFFF"};if(this.headersMap.length){let s=this.headersMap[0];s.isOverlaying&&s.index===0?this.overlayingHeader=this.headersMap[0]:(s.isOverlaying=!1,(s.background==="transparent"||s.opacity===0)&&(s.isFixed?(s.background=s.backgroundFixed,s.opacity=s.opacityFixed,s.contrast=s.contrastFixed):(s.background="auto",s.opacity=100))),this.background=s.background,this.contrast=s.contrast,this.opacity=s.opacity,this.backgroundFixed=s.backgroundFixed,this.contrastFixed=s.contrastFixed,this.opacityFixed=s.opacityFixed,this.contrast==="auto"&&(this.contrast=s.$header.closest("[data-static-contrast]").attr("data-static-contrast")||s.$header.closest("[data-contrast]").attr("data-contrast")),this.contrastFixed==="auto"&&(this.contrastFixed=this.contrast),this.background==="auto"&&(this.background=this.contrast==="dark"?t.light:t.dark),this.backgroundFixed==="auto"&&(this.backgroundFixed=this.contrastFixed==="dark"?t.light:t.dark,this.opacityFixed=100),this.isFixed=!flexbe_cli.is_admin&&this.headersMap[0].isFixed}let e=null,i=()=>{let s=this.isOpen,n=this.isFixed&&(s||flexbe_cli.scroll.latest>1),a=n?this.contrastFixed:this.contrast,o=n?this.backgroundFixed:this.background,l=(n?this.opacityFixed:this.opacity)/100;s&&o==="transparent"&&(o=a==="dark"?t.light:t.dark,l=1);let r=`${o}-${a}-${l}`;e!==r&&(e=r,this.$area.css({"--background":o,"--opacity":l}).attr("data-contrast",a))};i(),$(window).off("scroll.mobilemenu").on("scroll.mobilemenu",()=>i()),flexbe_cli.events.off(".mobilemenu").on("mobilemenu_opened.mobilemenu mobilemenu_closed.mobilemenu",()=>i())},hideUnnecessaryElements(){this.$nav.removeClass("header-style-round header-style-panel"),this.$nav.addClass(`${z.navCreated} header-style-${this.navbarStyle}`),this.headersMap.forEach(t=>{let e=t.$header,i=t.$block,n=e.find(".element-item").toArray().some(a=>a.offsetHeight);H(e,!!n),i.toggleClass("mobile-menu-occupied",!n)})},fillNavbar(){let t=this,{created:e,$area:i,$headers:s,navmenuCreated:n}=this,a=i.find(I.navbarContent),o=i.find(I.navbarControls);a.empty(),o.empty();let l=[],r=[];d(),h(),this.$nav.attr("data-enabled",r.length?"true":"false"),r.length&&c(),l.length&&r.length||r.length>1?this.navbarStyle="panel":l.length===0&&r.length===1?(this.navbarStyle="round",this.isFixed=!0):this.navbarStyle=null;function c(){let p=s.map((m,g)=>g.querySelector(".component-logo")).eq(0),u=p.clone(),f=u.find(".component-logo-img");if(u.length){u.css({position:"absolute",width:"200px",height:"auto",left:"-9999px",top:"-9999px"}),$("body").append(u);let m=f.prop("width"),g=f.prop("height");m instanceof SVGAnimatedLength&&(m=m.baseVal.value),g instanceof SVGAnimatedLength&&(g=g.baseVal.value),m||(m=f.innerWidth()||u.innerWidth()),g||(g=f.innerHeight()||u.innerHeight());let b=Math.max(.25,g/m||0),y=`${Math.round(50/b)}px`;e.logo=!0,u.css({position:"",width:"",height:"",left:"",top:"",maxWidth:y}),a.append(u),a.attr("data-id",p.closest("[data-id]").attr("data-id")),l.push("logo"),H(p,!1)}else e.logo=!1;return e.logo}function d(){let p=$(I.cartBtn).eq(0),u=t.$headers.find(I.headerCartBtn).eq(0);if(u.length||p.length){e.cart=!0,r.push("cart");let f=p.find(".cart-button-icon"),m=p.find(".cart-button-count"),g=u.find(".cart-element-button-icon"),b=u.find(".cart-element-button-count"),y,_,v;g.length?y=g.html():y=f.html(),b.length?(_=b.css("color"),v=b.css("background-color"),v==="rgba(0, 0, 0, 0)"&&(_="rgb(255, 255, 255, 1)",v="rgb(234, 127, 84, 1)")):(_=m.css("color"),v=m.css("background-color"));let w=`
                        <li class="${z.cartContainer}${u.length?"":" cart-optional"}">
                            <div class="cart-button">
                                <svg class="cart-button-icon">
                                    ${y}
                                </svg>
                                <div class="cart-button-count" style="color: ${_}; background: ${v}">0</div>
                            </div>
                        </li>`;t.$cart=$(w),o.append(t.$cart),!u.length&&!t.background&&(t.color=p.css("color"),t.background=p.css("background-color"))}else e.cart=!1;if(e.cart){let f=t.$area.find(".cart-button"),m=f.find(".cart-button-count"),g=flexbe_cli.ecommerce.cartStore.getCount();o.toggleClass("cart-empty",!g),m.text(g),t.$cart.on(t.clickEvent,()=>{t.toggleMenu(!1),flexbe_cli.events.trigger("ui_cart_open")}),setTimeout(()=>{flexbe_cli.ecommerce.cartStore.on("dispatch.mobilemenu",({name:b})=>{let y=flexbe_cli.ecommerce.cartStore.getCount();o.toggleClass("cart-empty",!y),m.text(y),b==="addItem"&&(f.addClass("blink"),setTimeout(()=>{f.removeClass("blink")},300))})})}return e.cart}function h(){return n?(t.$burger=$(`<li class="${z.burgerContainer}"><i></i><i></i><i></i></li>`),o.append(t.$burger),r.push("burger"),t.$burger.on(t.clickEvent,()=>{t.toggleMenu()}),e.burger=!0):e.burger=!1,e.burger}},fillNavMenu(){let{created:t,$navmenu:e,$headers:i}=this,s=["header_menu","header_text","header_contacts","header_social","header_lang_menu","header_button","header_html"];return["header_cart","header_spacer"].forEach(a=>{let o=i.find(`[data-e-id="${a}"]`);H(o,!1)}),s.forEach(a=>{let o=e.find(`[data-element=${a}]`),l=i.find(`[data-e-id="${a}"]`),r=l.length;if(o.empty(),r){let c=l.clone();c.find('[class^="editor-"]').remove(),c.attr("data-cloned","true"),o.append(c),o.find("[data-direction]").attr("data-direction","column").attr("data-direction-adaptive","column").attr("data-rollup-adaptive","true"),o.find(".nowrap-list").removeClass("nowrap-list"),o.find(".element-content").removeClass("justify-content-center justify-content-end").addClass("justify-content-start"),H(l,!1),H(c,!0),t[a]=t[a]?t[a]+r:r}}),this.navmenuCreated=Object.keys(t).length,this.navmenuCreated},toggleMenu(t){typeof t>"u"?(t=[!0,"true"].includes(this.$nav.attr("data-opened")),t=!t):t=!!t,this[t?"openMenu":"closeMenu"]()},openMenu(){this.isOpen=!0,this.$area.addClass("show"),this.$nav.outerHeight(),this.$nav.attr("data-opened","true"),this.$navmenu.addClass("active"),this.$burger&&this.$burger.addClass("active"),flexbe_cli.is_admin||flexbe_cli.scroll.scrollLock.lock(),this.setAreaSize(),this._onOpen(),flexbe_cli.events.trigger("mobilemenu_opened"),$(window).on("resized.mobilemenu",()=>{this.setAreaSize()}),flexbe_cli.resize.responsiveMode==="mobile"&&($("body").addClass("is-widget-open"),this.isFixed||$("body, html").scrollTop(0))},closeMenu(){this.isOpen=!1,Array.from(this.$navmenu.find(".folder-item")).forEach(t=>{$(t).removeClass("show"),$(t.lastElementChild).slideUp(0)}),$("body").removeClass("is-widget-open"),this.$area.removeClass("show"),this.$area.css("height",""),this.$nav.attr("data-opened","false"),this.$navmenu.removeClass("active"),this.$burger&&this.$burger.removeClass("active"),flexbe_cli.is_admin||flexbe_cli.scroll.scrollLock.unlock(),$(window).off("resized.mobilemenu"),this._onClose(),flexbe_cli.events.trigger("mobilemenu_closed")},setAreaSize(){let t=this.isOpen?`${flexbe_cli.resize.viewportHeight}px`:"";this.$area.css("height",t)}});var jt=(t,e)=>!t||typeof t!="string"?t:t.replace(/\{\{\s*([^}|]+)(?:\s*\|\s*([^}]*))?\s*\}\}/g,(i,s,n)=>e(s.trim(),n?.trim()));var G=new Map;function Ee(t,e,i,s=!1){let n=Te(e,s);try{return new Function("ctx",`with (Math) { with (ctx) { ${n} }}`)(i)}catch(a){throw new Error(`[${t}] Function "${n}" (original: "${e}") can't be evaluated`,{cause:a})}}function Te(t,e=!1){if(t.includes("function(")||t.includes("=>"))return t;if(t=String(t).trim(),!e){t=t.replace(/(\d),(\d)/g,"$1.$2");let i="";for(;i!==t;)i=t,t=t.replace(/[\s]*[+\-*/^%(.;]\s*$/,"");let s=(t.match(/\(/g)||[]).length,n=(t.match(/\)/g)||[]).length,a=s-n;a>0&&(t+=")".repeat(a))}return t=t.replace(/clamp\(([^,]+),([^,]+),([^\)]+)\)/gi,"min(max($1, $2), $3)"),t=t.replace(/([)\w--._]+)\s*\^\s*([(\w--._]+)/g,"$1**$2"),`return (${t})`}function At(t,e="value",i){if(e==="number")return parseFloat(t);let{d:s,t:n}=flexbe_cli.vars.site.currencyFormat,a=i?.decimalPlaces??0,o=i?.thousandsSeparator?n:"",l=i?.resultText??"",r=flexbe_cli.locale.formatNumber(t,a,{d:s,t:o});return e==="value"||!l?r:jt(l,()=>r)}function dt(t){let e=t.getAttribute("data-calc-value")??t.querySelector("[data-calc-value]")?.getAttribute("data-calc-value")??t.getAttribute("value");if(e!=="")return e}var ht="",Me=class extends HTMLElement{formId="";fieldId="";resultType="value";currentValue=null;currentAnimation=null;constructor(){super(),this.handleUpdate=this.handleUpdate.bind(this),this.attachListeners()}static get observedAttributes(){return["data-form-id","data-result-id","data-result-type"]}connectedCallback(){this.parseAttributes(),this.updateContent()}disconnectedCallback(){this.stopCurrentAnimation(),this.removeListeners()}parseAttributes(){this.formId=this.getAttribute("data-form-id")||"",this.fieldId=this.getAttribute("data-result-id")||"",this.resultType=this.getAttribute("data-result-type")||"value"}attachListeners(){flexbe_cli.events.on("form_event",this.handleUpdate)}removeListeners(){flexbe_cli.events.off("form_event",this.handleUpdate)}handleUpdate(t){t.formId===this.formId&&["calculator_inited","field_changed"].includes(t.type)&&this.updateContent()}updateContent(){if(!this.formId||!this.fieldId){this.textContent=ht;return}let t=G.get(this.formId),e=t?.getFieldConfig(this.fieldId);if(!e){this.textContent=ht;return}try{let i=t.getFieldValue(this.fieldId,"number"),s=typeof i=="number"&&!Number.isNaN(i)&&isFinite(i);s&&this.currentValue!=null&&e?.smoothAnimation&&typeof anime=="function"?this.animateChange(i):this.textContent=String(t.getFieldValue(this.fieldId,this.resultType)||e.beforeResult||ht),this.currentValue==null&&s&&(this.currentValue=i)}catch{this.textContent=e.beforeResult||ht}}stopCurrentAnimation(){this.currentAnimation&&(this.currentAnimation.pause(),this.currentAnimation=null)}animateChange(t){if(this.stopCurrentAnimation(),t==null)return;let i=G.get(this.formId)?.getFieldConfig(this.fieldId);if(!i)return;let s={value:this.currentValue},n=Math.abs(t-this.currentValue),r=Math.min(600,150+n*5);this.currentAnimation=anime({targets:s,value:t,duration:r,easing:"easeInOutQuad",update:()=>{this.textContent=At(s.value,this.resultType,i)},complete:()=>{this.currentValue=t,this.currentAnimation=null,this.textContent=At(t,this.resultType,i)}})}};function Pe(t){if(!t.includes("<form-result"))return t;let e=t.match(/data-form-id=['"]([^'"]+)['"]/),i=e?e[1]:null,s=t.match(/data-result-id=['"]([^'"]+)['"]/),n=s?s[1]:null,o=t.match(/data-result-type=['"]([^'"]+)['"]/)?.[1]||"value";return i&&n?G.get(i)?.getFieldValue(n,o):""}function Re(t){let e=new Map,i=new Set,s=new Proxy({},{ownKeys(){return[...t.keys()]},getOwnPropertyDescriptor(n,a){if(typeof a=="string"&&t.has(a))return{enumerable:!0,configurable:!0,value:s[a]}},has(n,a){return typeof a=="string"&&t.has(a)},get(n,a){if(typeof a=="symbol")return;if(e.has(a))return e.get(a);if(!t.has(a))return;if(i.has(a))throw new Error(`Circular dependency detected on "${a}"`);let o=t.get(a),l;if(typeof o=="number")l=o;else if(o==="-")l=void 0;else if(typeof o=="string"){i.add(a);try{l=Ee(a,o,s),e.set(a,l)}finally{i.delete(a)}}return l}});return s}customElements.get("form-result")||customElements.define("form-result",Me);var De=class{inited=!1;state=null;fieldsValues=new Map;fieldsConfigs=new Map;constructor({formInstance:t}){this.formInstance=t}init(){this.formInstance.$component[0].querySelectorAll("[data-calc-name]").forEach(e=>{let i=e.getAttribute("data-calc-name"),s=$(e).closest("[data-type]").attr("data-type");this.fieldsConfigs.set(i,{type:s,input:e.querySelector('input[name*="[value]"]'),beforeResult:e.getAttribute("data-calc-before-result")??"\u2014",resultText:e.getAttribute("data-calc-text")??`{{ ${i} }}`,decimalPlaces:Number(e.getAttribute("data-decimal-places"))||0,thousandsSeparator:e.getAttribute("data-thousands-separator")==="true",smoothAnimation:e.getAttribute("data-smooth-animation")==="true"}),this.updateFieldValue(e)}),this.syncState(),G.set(this.formInstance.elementId,this),this.inited=!0,flexbe_cli.events.trigger("form_event",{type:"calculator_inited",formId:this.formInstance.elementId})}destroy(){G.delete(this.formInstance.elementId),this.inited=!1,this.fieldsValues=new Map,this.state=null}getFieldValue(t,e="value"){let i=this.fieldsConfigs.get(t),s=this.state?.[t];return!s||!isFinite(s)?i?.beforeResult||"":At(s,e,i)}getFieldConfig(t){return this.fieldsConfigs.get(t)}updateFieldValue(t,e){let i=t.getAttribute("data-calc-name");if(!i)return;let s=$(t).closest("[data-type]").attr("data-type");if(this.fieldsValues.has(i)||this.fieldsValues.set(i,void 0),["radio-radio","select"].includes(s)&&(t.checked||t.selected)&&this.fieldsValues.set(i,dt(t)),s==="checkbox"){let n=t.checked,a=$(t).attr("data-calc-value-off")??0,o=n?dt(t):a;this.fieldsValues.set(i,o)}if(s==="radio-checkbox"&&(!e||e.type==="change")){let n=Number(this.fieldsValues.get(i)??0),a=dt(t),l=t.checked?Number(a||0):this.inited?-Number(a||0):0;this.fieldsValues.set(i,n+l)}if(["number","range","hidden","result"].includes(s)){let n=dt(t);s==="number"&&n&&(n=n.replace(/,/g,".")),this.fieldsValues.set(i,n)}}syncState(){this.state=Re(this.fieldsValues);try{[...this.fieldsConfigs.entries()].filter(([e,i])=>i.type==="result").forEach(([e,i])=>{let s=i.input,n=this.getFieldValue(e,"text");s&&(s.value=String(n))})}catch(t){console.debug(t)}}onFieldChange(t,e){e.closest("[data-calc-name]")&&(this.updateFieldValue(e,t),this.syncState())}},Ve=class{constructor(t){this.$input=t.find('input:not([type="hidden"]'),this.max=Number(this.$input.data("max")),this.min=Number(this.$input.data("min")),this.decimalPlaces=Number(this.$input.data("decimal-places")||0),this.$input[0]&&(this.$input.val(this.normalize(this.$input.val())),this.setEvents())}normalize(t){return t=this.onlyNumber(t),t=this.decimalPlacesValue(t),!Number.isNaN(this.max)&&!Number.isNaN(this.min)&&(t=this.minMaxValue(t)),t}onlyNumber(t){return t=t.replace(/[^\d.,-]/g,""),t.includes("-")&&(t=t.replace(/-/g,""),t=`-${t}`),t=t.replace(/([.,])[.,]*/g,"$1"),t=t.replace(/^([^.,]*[.,][^.,]*)[.,].*$/,"$1"),+this.decimalPlaces||(t=t.replace(/[.,]/g,"")),t}minMaxValue(t){let e=parseFloat(t.replace(",","."));return Number.isNaN(e)||(e>this.max?t=this.max.toString():e<this.min&&(t=this.min.toString())),t}decimalPlacesValue(t){let e=t.split(/[.,]/);return e[1]&&e[1].length>this.decimalPlaces&&(t=t.replace(new RegExp(`([.,]\\d{${this.decimalPlaces}})\\d*`),"$1")),t}setEvents(){this.$input.on("input",t=>{let e=t.currentTarget,i=e.value;i=this.onlyNumber(i),i=this.decimalPlacesValue(i),e.value=i,this.$input.trigger("change")}),this.$input.on("blur",t=>{let e=t.currentTarget,i=e.value;e.value=this.minMaxValue(i),this.$input.trigger("change")}),this.$input.on("keydown",t=>{let e=t.key,i=e==="ArrowUp";if(!i&&!(e==="ArrowDown"))return;t.preventDefault();let n=t.currentTarget,a=parseFloat(n.value.replace(",","."))||0,o=this.getStepValue(t.originalEvent),l;i?l=a+o:l=a-o,!Number.isNaN(this.max)&&l>this.max&&(l=this.max),!Number.isNaN(this.min)&&l<this.min&&(l=this.min);let r=this.formatNumber(l);n.value=r,this.$input.trigger("change")})}getStepValue(t){let e=10**-this.decimalPlaces,i=t.shiftKey?10:1,s=t.ctrlKey||t.metaKey?100:1,n=t.altKey?.1:1;return e*i*s*n}formatNumber(t){return this.decimalPlaces===0?Math.round(t).toString():t.toFixed(this.decimalPlaces)}};function Le(t,e){let{to:i,from:s,fields:n}=Yt(t);n.forEach((l,r)=>{r>=s&&r<i&&$(l).addClass("allocate-space-for-error")});let a=$(t),o=a.find(".error");a.outerWidth(),a.addClass("is_error"),o.length&&(o.attr("title",e),o.find(".error-text").text(e))}function ze(t){let e=t.closest(".form-field")[0],{to:i,from:s,fields:n}=Yt(e);t.closest(".is_error").removeClass("is_error"),n.forEach((a,o)=>{o>=s&&o<i&&$(a).removeClass("allocate-space-for-error")})}function Yt(t){if(!t?.hasAttribute("data-type")||["radio-radio","radio-checkbox","checkbox"].includes(t?.getAttribute("data-type")))return{to:0,from:0,fields:[]};let e=Array.from(t.parentElement.children),i=e.indexOf(t)+1,s=getComputedStyle(t.closest(".form-fields")).getPropertyValue("grid-template-columns").split(" ").length,n=Math.ceil(i/s),a=s*n,o=a-s;return{to:a,from:o,fields:e}}function Jt({$field:t,selector:e,attribute:i,attrValue:s}){let n=t.attr("data-default-value");if(n){let a=t.find(e);!isNaN(Number(n))&&Number(n)<=a.length?(a.removeAttr(i),a.eq(Number(n)-1).attr(i,s)):a.each((o,l)=>{let r=$(l);r.val()===n&&(a.removeAttr(i),r.attr(i,s))})}}function Be(t){let e=t.find('[data-type="radio-radio"]'),i=t.find('[data-type="radio-checkbox"]');e.length&&e.each((s,n)=>{Jt({$field:$(n),selector:'input[type="radio"]',attribute:"checked",attrValue:"checked"})}),i.length&&i.each((s,n)=>{let a=$(n),o=a.attr("data-default-value")||"",l=a.find("input.form-field-checkbox__input"),r=o.split(/[,;\s]+/).filter(c=>c!=="").map(c=>isNaN(Number(c))?c:Number(c));l.each((c,d)=>{let h=$(d),p=h.attr("value");(r.includes(p)||r.includes(c+1))&&h.attr("checked","checked")})})}function qe(t){t.find('[data-type="checkbox"]').each((i,s)=>{let n=$(s).attr("data-default-value"),a=$(s).find("input.form-field-checkbox__input");["on",1,"1",!0,"true"].includes(n)&&a.attr("checked","checked"),["off",0,"0",!1,"false"].includes(n)&&a.removeAttr("checked")})}function Oe(t){t.find('.form-field[data-type="phone"]:not([data-hidden])').each((e,i)=>{let n=$(i).find("input").not('[type="hidden"]'),a=n[0];if(!n[0])return;let o=$(a).val();$(a).val(o.replace(/[^0-9+\-_()]/g,""))})}var He=(t,{countriesList:e=[],statesList:i=[]}={})=>{let{addressLine1:s,addressLine2:n,country:a,city:o,region:l,zipCode:r}=t||{},c=e.find(p=>p.value===a)?.title||a,d=a==="US"&&i.find(p=>p.value===l)?.title||l,h=[];switch(a){case"RU":h=[s,n,o,d,r,c];break;case"US":h=[s,n,o,`${d}${r?` ${r}`:""}`,c];break;case"EN":h=[s,n,o,d,r,c];break;case"DE":h=[`${r} ${o}`,s,n,d,c];break;case"FR":h=[`${r} ${o}`,s,n,d,c];break;default:h=[s,n,o,d,r,c];break}return h.filter(p=>p&&p.trim().length>0).join(", ")},Ne=class extends Error{data=null;response=null;name="FormError"},We=class extends Error{name="NetworkError";data=null;response=null},Ct=(()=>{if(typeof process<"u"&&{}.LOG_LEVEL){let t={}.LOG_LEVEL.toLowerCase();if(["debug","info","warn","error"].includes(t))return t}return"error"})();function Kt(t){let e=`[${t}]`;return{debug:(...i)=>{["debug"].includes(Ct)&&console.debug(e,...i)},info:(...i)=>{["debug","info"].includes(Ct)&&console.info(e,...i)},warn:(...i)=>{["debug","info","warn"].includes(Ct)&&console.warn(e,...i)},error:(...i)=>{console.error(e,...i)}}}var Qs=Kt("App"),St=Kt("API"),j={},Ue={hash:0,abortPrev:!1,dataType:"json",contentType:"application/x-www-form-urlencoded",asJson:!1,data:{}},Gt={codes:{0:"main::error::network",401:"main::error::not_authorized",404:"main::error::page_not_found"},statuses:{parsererror:"main::error::incorrect_answer",error:"main::error::unknown",abort:""}};async function je(t,e){return Ge("GET",t,e)}async function Ge(t,e,i){t=t?String(t).trim().toUpperCase():"POST";let s={...Ue,...i,url:e,type:t};s.asJson&&typeof s.data=="object"&&(s.data=JSON.stringify(s.data)),s.data&&typeof s.data=="string"&&(s.contentType="application/json");let n=`${e}:${s.hash||0}`;return s.abortPrev&&Ye(n),new Promise((a,o)=>{j[n]=$.ajax(s).done((c,d,h)=>{let p=h.status,u=d||h.statusText;c?.status??!0?l({payload:c}):r({response:h,payload:c,statusCode:p,statusText:u})}).fail((c,d)=>{let h=c.status,p=d||c.statusText,u=c.responseJSON;p!=="abort"&&r({response:c,payload:u,statusCode:h,statusText:p})});function l({payload:c}){return St.debug("Request successful",{url:e,type:t,statusCode:200}),a(c)}function r({response:c,payload:d={},statusCode:h,statusText:p="error"}){let u,f=d.message||d.error||d.detail;return typeof f=="object"&&f.message!=null&&(f=f.message),f||(f=Gt.codes[h]||Gt.statuses[p]),h===401&&(St.warn("Unauthorized request, redirecting to login",{url:e,statusCode:h}),window.location.href=`${flexbe.vars.app.url}/login/`),d.violations&&Array.isArray(d.violations)?(u=new Ne(tr(f)),d.violations=d.violations.map(m=>({...m,name:m.propertyPath.replace(/\[(\w*)]/g,".$1").slice(1)}))):u=new We(tr(f)),u.response=c,u.data=d,St.error("Request failed",u,{url:e,statusCode:h,statusText:p}),o(u)}})}function Ye(t){try{if(t){let e=j[t];typeof e=="number"&&clearTimeout(e),typeof e=="object"&&(e.abort(),delete j[t])}else Object.values(j).forEach(e=>{typeof e=="object"&&e.abort()}),j={}}catch{}}var W=null,Je=class{shippingStore=flexbe_cli.ecommerce.shippingStore;cartStore=flexbe_cli.ecommerce.cartStore;promotionStore=flexbe_cli.ecommerce.promotionStore;constructor({$component:t,id:e}){this.$component=t,this.id=e,this.$shipping=this.$component.find('[data-type="shipping"]'),this.$shipping.length&&(this.$addressFields={},this.init())}async init(){await this.loadAddressMeta(),this.setupScrollHandlers(),this.setupAddressFields(),this.setupShippingMethods(),this.onSelectMethod(),this.onUpdatePrices(),this.updateScrollClasses(),this.updateShippingAddress(),this.updateShippingSwitchVisibility(),this.updateAddressFieldsConfig(),this.setupEventListeners()}setupScrollHandlers(){this.$shipping.find(".form-field-shipping-inner").on("scroll",this.updateScrollClasses.bind(this))}updateScrollClasses(t){(t?$(t.target).closest(".form-field-shipping-inner"):this.$shipping.find(".form-field-shipping-inner")).each((i,s)=>{let n=$(s),a=n.closest(".form-field-shipping-wrap"),o=Math.round(n.scrollTop()),l=s.scrollHeight,r=s.clientHeight;a.removeClass("scroll-up scroll-down"),o>0&&a.addClass("scroll-up"),o<l-r&&a.addClass("scroll-down")})}setupAddressFields(){this.$addressFields={country:this.$shipping.find('[data-field-id="country"] select').eq(0),addressLine1:this.$shipping.find('[data-field-id="addressLine1"] input[name*=value]').eq(0),addressLine2:this.$shipping.find('[data-field-id="addressLine2"] input[name*=value]').eq(0),city:this.$shipping.find('[data-field-id="city"] input[name*=value]').eq(0),region:this.$shipping.find('[data-field-id="region"] input[name*=value]').eq(0),regionRow:this.$shipping.find(".region-field-row").eq(0),state:this.$shipping.find('[data-field-id="state"] select').eq(0),stateRow:this.$shipping.find(".state-field-row").eq(0),zipCode:this.$shipping.find('[data-field-id="zipCode"] input[name*=value]').eq(0)},this.$addressFields.country.on("change",()=>{this.updateCountriesAndStates(),this.updateShippingAddress()}),this.$shipping.on("input change",".form-fields-address input, .form-fields-address select",()=>this.updateShippingAddress())}setupShippingMethods(){let t=this.shippingStore;this.$shipping.on("change",".form-field-switch input[type=radio]",e=>{let i=e.target;t.dispatch("selectType",i.value),this.scrollToActiveMethod(!1)}),this.$shipping.on("change",".form-field-shipping-item input[type=radio]",e=>{let i=e.currentTarget;if(i.checked){let s=i.closest("[data-shipping]")?.getAttribute("data-shipping");s&&t.dispatch("selectMethod",s)}})}setupEventListeners(){setTimeout(()=>{this.shippingStore&&this.shippingStore.on(`dispatch.form-component-${this.id}`,({name:t})=>{t==="selectMethod"&&this.onSelectMethod()}),this.cartStore&&this.cartStore.on(`dispatch.form-component-${this.id}`,()=>{this.onUpdatePrices()}),this.promotionStore&&this.promotionStore.on(`dispatch.form-component-${this.id}`,()=>{this.onUpdatePrices()})},10)}async updateCountriesAndStates(){let t=this.shippingStore,e=t.activeMethod,i=this.$addressFields.country.closest(".form-field"),s=this.$addressFields.state.closest(".form-field"),n=this.$shipping.find(".form-field-shipping-item__address");if(i.addClass("loading"),s.addClass("loading"),n.addClass("loading"),t.getList("pickup").forEach(p=>{let u=this.$shipping.find(`.form-field-shipping-item[data-shipping="${p.id}"] .form-field-shipping-item__address`),f=He(p.address,{countriesList:W?.countries||[],statesList:W?.states||[]});u.text(f)}),n.removeClass("loading"),!e)return;let o=e.isInternationalDelivery,l=this.$addressFields.country.val(),r=!this.$addressFields.country.prop("disabled"),c=o?e.availableCountry:[flexbe_cli.vars.site.country],d=(W?.countries||[]).filter(p=>!c.length||c.includes(p.value)).map(p=>({value:p.value,label:p.title}));if(r){if(wt(this.$addressFields.country[0],d),!l||!d.some(p=>p.value===l)){let p=flexbe_cli.vars.site.country;p&&d.some(u=>u.value===p)?this.$addressFields.country.val(p):d.length>0&&this.$addressFields.country.val(d[0].value)}this.$addressFields.country.trigger("syncSelectUI"),i.removeClass("loading")}let h=o&&l==="US"||flexbe_cli.vars.site.country==="US";if(this.updateAddressFieldsConfig(),h){let p=(W?.states||[]).map(u=>({value:u.value,label:u.title}));wt(this.$addressFields.state[0],p),this.$addressFields.state.trigger("syncSelectUI")}s.removeClass("loading")}async loadAddressMeta(){if(W)return;let t=await je(`/mod/metadata/?filter=country,state&language=${flexbe_cli.vars.page.language}`);t&&(W=t)}updateShippingAddress(){let t=this.shippingStore,e={country:this.$addressFields.country.val(),addressLine1:this.$addressFields.addressLine1.val(),addressLine2:this.$addressFields.addressLine2.val(),city:this.$addressFields.city.val(),region:this.$addressFields.region.val(),state:this.$addressFields.state.val(),zipCode:this.$addressFields.zipCode.val()};t.dispatch("setAddress",e)}updateShippingSwitchVisibility(){let t=this.shippingStore,e=t.getList("delivery").length>0,i=t.getList("pickup").length>0;this.$shipping.find('[data-field-id="shipping-type"]').toggle(e&&i)}updateShippingList(){let e=this.shippingStore.activeType,i=this.$shipping.find(".form-field-shipping-wrap"),s=i.filter(`[data-shipping-type="${e}"]`);i.hide(),s.show()}scrollToActiveMethod(t=!0){let i=this.shippingStore.activeMethod;if(!i)return;let s=this.$shipping.find(".form-field-shipping-item").filter(`[data-shipping="${i.id}"]`),n=s.closest(".form-field-shipping-inner")[0];if(n){let a=s[0].getBoundingClientRect().top-n.getBoundingClientRect().top+n.scrollTop-40;n.scrollTo({top:a,behavior:t?"smooth":"auto"})}}syncSwitch(){let e=this.shippingStore.activeType,i=this.$shipping.find(".form-field-switch input[type=radio]"),s=i.filter(`[value="${e}"]`);s.length&&(i.prop("checked",!1),s.prop("checked",!0)),this.updateShippingList()}updateAddressFieldsConfig(){let e=this.shippingStore.activeMethod,i=e.addressFieldsConfig,s=e?.isInternationalDelivery,n=s&&this.$addressFields.country.val()==="US"||flexbe_cli.vars.site.country==="US",a={addressLine1:{show:i?.addressLine1?.show??!0,required:i?.addressLine1?.required??!0},addressLine2:{show:i?.addressLine2?.show??!1,required:i?.addressLine2?.required??!1},country:{show:s||i?.country?.show||!1,required:s||i?.country?.required||!1},state:{show:n&&(i?.region?.show||!1),required:n&&(i?.region?.required||!1)},region:{show:!n&&(i?.region?.show||!1),required:!n&&(i?.region?.required||!1)},city:{show:i?.city?.show??!1,required:i?.city?.required??!1},zipCode:{show:i?.zipCode?.show??!1,required:i?.zipCode?.required??!1}};Object.entries(a).forEach(([o,{show:l,required:r}])=>{let c=this.$shipping.find(`[data-field-id="${o}"]`),d=c.closest(".form-field-address__row:not(.form-field-address__row--multiple)"),h=c.find(".form-field-title"),p=!l||!e?.deliveryAddressEnabled;d.attr("data-hidden",p?"true":null),c.attr("data-hidden",p?"true":null),c.find("input, select, textarea").prop("required",r).attr("disabled",p?"disabled":null);let u=h.text().replace("*","").trim();h.text(u+(r?" *":""))})}onSelectMethod(){let e=this.shippingStore.activeMethod;if(!e)return;let i=this.$shipping,s=i.find(".form-field-shipping-item"),n=i.find(".form-field-shipping-fields"),a=s.filter(`[data-shipping="${e.id}"]`),o=n.filter(`[data-shipping="${e.id}"]`),l=i.find('[data-type="address"]');s.removeClass("form-field-shipping-item--active"),a.addClass("form-field-shipping-item--active"),n.removeClass("form-field-shipping-fields--active"),o.addClass("form-field-shipping-fields--active"),n.find("input, textarea, select").prop("disabled",!0),o.find("input, textarea, select").prop("disabled",!1),s.find("input[type=radio]").prop("checked",!1),a.find("input[type=radio]").prop("checked",!0),l.attr("hidden",e.deliveryAddressEnabled?null:"true"),l.find("input, textarea, select").prop("disabled",!e.deliveryAddressEnabled),this.scrollToActiveMethod(),this.updateCountriesAndStates(),this.updateAddressFieldsConfig(),this.syncSwitch()}onUpdatePrices(){let t=this.shippingStore;this.$shipping.find(".form-field-shipping-item").each((s,n)=>{let a=n.getAttribute("data-shipping"),o=$(n),l=o.find(".item-price"),r=o.find(".delimiter"),c=o.find(".form-field-shipping-item__min-total"),d=o.find(".min-total"),h=t.getPrice(a);if(!h.notHasFree&&(!h.untilFree||!h.notFixedPrice)?(l.text(h.currentFormatted),r.text("\u2013")):(l.text(""),r.text("")),h.minTotal){let p=`${flexbe_cli.locale.tr("form::delivery_min_total_tip",{sum:h.minTotalFormatted})}`;d.text(p),c.show()}else c.hide()})}},Ke=class extends x{static is="form";constructor(...t){super(...t),this.id=this.core.id,this.eventId=`.${this.id}`,this.busy=!1,this.submitDisabled=!1,this.products=null,this.paymentData=null,this.formInited=!1,this.$form=this.$component.is("form")?this.$component:this.$component.find("form"),this.$formSubmit=this.$component.find(".form-submit"),this.$button=this.$formSubmit.find(".component-button"),this.$minSumContainer=this.$formSubmit.find(".cart-min-sum-text"),this.$fields=this.$component.find(".form-fields"),this.action=this.$component.find('input[name="action"]').val(),this.payProducts=this.$component.find('input[name="products"]').val(),this.isInline=this.$component.attr("data-inline")?1:0,this.noSend=this.$component.attr("data-no-send")?1:0,this.inCart=this.$component.closest(".w_widget").length>0,this.inModal=this.$component.closest(".m_modal").length>0,this.elementId=this.inCart?this.$component.parents(".w_widget").attr("data-id"):this.$component.parents(".element-item").attr("data-id"),this.$masked=this.$component.find("[data-mask]"),this.$calendars=this.$component.find(".form-field-date__input"),this.$file=this.$component.find(".file-input-outer"),this.hasCalculatorField=!!this.$component.find('[data-type="result"]').length,this.$file.length&&(this.$itemTemplateFile=this.$itemTemplateFile||this.$file.find("template").clone()),this.$masked.length&&(this.hasMaskedField=!0,this.require.push("/_s/lib/imask/imask.min.js")),this.$calendars.length&&(this.hasCalendarField=!0,this.require.push("/_s/lib/scroll-lock/scroll-lock.min.js"),this.require.push("/_s/lib/calendar/dist/js/calendar.js?v2.3.13","/_s/lib/calendar/dist/css/calendar.min.css?v2.3.5"))}onLoad(){(this.core.wasScreen||this.core.wasBeside)&&(this.hasMaskedField&&this.inputMask(),this.hasCalendarField&&this.inputDate()),flexbe_cli.events.trigger("form_event",{type:"form_inited",formId:this.elementId})}onScreen({state:t}){if(!t)return!1;this.formInit()}onBeside({state:t}){if(!t)return!1;this.formInit()}onOpen(t={}){let{top:e}=this.component.getBoundingClientRect();!flexbe_cli.run.is_screen_mobile&&flexbe_cli.run.is_preview&&flexbe_cli.resize.viewportHeight>e+100&&this.$component.find(".form-field").eq(0).find("input, textarea").eq(0).focus(),t&&t.data&&this.setData(t.data)}onResize(){this.$component.find(".range-outer").trigger("resize")}formInit(){if(this.formInited)return!1;this.formInited=!0,this.$form.attr("action",`/mod/project/${flexbe_cli.group_id}/lead/send/`),this.unbindEvents(),this.bindEvents(),this.noSend||this.initCaptcha(),this.customize()}customize(){this.fileInput(),this.customSelect(),this.textResize(),this.inputRange(),this.inputNumber(),this.shippingField(),Be(this.$component),qe(this.$component),Oe(this.$component),this.hasCalculatorField&&this.initCalculator(),this.hasMaskedField&&this.isLoaded&&this.inputMask(),this.hasCalendarField&&this.isLoaded&&this.inputDate(),this.$component.find(".form-field-range").trigger("resize")}unbindEvents(){this.$component.off(this.eventId),this.$form.off(this.eventId)}bindEvents(){let t=this.$component.find('.form-field-text__input, .form-field-text__textarea, .form-field-range__input, input[type="checkbox"], input[type="radio"]'),e=this.$component.closest(".scroller");t.on(`keydown${this.eventId}`,i=>{let s=i.key||"",n=s==="Enter",a=i.ctrlKey||i.metaKey,o=i.currentTarget,l=o.getAttribute("data-check");if(n){if(o.tagName==="TEXTAREA")return;i.preventDefault();let r=t.index(i.currentTarget),c=t.eq(r+1);c.length?c.trigger("focus"):this.$form.trigger("submit")}if(l==="phone"&&!o._mask&&!a&&s.length===1&&/[^\d ()+-]/.test(s)||l==="email"&&/[\s,]/.test(s))return!1}),t.on(`input${this.eventId} change${this.eventId}`,i=>{let s=i.currentTarget,n=$(s);n.attr("value",s.value),ze(n),this.handleFieldChange(i,s)}),this.$component.find("select").on(`change${this.eventId}`,i=>{let s=i.currentTarget,n=$(s).find("option:selected")[0];this.handleFieldChange(i,n)}),this.hasCalendarField&&(this.inModal||this.inCart)&&setTimeout(()=>{let i=this.$calendars.toArray().map(s=>$(s).data("calendar")).filter(s=>s);e.on(`scroll${this.eventId}`,()=>{i.forEach(s=>s.main.toPosition())})},150),this.$formSubmit.find('button[type="button"]').on(`click${this.eventId}`,()=>{this.$form.trigger("submit")}),this.$form.off("submit").on(`submit${this.eventId}`,i=>((async()=>{if(typeof this.beforeSend=="function"&&await this.beforeSend()===!1)return!1;try{await this.sendForm()}catch(n){alert(n.message)}})(),i.preventDefault(),i.stopPropagation(),!1))}setData(t){if(!t)return!1;t&&t.fields&&this.addFields(t.fields),t&&t.items&&this.addItems(t.items)}defineBeforeSend(t){typeof t=="function"&&(this.beforeSend=t)}defineAfterSent(t){typeof t=="function"&&(this.afterSent=t)}defineOnRequestError(t){typeof t=="function"&&(this.onRequestError=t)}addFields(t,e=!0){let i=this.$component.find(".form-fields-advanced");!t.length||!i[0]||(e&&this.resetFields(),t.forEach(s=>{i.find(`input[name="${s.name}"]`).remove();let n=$("<input>").attr("type",s.type).attr("name",s.name).attr("value",s.value);i.append(n)}))}resetFields(){let t=this.$component.find(".form-fields-advanced");t[0]&&t.empty()}addItems(t=[]){if(!t||!t.length){this.products=null;return}let e=0;t=t.map(i=>typeof i!="object"?{}:(i.price=i.price==null?null:parseFloat(i.price)||0,i.title=typeof i.title=="string"&&i.title.trim()||i.title||"",e+=(i.price??0)*i.count||0,i)),this.products=t||[],e&&(this.pays={price:e,desc:""})}async sendForm(t){if(this.noSend)return!1;if(this.submitDisabled){setTimeout(()=>{this.$formSubmit.addClass("shake"),setTimeout(()=>{this.$formSubmit.removeClass("shake")},500)},30);return}if(this.busy||!this.validateForm())return!1;this.captcha&&t&&this.captcha.reset();let e=this.captcha&&this.captcha.getToken();if(this.captcha&&this.captcha.enabled&&!this.captcha.isOptional&&!e){if(this.captcha.inModal){this.captchaModalRun();return}if(this.captcha.isInvisible){this.captchaInvisibleRun();return}}this.addSubmitting();let i=new FormData(this.$form.get(0)),s=i.get("id");if(i.append("is_ajax","true"),s.includes("cart_")||i.append("forceUpdateProduct","true"),i.delete("products"),this.products)i.append("products",JSON.stringify(this.products));else if(this.action==="pay"&&this.payProducts){let r=JSON.parse(this.payProducts),c;if(r=Array.isArray(r)?r[0]:r,r.productId){let d=flexbe_cli.ecommerce.productsStore.getProduct(r.productId);if(d){let p=d.currentVariant(r.variantId).getCartData("image");p.img=q(p.img[0]),c=[{...p,count:1,strict:r.strict,id:`product_${r.productId}:${r.variantId||"default"}`}]}}else r.title&&(c=[{id:`${flexbe_cli.p_id}_${flexbe_cli.s_id}`,title:r.title,img:r.img&&q(r.img),price:r.price==null?null:parseFloat(r.price)||0,count:1}]);c&&i.append("products",JSON.stringify(c)),this.pays={price:r.price,desc:r.title}}i.append("jsform",JSON.stringify(parseInt(448312,10))),i.has("pageId")||i.append("pageId",flexbe_cli.p_id),flexbe_cli.stat.u_id&&i.append("userId",flexbe_cli.stat.u_id),i.append("utmData",JSON.stringify(flexbe_cli.utm.data)),"roistat"in window&&i.append("roistatVisit",window.roistat.visit);let n=flexbe_cli.stat.AB.getCookie();i.append("abTest",JSON.stringify(n)),i.delete("g-recaptcha-response"),i.delete("goal"),i.delete("goal_html"),i.delete("fileOriginal"),e&&i.append("captcha-token",e);let a=[];for(let[r,c]of i.entries()){let d=/.*address\]*\[.+]\[/.test(r),h=d?r.match(/^(.+)\[value\]$/):null,p=r.match(/^shipping\[fields\]\[([^\]]+)\]\[type\]$/);if(h){let u=h[1];u==="shipping[address][state]"?i.append("shipping[address][region]",c):i.append(u,c)}if(p&&c==="shipping"){let u=p[1];a.push(`shipping[fields][${u}][value]`),a.push(`shipping[fields][${u}][id]`),a.push(`shipping[fields][${u}][type]`),a.push(`shipping[fields][${u}][name]`)}if((r.startsWith("shipping[shipping-type]")||d)&&a.push(r),r.includes("[value]")&&c.includes("<form-result")){let u=Pe(c);i.set(r,u)}}a.forEach(r=>i.delete(r));let o=this.$form.attr("action"),l={type:"POST",dataType:"json",contentType:"application/json",data:JSON.stringify(rt(i))};try{let r=await flexbe_cli.helpers.fetch(o,l);r.pay!=null&&(this.paymentData=r.pay),this.showDone(i,r),this.captchaRemoveError(),this.action!=="redirect"&&this.clearSubmitting(!0)}catch(r){let c=r.data;if(c?.captcha){if(this.captcha)e?this.captchaAddError():this.captcha.inModal?this.captchaModalRun():this.captcha.isInvisible&&(this.captcha.isOptional=!1,this.captchaInvisibleRun());else{let d=c.captcha==="visible";await this.initCaptcha({...L.getRecaptchaSettings(),enabled:!0,visible:d,ttl:1}),d?this.captchaModalRun():(this.captcha.isOptional=!1,this.captchaInvisibleRun())}return}await this.sendFormError(r)}}async sendFormError(t){this.clearSubmitting(),console.error("sendForm error: ",t),typeof this.onRequestError=="function"?await this.onRequestError(t,this):t.status&&t.status===500&&alert("Network error")}addSubmitting(){this.busy=+Date.now(),this.$component.addClass("submitting"),this.$button.addClass("submitting")}clearSubmitting(t=!1){this.busy&&(this.$component.removeClass("submitting"),this.$button.removeClass("submitting"),t?(this.$component.addClass("success"),this.$button.addClass("success"),this.$component.find(".file-list").empty(),this.$component.find("input.value").remove(),setTimeout(()=>{this.busy=!1,this.$component.removeClass("success"),this.$button.removeClass("success")},1e3)):this.busy=!1)}showDone(t,e={}){let i=lt(t,{leadId:e.lead_id,pays:e.pay}),s={leadId:e.lead_id,formData:i};if(typeof this.afterSent=="function"&&this.afterSent(),flexbe_cli.stat.reachGoals({mainGoal:flexbe_cli.stat.getGoal("order_done"),goal:this.$component.find('input[name="goal"]').val(),htmlGoal:this.$component.find('textarea[name="goal_html"]').val()},s),this.action==="pay")if(typeof this.paymentData<"u"&&this.paymentData!==null){if(this.paymentData.pay_link.length>0){let a=`${window.location.origin+window.location.pathname+(window.location.search?`${window.location.search}&`:"?")}pay_id=${this.paymentData.pay_id}&h=${this.paymentData.pay_hash}`;try{window.history.pushState(null,null,a),setTimeout(()=>{flexbe_cli.events.trigger("pay",{action:"init"})},200)}catch{setTimeout(()=>{document.location=a},500)}}}else window.location.hash="pay",flexbe_cli.events.trigger("pay",{action:"success",withoutPay:!0});else if(this.action==="redirect"){let a=this.$component.find('input[name="action_redirect"]'),o;a&&a.length&&(o=a.val()),o&&setTimeout(()=>{flexbe_cli.helpers.gotoLink(o),this.clearSubmitting(!0)},500)}else if(this.action==="code"){if(!flexbe_cli.run.is_preview)return;(async o=>{let l=this.$component.data("code")||"",r=Object.getPrototypeOf(async()=>{}).constructor;await new r("formData",l)(o)})(i).catch(o=>{console.error("Error executing action code:",o)})}else{let a=this.$component.find("[data-modal-id]").attr("data-modal-id");/^(form|done)$/.test(a)&&!flexbe_cli.modal.find(a)&&(a=`${String(this.id).split("_")[0]}_${a}`),flexbe_cli.events.trigger("ui_modal_open",{id:a})}let n=new Event("submitted",{bubbles:!0});this.$form.get(0).dispatchEvent(n),this.resetForm()}resetForm(){this.$component.find(".file-input-outer").removeClass("active");let t=this.$fields.find("input, textarea, select"),e=t.not("select").not('[type="hidden"]').not(".form-field-range__input").not(".g-recaptcha-response"),i=t.filter("select"),s=t.filter(".form-field-range__input");i.each((n,a)=>{let o=a.querySelector("option"),l=o&&o.value||"";a.value!==l&&(a.value=l,a.dispatchEvent(new Event("change",{bubbles:!0,cancelable:!0})))}),s.each((n,a)=>{a.value=a.getAttribute("data-value"),a.dispatchEvent(new Event("change",{bubbles:!0,cancelable:!0}))}),e.each((n,a)=>{let l=a.defaultChecked;if(["radio","checkbox"].includes(a.type))l?a.setAttribute("checked",!0):a.removeAttribute("checked"),a.checked=l;else{a.removeAttribute("value"),a.value="",a.removeAttribute("data-mask-complete");let r=a._mask;r&&r.updateValue()}a.dispatchEvent(new Event("change",{bubbles:!0,cancelable:!0}))}),this.captcha&&this.captcha.enabled&&(this.captcha.reset(),this.captchaRemoveError()),this.paymentData=null,at(),this.$form.get(0).reset(),this.resetFields()}validateForm(){let t=!0,e=!0,i=!0;this.removeFieldsErrors();let s=this.$component.find(".policy-data-warning--checkbox"),n=s.find("input")[0];n&&!n.checked&&(t=!1,s.addClass("is_error")),this.$component.find(".form-field[data-type]:not([data-hidden])").each((o,l)=>{let r,c=$(l),d=c.find("input, textarea, select").not('[type="hidden"]'),h=d[0],p=c.attr("data-type");if(!h&&p!=="captcha")return;let u=h.type,f=u==="file"?c.find("input.value"):h.value;if(["radio","checkbox"].includes(u)&&(f=d.toArray().some(m=>m.checked)),p==="captcha"){if(!this.captcha)return;r=this.captcha.getToken()?!1:flexbe_cli.locale.tr("form::captcha_not_checked")}else r=this.checkField(c,d);r&&(Le(l,r),e=!1),i&&f&&p!=="captcha"&&(i=!1)}),this.$fields.removeClass("all-fields-empty"),this.$fields.outerWidth(),e||this.$fields.addClass("has-error");let a=this.$component.find(".is_error");return a.addClass("animate"),setTimeout(()=>{a.removeClass("animate")},500),i&&(this.$fields.toggleClass("all-fields-empty",i),e=!1),e&&t}checkField(t,e){let i=e[0];if(i.disabled||i.hidden)return!1;let s=i.type,n=s==="file"?t.find("input.value"):i.value;["radio","checkbox"].includes(s)&&(n=e.toArray().some(c=>c.checked));let a=i.required,o=i.getAttribute("data-check")||!1,l=i._mask&&i.getAttribute("data-mask")||!1,r=a&&!n?"form::required":!1;if(l)!a&&!n||i.getAttribute("data-mask-complete")||(s==="tel"&&n?r="form::phone":s==="text"&&n?r="form::text":r="form::required");else if(o)if(o==="date"||o==="datetime"){let c=$(i).data("calendar"),d=c&&c.input.checkError();d&&(r=d)}else n.length&&s==="email"?/^(([^\s"(),.:;<>@[\\\]]+(\.[^\s"(),.:;<>@[\\\]]+)*)|(".+"))@((\[(?:\d{1,3}\.){3}\d{1,3}])|(([\w--]+\.)+[A-Za-z-]{2,}))$/.test(n)||(r="form::email"):n.length&&s==="tel"?/[^\d\s()+-]/.test(n)?r="form::digits":n.replace(/\D/g,"").length<5&&(r="form::phone_minlength"):s==="file"&&(a&&!n.length?r="form::required":t.hasClass("loading")?r="form::loading":r=!1);return r=r&&flexbe_cli.locale.tr(r)||!1,r}removeFieldsErrors(){this.$fields.removeClass("has-error"),this.$component.find(".is_error").removeClass("is_error animate"),this.$component.find(".allocate-space-for-error").removeClass("allocate-space-for-error"),this.$fields.outerWidth()}disableSubmit(t){this.submitDisabled=!0,flexbe_cli.run.is_mobile?this.$minSumContainer.text(t):this.$formSubmit.attr("data-tip",t||""),this.$button.attr("disabled","disabled"),flexbe_cli.tip.init(this.$formSubmit)}enableSubmit(){this.submitDisabled=!1,flexbe_cli.run.is_mobile?this.$minSumContainer.empty():this.$formSubmit.removeAttr("data-tip"),this.$formSubmit.removeAttr("data-tip"),this.$button.removeAttr("disabled"),flexbe_cli.tip.destroy(this.$formSubmit)}async initCaptcha(t){return t==null&&(t=L.getRecaptchaSettings()),new Promise((e,i)=>{!this.captcha&&t.enabled&&(this.captcha=new L({id:this.id,$form:this.$component,inModal:this.isInline,onSuccess:s=>{this.captchaRemoveError(),this.clearSubmitting(),(s.inModal||s.isInvisible)&&this.sendForm()},onError:()=>{this.captchaAddError()}},t),flexbe_cli.require(`https://www.google.com/recaptcha/api.js?render=explicit&hl=${flexbe_cli.vars.site.language}`,()=>{let s=150,n=setInterval(()=>{s-=1,this.captcha.loaded?(this.captcha.init(),clearInterval(n),e()):s===0&&i(new Error("Can not load grecaptcha"))},10)}))})}captchaAddError(t){if(!this.captcha||!this.captcha.enabled)return;t==null&&(t=flexbe_cli.locale.tr("form::captcha_error"));let e=this.$component.find(".captcha-global-error");e.find(".error-text").text(t),e.addClass("show"),this.busy&&this.clearSubmitting()}captchaRemoveError(){if(!this.captcha||!this.captcha.enabled)return;let t=this.$component.find('.form-field[data-type="captcha"]'),e=this.$component.find(".captcha-global-error");t.removeClass("is_error allocate-space-for-error"),e.removeClass("show")}captchaModalRun(){!this.captcha||!this.captcha.enabled||!this.captcha.loaded||this.captcha.runModalCaptcha()}captchaInvisibleRun(){if(!this.captcha||!this.captcha.enabled||!this.captcha.loaded||this.captcha.isVisible)return;this.addSubmitting(),this.captcha.runInvisibleChallenge();let t=this.busy;setTimeout(()=>{t===this.busy&&this.clearSubmitting()},2500)}fileInput(){let t=this.$component,e=this.eventId,i=this.$itemTemplateFile?.html();nt(t,e,i)}textResize(){this.$component.find(".autosize").each((e,i)=>{let s=i.offsetHeight-i.clientHeight,n=$(i),a=getComputedStyle(i),o=+n.attr("rows")||0,l=parseInt(a.borderTop,10)+parseInt(a.borderBottom,10),r=parseInt(a.paddingTop,10)+parseInt(a.paddingBottom,10),c=Math.round(+a.lineHeight.split("px")[0]);if(flexbe_cli.run.is_ios){let h=parseInt(a.textSizeAdjust||a.webkitTextSizeAdjust||"120%",10)/100;c/=h}n.removeAttr("data-autoresize"),n.off(".autoresize").on("keyup.autoresize input.autoresize",d),n.css("minHeight",`${l+r+c*o}px`);function d(h){let p=h.currentTarget;p.style.height=`${p.scrollHeight+s}px`}})}customSelect(){this.$component.find(".dropdown-container").remove();let t=this.$component.find("select.atom-custom-select"),e={dropdownClass:this.$component.hasClass("style-underlined")?`sharp size--medium select-container-${this.elementId} `:`size--medium select-container-${this.elementId}`};t.each((i,s)=>{let n=$(s).closest('[data-type="select"]');Jt({$field:n,selector:"option",attribute:"selected",attrValue:"selected"});let a=()=>{n.removeClass("active")},o=()=>{n.addClass("active"),n.siblings('[data-type="select"]').removeClass("active")};tt.create({element:s,config:e,onCollapse:a,onActivate:o})})}shippingField(){this.shippingManager=new Je({$component:this.$component,id:this.id})}inputRange(){this.$component.find(".form-field-range").each((t,e)=>new it($(e)))}inputNumber(){this.$component.find('[data-type="number"]').each((t,e)=>new Ve($(e)))}initCalculator(){try{this.calculator=new De({formInstance:this}),this.calculator.init()}catch(t){console.error(t)}}inputMask(){return typeof IMask>"u"?!1:(this.hasMaskedField=!1,this.$masked.each((t,e)=>{ot(e);let i=!!e.getAttribute("data-placeholder"),s=e._mask;i&&s&&($(e).on(`focus${this.eventId}`,()=>{s.updateOptions({lazy:!1})}),$(e).on(`blur${this.eventId}`,()=>{if(!s.unmaskedValue){let n=s.mask.replace(/\*/g,"_"),a=s.value;s.updateOptions({lazy:!0}),(!s.masked.rawInputValue||n===a)&&(s.unmaskedValue="",s.value="",s.updateValue())}}))}),!0)}inputDate(){this.hasCalendarField=!1;let t=this.$component.closest(".scroller")[0];return this.$calendars.each((e,i)=>{st(i,t)}),!0}handleFieldChange(t,e){this.calculator&&this.calculator.onFieldChange(t,e),flexbe_cli.events.trigger("form_event",{type:"field_changed",formId:this.elementId,element:e})}},Qt=class extends Ke{};flexbe_cli.entity.setClientJs("element","form01",{isPure:!0,components:[Qt]});var ut=class extends J{static is="button"};var Qe=new Array(70).fill(1).map((t,e)=>50+50*e),P=class extends x{static is="icon";async onInit(){this.$component.on("setImage",async()=>{this.isVisible&&!this.isImgLoaded&&(this.isCreated||this.create(),await this.loadImage())})}async onBeside({state:t}){t&&(this.isCreated||this.create(),this.isLazyLoading&&!this.isImgLoaded&&await this.loadImage())}async onResize(){this.isCreated&&await this.loadImage()}create(){let t=this.$component.data();this.imageLoadingOptions=flexbe_cli.vars.site.images,this.isLazyLoading=!!t.imgLazy,this.image={url:t.imgUrl||null,id:t.imgId,ext:t.imgExt,proportion:t.imgProportion,width:t.imgWidth,animated:t.imgAnimated,transparent:t.imgTransparent,scale:t.imgScale,type:"background"},this.isCreated=!0}async loadImage(){let t=this.$component.find(".vector-icon use"),e=this.$component.find(".custom-icon");if(t.length&&t.attr("href",this.image.url),e.length){let i=this.image.url;if(this.image.id){let s={width:this.componentWidth,height:this.componentHeight},{width:n}=await R(this.image,s,{...this.imageLoadingOptions,sizes:Qe});i=k(this.image,n,this.imageLoadingOptions)}i&&e.css("background-image",`url(${i})`)}this.isImgLoaded=!0}};flexbe_cli.entity.setClientJs("element","header_button",{components:[ut,P],isPure:!0});flexbe_cli.entity.setClientJs("element","header_contacts",{components:[P],onLoad(){this.fixIcon()},onMsg(t){t==="change_contact"&&this.fixIcon()},fixIcon(){let t=this.$area,e=t.find(".component-icon"),i=t.find(".element-text--contact");if(t.find(".element-text--desc").length&&i.length&&e.length){let n=i[0].offsetHeight,a=e[0].offsetHeight;if(n>a){let o=n/2-a/2;e.css("margin-top",`${o}px`)}else e.css("margin-top","")}}});flexbe_cli.entity.setClientJs("element","header_divider",{isPure:!0});flexbe_cli.entity.setClientJs("element","header_logo",{isPure:!0});var Xt=class extends x{static is="menu";get showOnClick(){return this.showType==="click"||flexbe_cli.resize.responsiveMode==="mobile"||flexbe_cli.run.is_touch}get showOnHover(){return this.showType==="hover"&&flexbe_cli.resize.responsiveMode==="desktop"&&flexbe_cli.run.is_pointer}get actualDirection(){return flexbe_cli.resize.responsiveMode==="desktop"?this.direction:this.directionAdaptive}get showAsRollup(){return flexbe_cli.resize.responsiveMode==="mobile"&&this.$component.attr("data-rollup-adaptive")==="true"}constructor(...t){super(...t),this.eventId=this.core?.id,this.rootModal=this.core.is==="modal"?this.core:!1,this.$menuList=this.$component.find(".component-menu-list--root"),this.showType=this.$component.attr("data-type"),this.direction=this.$component.attr("data-direction"),this.directionAdaptive=this.$component.attr("data-direction-adaptive"),this.activateMode=this.$component.attr("data-activate-mode"),this.allowShowMore=this.$component.attr("data-show_more"),this.isNested=!!this.$menuList.find(".folder-item").length,this.openFolders=[],this.activeHref=null}_getCleanPath(t){return t?t.split("?")[0]:""}_isInFolder(t){return!!t.closest(".folder-item").length}_isCurrentPageUrl(t){return!t||t.includes("#")?!1:this._getCleanPath(t)===window.location.pathname}_findMenuItemByAnchor(t){return this.$component.find(`a[href*="#${t}"]`).filter((e,i)=>{let s=$(i),n=s.attr("href"),[a]=n.split("#");return(!a||a===window.location.pathname)&&!this._isInFolder(s)}).closest("li")}_findMenuItemByCurrentUrl(){return this.$component.find("a").filter((t,e)=>{let i=$(e);return this._isCurrentPageUrl(i.attr("href"))&&!this._isInFolder(i)}).closest("li")}activateMenuItem(t){return t&&t.length?(this.setActive(t),this.activeHref=t.find("a").attr("href"),!0):!1}deactivateMenuItem(){return this.clearActive(),this.activeHref=null,!0}activateMenuItems(){let t=this.$component.find("li.menu-item, li.root-item").filter((s,n)=>!this._isInFolder($(n)));t.removeClass("active");let e=[],i=window.location.pathname;if(t.each((s,n)=>{let a=$(n),l=a.find("a").attr("href");l&&(l.includes("#")||this._getCleanPath(l)===i&&e.push(a))}),e.length>0){let s=e.reduce((n,a)=>{let o=n.find("a").attr("href")||"",l=a.find("a").attr("href")||"";return o.length>=l.length?n:a});this.activateMenuItem(s)}this.initAnchorChangeListener()}onBeside({state:t,first:e}){!t||!e||(this.bindEvents(),this.dispatchShowMore(),this.$button=this.$component.find(".folder-item"),!flexbe_cli.is_admin&&this.activateMode&&this.activateMenuItems())}onResize(t={}){["bottom","top"].includes(t.type)||(this.dispatchShowMore(),this.openFolders.forEach(e=>{e.$dropdown?this.setDropdownPosition(e):this.showAsRollup||this._closeFolder(e)}))}onWindowResize(){this.onResize()}onHideShowUI(){this._closeFolder()}onClose(){this.toggleFolder(null,!1)}bindEvents(){$(window).off(`.${this.eventId}`),this.$component.off(".menu"),flexbe_cli.is_admin&&this.$component.on("mouseup.menu.prevent pointerdown.menu.prevent pointerup.menu.prevent",".folder-item",t=>{t.stopPropagation()}),$(window).on(`blur.${this.eventId}`,()=>{this.showAsRollup||this._closeFolder()}),this.$component.on("pointerenter.menu.item pointerleave.menu.item",".menu-item",t=>{if(flexbe_cli.resize.responsiveMode==="desktop"){let e=t.type==="pointerenter";$(t.currentTarget).toggleClass("hover",e)}}),this.$component.on("pointerenter.menu.folder",".folder-item",t=>{this.showOnHover&&(clearTimeout(this._dropdownTimer),$(t.currentTarget).hasClass("show")||(this._dropdownTimer=setTimeout(()=>{flexbe_cli.events.trigger("component_menu:closeAll"),this.toggleFolder(t.currentTarget,!0)},50)))}),this.$component.on("pointerdown.touchfix",t=>{t.target.closest("a")||t.preventDefault()}),this.$component.on("pointerleave.menu.folder",".folder-item",()=>{this.showOnHover&&(clearTimeout(this._dropdownTimer),this._dropdownTimer=setTimeout(()=>{flexbe_cli.events.trigger("component_menu:closeAll")},100))}),this.$component.on("click.menu",".folder-item-text, .show-more",t=>{if(this.showOnClick)return this.toggleFolder(t.currentTarget),!1}),flexbe_cli.events.off(`component_menu:closeAll.${this.eventId}`).on(`component_menu:closeAll.${this.eventId}`,()=>{this.openFolders.forEach(t=>this.toggleFolder(t,!1))})}observeItems(){let t,e=!0,i=this.$component.find("li.root-item")[0];this.unobserveItems(),this._resizeObserver=new ResizeObserver(()=>{if(e){e=!1;return}clearTimeout(t),t=setTimeout(()=>{this.onResize({})},30)}),this._resizeObserver.observe(i)}unobserveItems(){this._resizeObserver&&(this._resizeObserver.disconnect(),this._resizeObserver=null)}dispatchShowMore(){if(!this.allowShowMore||flexbe_cli.resize.responsiveMode==="mobile"||this.actualDirection==="column"){this.restoreMenuItems();return}this.$componentCopy?this.restoreMenuItems():this.$componentCopy=this.$component.clone();let t=getComputedStyle(this.$component[0]),e=this.$component.innerWidth(),i=this.$menuList.innerWidth(),s=parseInt(t.getPropertyValue("--gapX"),10)||0,n=e+s*2;if(i<=n)return this.observeItems(),!1;let a=this.$menuList.find("li.root-item");this.$menuList.append(`
            <li class="menu-item root-item folder-item show-more">
                <svg viewBox="0 0 18 4">
                    <path transform="rotate(-90 2 2)" d="M4 2a2 2 0 1 1-4 0 2 2 0 0 1 4 0zm0 7a2 2 0 1 1-4 0 2 2 0 0 1 4 0zm-2 9a2 2 0 1 0 0-4 2 2 0 0 0 0 4z"/>
                </svg>

                <ul class="component-menu-list component-menu-list--nested apply-text-style"></ul>
            </li>
        `);let o=this.$menuList.find(".show-more .component-menu-list--nested"),l=18+s*2;a.toArray().forEach(r=>{let c=r.offsetWidth;l+c>n&&(o.append(r),$(r).removeClass("root-item")),l+=c}),this.observeItems()}restoreMenuItems(){let t=this.$menuList.find(".show-more");if(t.length){if(this.$componentCopy){let e=this.$componentCopy.find(".component-menu-list--root").clone();this.$menuList.html(e.html())}else{let e=t.find(".component-menu-list").eq(0).children();e.addClass("root-item"),t.replaceWith(e)}this.$menuList.css({position:"",top:"",left:""}),this.unobserveItems()}}toggleFolder(t,e){t=$(t).closest(".folder-item")[0],e==null&&(e=!$(t).hasClass("show")),this[e?"_openFolder":"_closeFolder"](t)}toggleNestedFolder(t,e){e==null&&(e=!$(t).hasClass("show")),this[e?"_openNestedDropdown":"_closeNestedDropdown"](t)}initAnchorChangeListener(){flexbe_cli.block.$blocks.each((t,e)=>{let i=e._core;i?.inFocus&&this.checkBlockInFocus(i)}),flexbe_cli.block.$blocks.off(`focused.${this.eventId}`).on(`focused.${this.eventId}`,t=>{this.checkBlockInFocus(t.currentTarget._core)})}checkBlockInFocus(t){if(!t)return;let e=t.$area.find("> a._anchor").attr("name")||t.$area.attr("data-id");if(e)if(t.inFocus)this.activateMenuItem(this._findMenuItemByAnchor(e));else{if(!this.activeHref)return;this.activeHref&&this.activeHref.includes(`#${e}`)&&(this.deactivateMenuItem(),this.activateMenuItem(this._findMenuItemByCurrentUrl()))}}setActive(t){this.clearActive(),t.addClass("active")}clearActive(){this.$component.find(".active").removeClass("active")}_openFolder(t){let e=$(t);if(!e.length||e.hasClass("show"))return;let i=!flexbe_cli.run.is_preview&&!!this.$component.closest("[data-editor*=menu]:not(.editor-focus)").length,s=!flexbe_cli.run.is_preview&&!!this.$component.closest(".editor-focus").length;if(!i){if(this.showAsRollup)e.find(".component-menu-list--nested").eq(0).slideDown(350),e.addClass("show");else{flexbe_cli.events.trigger("component_menu:closeAll");let n=$("body"),a=e.find(".component-menu-list--nested").eq(0).clone(),o=$(`<div class="component-menu-dropdown ${s?"editor-focus":""}"></div>`);t.$dropdown=o;let l=getComputedStyle(t),r=["--gapY","--fontSize","--lineHeight","--fontWeight","--letterSpacing","--fontStyle","--textDecoration"].reduce((c,d)=>({...c,[d]:l.getPropertyValue(d)}),{});if(o.css(r),this.$component.addClass("in-show"),e.addClass("show"),o.append(a).appendTo(n),this.setDropdownPosition(t),this.component.closest(".m_modal, .fixed-area")){let c=flexbe_cli.helpers.scrollParent(this.component);c===document.documentElement&&(c=document),$(c).one(`scroll.${this.eventId}`,()=>{this.setDropdownPosition(t)})}o.off("pointerenter").on("pointerenter",()=>{clearTimeout(this._dropdownTimer)}),n.on(`keydown.dropdown-${this.eventId}`,c=>{c.code==="Escape"&&this._closeFolder()}),n.on(`click.dropdown-${this.eventId}`,c=>{c.target.closest(".folder-item")||this._closeFolder()}),o.off("pointerleave").on("pointerleave",()=>{clearTimeout(this._dropdownTimer),this.toggleNestedFolder(null,!1),this.showOnHover&&(this._dropdownTimer=setTimeout(()=>{this.toggleFolder(t,!1)},100))}),o.on("pointerenter.menu.folder pointerleave.menu.folder",".menu-item",c=>{$(c.currentTarget).toggleClass("hover",c.type==="pointerenter")}),flexbe_cli.run.is_touch?o.on("click.menu.folder",".folder-item",c=>{this.toggleNestedFolder(c.currentTarget)}):(o.on("pointerenter.menu.folder",".folder-item",c=>{this.toggleNestedFolder(c.currentTarget,!0)}),o.on("pointerleave.menu.folder",".folder-item",c=>{this.toggleNestedFolder(c.currentTarget,!1)}))}this.openFolders.push(t)}}_closeFolder(t){let e=t?$(t):this.$menuList.find(".folder-item.show"),i=flexbe_cli.helpers.scrollParent(this.component);i===document.documentElement&&(i=document),$("body").off(`.dropdown-${this.eventId}`),this.$component.removeClass("in-show"),$(i).off(`.${this.eventId}`),this.showAsRollup?e.find(".component-menu-list--nested").slideUp(350):(e.find(".component-menu-list--nested").css("display",""),e.each((s,n)=>{n.$dropdown&&n.$dropdown.remove()})),e.removeClass("show"),e.find(".show").removeClass("show"),this.openFolders=this.openFolders.filter(s=>!e.is(s))}_openNestedDropdown(t){let{viewportWidth:e,documentHeight:i}=flexbe_cli.resize,s=$(t),n=s.siblings(".nested-item.show"),a=s.find(".component-menu-list--nested").eq(0),o=s.offset(),l=s.innerWidth(),r=s.innerHeight(),c=o.left,d=c+l,h=o.top,p=h+r,u=a.innerWidth(),f=a.innerHeight(),m=c>u,g=e-d>u,b=h>f,y=i-p>f;if(n.each((_,v)=>this._closeNestedDropdown(v)),s.addClass("show"),a.addClass("show-dropdown"),g)a.addClass("in-right");else if(m)a.addClass("in-left");else{let _=e>u?u:l;a.addClass("in-right"),a.css({maxWidth:`${l}px`,marginTop:"15px",marginLeft:`-${Math.floor(_-(e-d)+10)}px`})}y?a.addClass("in-bottom"):b?a.addClass("in-top"):a.addClass("in-bottom")}_closeNestedDropdown(t){let e=$(t),i=e.find(".component-menu-list--nested").eq(0);e.removeClass("show"),i.removeClass("show-dropdown in-left in-right in-bottom in-top")}setDropdownPosition(t){if(!t||!t.$dropdown)return;let{documentHeight:e,viewportHeight:i}=flexbe_cli.resize,s=$(t),n=t.$dropdown,a=s.hasClass("show-more"),o=s.closest("[data-fixed]").length,l=n.find(".component-menu-list--nested").eq(0),r=a?s.find("svg"):s.children().first().find("span"),c=r[0].getBoundingClientRect(),d=r.offset(),h=d.left,p=d.top,u=p+c.height,f=document.body.getBoundingClientRect(),m=7,g=parseInt(l.find(".menu-item-text").css("paddingLeft"),10)||10,b={position:"absolute",width:l.innerWidth(),height:l.innerHeight(),top:u,left:h-f.left-g};if(b.width<c.width&&(b.width=c.width+g*2,l.css("width","100%")),a&&(b.left=h+c.width/2-b.width/2),flexbe_cli.run.is_preview){let v=Math.max(0,-b.left+m),w=Math.max(0,b.left+b.width+m-f.width);v?b.left+=v:w&&(b.left-=w)}let y=u+b.height>e&&p>b.height,_=u+b.height>flexbe_cli.scroll.latest+i;o&&b.height+c.bottom<i?(b.position="fixed",b.top=c.bottom,b.left+=f.left):(y||this.rootModal&&_)&&(b.top=p-b.height),n.toggleClass("rise",o),n.css(b)}};flexbe_cli.entity.setClientJs("element","header_menu",{components:[Xt]});flexbe_cli.entity.setClientJs("element","hr01",{isPure:!0});flexbe_cli.entity.setClientJs("element","icon01",{components:[P],isPure:!0});flexbe_cli.entity.setClientJs("element","logo01",{isPure:!0});function Xe(t){t.params.virtualTranslate=!0,t.params.cssMode=!0}var It="swiper-slide",Zt=class extends x{static is="slider";require=["/_s/lib/swiper8/dist/swiper-bundle.min.js?v847"];constructor(...t){super(...t);let{component:e}=this;this.swiper=null,this.initialSlide=0,this.index=$(e).closest("[data-item-id]").attr("data-item-id"),this.sliderEl=e.classList.contains("swiper")?e:e.querySelector(".swiper"),this.paginationEl=e.querySelector(".slider-pagination"),this.prevEl=e.querySelector('.slider-prev, [data-direction="prev"]'),this.nextEl=e.querySelector('.slider-next, [data-direction="next"]'),this.$component.on("bringIntoView",i=>{let s=this.swiper,n=$(this.sliderEl).find(`.${It}`),a=$(i.target).closest(`.${It}`),o=n.index(a);s?o!==-1&&s.slideTo(o):this.initialSlide=o}),this.setSwiperOptions()}onLoad(){this.inScreen&&!this.swiper&&this.initSwiper()}onScreen({state:t}){!t||!this.isLoaded||this.swiper||this.initSwiper()}onView({state:t}){this.isLoaded&&(t&&!this.swiper&&this.initSwiper(),this.swiper&&this.toggleAutoplay({state:t}))}onResize(){this.swiper&&(this.setSliderSize(),this.setThumbnailsSize(),this.swiper&&this.swiper.initialized&&this.swiper.update())}onDestroy(){this.destroySwiper()}onHideShowUI(t){this.setSwiperOptions(t!=="editor"),this.destroySwiper(),this.initSwiper()}setSwiperOptions(t=flexbe_cli.run.is_preview){let e=this.paginationEl&&this.paginationEl.getAttribute("data-type")||"bullets",i=this.paginationEl&&this.paginationEl.getAttribute("data-direction")||"horizontal",s=!!Number(this.$component.attr("data-loop")),n=Number(this.$component.attr("data-autoplay"));this.options={paginationType:e,direction:i,count:this.$component.attr("data-count"),loop:t&&s,autoplay:t&&n||!1,effect:this.$component.attr("data-effect")||"slide",slidesPerView:"auto"}}initSwiper(){if(this.swiper||typeof Swiper>"u")return!1;let{options:t,component:e,core:i,root:s,index:n,sliderEl:a,paginationEl:o,prevEl:l,nextEl:r}=this,c=`${i&&i.id||"-"}:${n}`,{count:d,loop:h,paginationType:p,effect:u,direction:f}=t,m=flexbe_cli.theme_id===4,g=this.owner.closest(".swiper-inited"),b=t.autoplay?{delay:t.autoplay*1e3,stopOnLastSlide:!h,disableOnInteraction:!1,waitForTransition:!1}:!1,y=this.initialSlide;flexbe_cli.run.is_preview||(s._sliderState?s._sliderState[c]&&(y=Math.max(0,Math.min(d-1,s._sliderState[c])||0)):s._sliderState={},s._sliderState[c]=y);let _={el:o,type:p,clickable:!0,dynamicBullets:m,dynamicMainBullets:3};p==="thumbs"&&(_.type=!1,_.el=null,this.thumbsSwiper=new Swiper(o,{cssMode:!0,loop:!1,slidesPerView:"auto",normalizeSlideIndex:!1,direction:f}));let v=new Swiper(a,{init:!1,speed:350,nested:g,slideClass:It,initialSlide:y,autoplay:b,pagination:_,thumbs:{swiper:this.thumbsSwiper},navigation:{prevEl:l,nextEl:r},effect:u,rewind:h,roundLengths:!0,preventInteractionOnTransition:!0,updateOnWindowResize:!1,slidesPerView:t.slidesPerView,simulateTouch:!flexbe_cli.run.isTouch&&flexbe_cli.run.is_preview,longSwipesMs:100,longSwipesRatio:.1,preloadImages:!1,touchReleaseOnEdges:!1,runCallbacksOnInit:!1});if(this.swiper=v,u==="fade"?K(v):m&&Xe(v),v.onAny((w,C)=>{v.el.dispatchEvent(new CustomEvent(`swiper:${w}`,{detail:C,bubbles:!1,cancelable:!0}))}),v.on("init",()=>{if(!v.slides)return;this.setSliderSize(),this.setThumbnailsSize(),this.swiper!=null&&this.swiper.$el.addClass("swiper-inited"),$(l).add(r).add(o).removeClass("disabled");let w=v.slides[y],C=v.visibleSlides||[v.slides[y]];this.thumbsSwiper&&this.thumbsSwiper.visibleSlides?.length&&C.push(...this.thumbsSwiper.visibleSlides),U(C),w&&T(w,!1,"sliderActivate"),this.toggleAutoplay({state:this.inView})}),this.thumbsSwiper&&this.thumbsSwiper.on("slideChange",$.debounce(w=>{U(w.visibleSlides)},50)),v.on("slideChange",$.debounce(()=>{if(!v.initialized)return;flexbe_cli.run.is_preview||(s._sliderState[c]=v.realIndex);let w=v.slides[v.previousIndex],C=v.slides[v.activeIndex],pt=C&&C.getAttribute("data-type"),ee=v.previousIndex<v.activeIndex?Array.from(v.slides).slice(v.activeIndex,v.activeIndex+2):Array.from(v.slides).slice(v.activeIndex-2,v.activeIndex);e.setAttribute("data-current-content",pt),T(w,null,"sliderDeactivate"),T(C,null,"sliderActivate"),U(ee)},50)),v.on("touchStart",()=>{$(a).addClass("swiper-in-interacting")}),v.on("touchEnd",()=>{$(a).removeClass("swiper-in-interacting")}),v.params.cssMode){let w;v.on("slideChange",()=>{clearTimeout(w),v.animating=!0,v.allowSlidePrev=!1,v.allowSlideNext=!1,w=setTimeout(()=>{v.animating=!1,v.allowSlidePrev=!0,v.allowSlideNext=!0},150)})}this.$component.off("reduceSliderControls").on("reduceSliderControls",(w,{state:C=!0})=>{this.preventAutoplay=!!C,this.preventAutoplay&&this.toggleAutoplay({state:!1})}),this.$component.off("pointerenter").one("pointerenter",()=>{let w=Array.from(v.slides||[]),C=[v.activeIndex-1,v.activeIndex+1].map(pt=>w.at(pt));U(C)}),this.$component.off("pointerdown wheel").on("pointerdown wheel",()=>{this.toggleAutoplay({state:!1})}),Vt(()=>v.init())}destroySwiper(){if(this.swiper)try{this.swiper.destroy()}catch{}finally{this.swiper=null}}toggleAutoplay({state:t}){let{swiper:e,options:i}=this;if(!e||!i.autoplay||!e.autoplay)return!1;this.preventAutoplay&&(t=!1);let s=e.autoplay.running;t&&!s&&e.autoplay.start(),!t&&s&&e.autoplay.stop()}slideTo(t,e=!0){if(!this.swiper){this.initialSlide=t;return}let i=this.swiper.params.loop;typeof this.swiper.realIndex<"u"&&this.swiper.realIndex!==t&&(i?this.swiper.slideToLoop(t,e?null:0):this.swiper.slideTo(t,e?this.swiper.params.speed:0))}setSliderSize(){let t=this.$component.find(".swiper");if(!t.length)return;let e=t[0];e.style.width="";let i=e.getBoundingClientRect().width,s=e.offsetWidth;if(i%1>0&&Math.abs(s-i)<2){e.style.width=`${Math.round(i)}px`;try{this.swiper.update()}catch{}}}setThumbnailsSize(){if(!this.thumbsSwiper||this.options.paginationType!=="thumbs")return;let t=this.options.direction==="horizontal",e=$(this.paginationEl),i=e.find(".thumb-item"),s=2,n=i.length,a=this.thumbsSwiper.params.slidesPerView;e.add(i).css({"--thumbSize":"","--thumbPad":"",width:"",height:""});let o=parseInt(i.css("--thumbPad"),10),l=t?e[0].offsetWidth:e[0].offsetHeight,r=t?i[0].offsetWidth:i[0].offsetHeight,c=Math.max(s,Math.round(l/(r+o)));n>=s&&(n===c+1||n===c-1)?c=n:a&&(a===c+1||a===c-1)&&(c=a),e.toggleClass("is-filled",n>=c),this.thumbsSwiper.params.slidesPerView=c,this.thumbsSwiper.params.spaceBetween=o,this.thumbsSwiper.update(),this.thumbsSwiper.slides.forEach(d=>{d.style.setProperty("--thumbSize",`${d.swiperSlideSize}px`)})}};flexbe_cli.entity.setClientJs("element","media01",{components:[S,Z,Zt]});var te=class{inited=!1;interacted=!1;opts;$area;uidAttr;classContainer;activeUid;$activeTab;$activeSection;$mainContainer;$tabsContainer;$tabsList;$swiperHelper;$tabs;$sections;get isOnScreen(){if(!this.$tabsList)return!1;let{top:t,height:e}=this.$tabsList[0].getBoundingClientRect();return t>0&&t+e<flexbe_cli.resize.viewportHeight}constructor(t){if(this.opts=t,this.$area=t.$area,this.uidAttr=t.uidAttr||"data-tab-uid",this.classContainer=t.classContainer,this.initTabs(),t.activeUid)this.selectTab(t.activeUid);else if(window.location.hash){let e=window.location.hash.replace("#",""),i=$(`._anchor[name="${e}" i]`),s=i.length?i.closest("[data-id]"):$(`[data-id="${e}" i]`),n=i[0]||s[0];n&&this.selectTabFromTarget(n)}this.$area.on("bringIntoView",e=>this.selectTabFromTarget(e.target))}initTabs(){if(this.$mainContainer=this.classContainer==="self"?this.$area:this.$area.find(this.classContainer),this.$tabsContainer=this.$area.find(".container-tabs"),this.$tabsList=this.$area.find('[role="tablist"]'),this.$swiperHelper=this.$area.find(".tab-swiper-helper"),this.inited=!!this.$tabsList.length,!!this.inited&&(this.$tabs=this.$tabsList.find('[role="tab"]'),this.$sections=this.$mainContainer.find('[role="tabpanel"]'),flexbe_cli.is_admin&&this.normalizeLines(),setTimeout(()=>{this.$mainContainer.addClass("main-area--tabs-inited")},50),this.$tabsContainer.on("click",".tab",t=>{let e=$(t.currentTarget).closest(`[${this.uidAttr}]`).attr(`${this.uidAttr}`);e&&this.selectTab(e)}),this.$tabsList.on("wheel",t=>{let e=this.$tabsList[0],i=t.originalEvent.wheelDeltaX,s=t.originalEvent.wheelDeltaY;e.scrollWidth<=e.clientWidth||s<0&&e.scrollLeft===0||s>0&&e.scrollLeft===e.scrollWidth-e.clientWidth||flexbe_cli.run.is_pointer&&!i&&s&&(t.preventDefault(),e.scrollLeft+=s)}),this.$tabsList.on("touchstart",()=>{this.interacted=!0,this.destroySwipeAnimation()}),flexbe_cli.is_admin)){let t;this.$tabsContainer.on("mouseenter",".tab",e=>{e.buttons===1&&document.body.classList.contains("state--in-move")&&(clearTimeout(t),t=setTimeout(()=>{let i=$(e.target).closest(`[${this.uidAttr}]`).attr(`${this.uidAttr}`);this.selectTab(i)},700))}),this.$tabsContainer.on("mouseleave",".tab",()=>{clearTimeout(t)})}}swipeAnimationController(){if(!this.inited)return;let t=this.$tabsList[0]&&this.$tabsList[0].scrollWidth>this.$tabsList[0].clientWidth,e=this.isOnScreen;t&&e?this.initSwiperAnimation():e||this.destroySwipeAnimation()}initSwiperAnimation(){!this.$swiperHelper.hasClass("show")&&!this.interacted&&this.$swiperHelper.addClass("show")}destroySwipeAnimation(){this.$swiperHelper.hasClass("show")&&this.$swiperHelper.removeClass("show")}selectTabFromIndex(t){let e=this.$tabs.get(t);this.selectTabFromTarget(e)}selectTabFromTarget(t){let e=$(t).closest(`[${this.uidAttr}]`).attr(`${this.uidAttr}`);this.selectTab(e)}selectTab(t,{force:e}={}){if(!t||!e&&this.activeUid===t)return;this.inited||this.initTabs();let i=this.$tabs?.filter(`[${this.uidAttr}="${t}"]`)??[];if(!i.length)return;let s=this.$sections.filter(".active"),n=s[0]&&s[0].offsetTop,a=this.$sections.filter(`[${this.uidAttr}="${t}"]`);this.scrollToTab(i),this.$tabs.removeClass("active").attr("aria-selected",!1).attr("tabindex",-1),i.addClass("active").attr("aria-selected",!0).attr("tabindex",0),this.$sections.removeClass("active").prop("hidden",!0),a.addClass("active").prop("hidden",!1);let o=a[0]&&a[0].offsetTop;if(this.activeUid=t,this.$activeTab=i,this.$activeSection=a,s[0].dispatchEvent(new CustomEvent("element-become-hidden")),a[0].dispatchEvent(new CustomEvent("element-become-visible")),typeof this.opts.onSelectTab=="function"&&this.opts.onSelectTab({uid:t,$tab:i}),!flexbe_cli.run.is_mobile&&n!=null&&o!=null&&Math.abs(n-o)>0&&typeof anime<"u"){let l=this.$mainContainer,r=n-o;l.css("will-change","transform"),anime({targets:l[0],translateY:[r,0],duration:250,easing:"easeOutCubic",complete:()=>{l.css({transform:"","will-change":""})}})}}normalizeLines(){if(!this.inited)return;let t,e=this.$tabs;this.$tabsList.find(".tab-spacer").remove(),e.removeClass("first-in-line last-in-line"),e.first().addClass("first-in-line"),e.last().addClass("last-in-line"),e.each((s,n)=>{t&&t.offsetTop!==n.offsetTop&&($(n).addClass("first-in-line"),$(t).addClass("last-in-line"),$(t).after('<span class="tab-spacer"></span>')),t=n})}scrollToTab(t){if(!this.inited)return;let e=this.$tabsList,i=e[0].scrollWidth;if(i>e[0].offsetWidth){let s=t[0].offsetLeft,n=t[0].getBoundingClientRect(),a=flexbe_cli.resize.viewportWidth,o;n.width>a||n.left<20?o=s-20:n.right>a-20&&(o=s-(a-20-n.width)),o!=null&&(o=Math.max(0,Math.min(i-a,o)),e.animate({scrollLeft:o},{duration:250}))}}resetHash(){if(!this.inited)return;String(window.location.hash).replace(/^#{1,2}(tab)?/,"")===this.activeUid&&(flexbe_cli.lockPopstate=!0,window.history.replaceState(null,null,window.location.pathname),flexbe_cli.lockPopstate=!1)}};flexbe_cli.entity.setClientJs("block","BUNDLE",{components:[M],tabsController:void 0,shouldInitTabs:!0,onUpdate({templateRendered:t,reasonData:e}){t&&(this.shouldInitTabs=!0),["create","copy"].includes(e.source)&&requestAnimationFrame(()=>this.tabsController.selectTabFromIndex(e.to))},onResize(){this.tabsController&&this.tabsController.normalizeLines()},onBeside({state:t}){t&&this.shouldInitTabs&&this.createTabs()},onScreen({state:t}){this.tabsController&&(t||(this.tabsController.swipeAnimationController(),this.tabsController.resetHash()))},onFocus({state:t}){this.tabsController&&t&&this.tabsController.swipeAnimationController()},createTabs(){if(this.shouldInitTabs=!1,!this.$area.find('[role="tabpanel"]').length){this.tabsController=null;return}this.tabsController=new te({$area:this.$area,classContainer:".main-area",activeUid:this.selectedTabUid,onSelectTab:({uid:t})=>{this.selectedTabUid=t,this.updateTween()}})}});flexbe_cli.entity.setClientJs("block","FOOTER",{components:[M]});flexbe_cli.entity.setClientJs("block","HEADER",{onInit(){flexbe_cli.is_admin&&(flexbe_cli.events.off(`layout_change.${this.id}`).on("layout_change.anchors",$.debounce(t=>{t?.action==="layout_render"&&this.fixOverlayContrast()},200)),flexbe_cli.events.on(`entity_render:template.${this.id}`,t=>{t.is==="block"&&this.fixOverlayContrast()}))},onDestroy(){flexbe_cli.events.off(`layout_change.${this.id}`)},onLoad(){this.ownContrast=this.$area.attr("data-contrast")||"auto",this.isOverlayed=this.$area.attr("data-overlayed")||!1,this.fixOverlayContrast()},onHideShowUI(){this.fixOverlayContrast()},fixOverlayContrast(){if(this.isOverlayed&&this.ownContrast==="auto"){let i=(this.$area.parent().is(".b_block")?this.$area.parent():this.$area).nextAll(".b_block:visible:not([data-overlayed])").eq(0).attr("data-contrast");i&&(this.$area.attr("data-static-contrast",i),this.$area.attr("data-contrast",i))}}});flexbe_cli.entity.setClientJs("block","QUIZ",{components:[ct,M,S]});flexbe_cli.entity.setClientJs("element","avatar01",{components:[S,P],isPure:!0});flexbe_cli.entity.setClientJs("element","button01",{components:[ut,P],isPure:!0});
